/**
 * @license RequireJS text 2.0.5+ Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

function getViewsPath(){return window.VIEWS_PATH}function buildViewPath(e){return getViewsPath()+e}function buildViewTemplatesPath(e){return"text!"+getViewsPath()+e}window.BASEURL="/webapp/",window.LIBS_URL="res/libs/",window.APP_PATH="flight/",window.COMMON_PATH="app/common/",window.MODELS_PATH="flight/models/",window.VIEWS_PATH="flight/dest/views/",window.MODULES_PATH="flight/dest/modules/",window.DEFAULTINDEX="index",require.config({baseUrl:BASEURL,paths:{CPageStore:"fpage/dest/models/cpagestore",CPageModel:"fpage/dest/models/cpagemodel",InvoiceStore:"invoice/dest/models/invoicestore",vFlightInfo:window.MODULES_PATH+"bookingInfo/views/vFlightInfo",vPassenger:window.MODULES_PATH+"bookingInfo/views/vPassenger",vVouchers:window.MODULES_PATH+"bookingInfo/views/vVouchers",vInsurance:window.MODULES_PATH+"bookingInfo/views/vInsurance",vTravelPackages:window.MODULES_PATH+"bookingInfo/views/vTravelPackages",vParentCorporate:window.MODULES_PATH+"bookingInfo/views/vParentCorporate",vPayment:window.MODULES_PATH+"bookingInfo/views/vPayment",vOrder:window.MODULES_PATH+"bookingInfo/views/vOrder",mPassenger:window.MODULES_PATH+"bookingInfo/models/c.mPassenger",vCorporater1:window.MODULES_PATH+"bookingInfo/views/vPassengerCorporater1",mFlight:window.MODULES_PATH+"bookingInfo/models/mFlight",sFlight:window.MODULES_PATH+"bookingInfo/models/sFlight",mVouchers:window.MODULES_PATH+"bookingInfo/models/c.mVouchers",vVouchersCorporater:window.MODULES_PATH+"bookingInfo/views/vVouchersCorporater",vDataControl:window.MODULES_PATH+"bookingInfo/views/bottom",widgetHidden:"flight/dest/widgets/c.widget.Hidden",widgetForm:"flight/dest/widgets/c.widget.form",MultipleScrollList:"flight/dest/common/MultipleScrollList",adLoad:"flight/dest/utility/adLoad",Utility:"flight/dest/utility/utility"},urlArgs:"2.4.8-201409011100"}),require(["libs","App"],function(e,t){new t({defaultView:DEFAULTINDEX,viewRootPath:VIEWS_PATH,animatSwitch:!0})}),define("main_r",function(){}),define("FlightStore",["cStore","cBase","cUtility"],function(e,t,n){var r={};return r.FlightSearchStore=new t.Class(e,{__propertys__:function(){this.key="S_FLIGHT_AirTicket",this.lifeTime="1D",this.defaultData={tabtype:1,ver:0,tripType:1,ticketIssueCty:"SHA",flag:0,pageIdx:1,passengerType:1,items:[{dCtyCode:"BJS",dCtyId:1,dcityName:"北京",dkey:3,aCtyCode:"SHA",aCtyId:2,acityName:"上海",akey:2}],_items:[{dCtyCode:"BJS",dCtyId:1,dcityName:"北京",dkey:3,aCtyCode:"SHA",aCtyId:2,acityName:"上海",akey:2}],"class":0,"depart-sorttype":"time","depart-orderby":"asc","arrive-sorttype":"time","arrive-orderby":"asc",calendarendtime:(new t.Date(n.getServerDate())).addMonth(5).format("Y/m/d H:i:s"),submittime:0,fullCabin:!1}},initialize:function($super,e){$super(e)},setSearchDetails:function(e,t,n){var r=this.getAttr("_items")||[],i=r[e]||{};i[t]=n,r[e]=i,this.setAttr("_items",r)},getSearchDetails:function(e,t){var n=this.getAttr("_items");return n=n&&n[e]||{},n[t]},removeSearchDetails:function(e){var t=this.getAttr("_items")||[];e&&t[e]&&(t.splice(e,1),this.setAttr("_items",t))},setCurSearchDetails:function(e){e=e||[];var t=this.getAttr("_items")||[],n=[];for(var r=0,i=e.length;r<i;r++)t[e[r]]&&(n[e[r]]=t[e[r]]);n.length&&this.setAttr("items",n)},saveToFltintlSearch:function(){var e=this.get(),t={},n={passengerType:!0,calendarendtime:!0,ver:!0,tripType:!0,"class":!0,sortRule:!0,sortType:!0,pageIdx:!0,shoppingIdx:!0,policyIdx:!0,ext:!0,segments:!0,flightType:!0,flag:!0,airlineCode:!0,tabtype:!0};for(var i in n)switch(i){case"ver":case"tripType":case"class":case"ext":case"tabtype":case"calendarendtime":case"passengerType":t[i]=e[i];break;case"sortRule":t[i]=1;break;case"pageIdx":t[i]=1;break;case"shoppingIdx":t[i]=-1;break;case"policyIdx":t[i]=-1;break;case"segments":t[i]=function(e){var t=[],n;for(var r=0,i=e.length;r<i;r++)n={},n.dCty=e[r].dCtyCode,n.aCty=e[r].aCtyCode,n.dDate=e[r].date,n.dcityName=e[r].dcityName,n.acityName=e[r].acityName,t.push(n);return t}(e._items||[]);break;case"flightType":t[i]=7;break;case"flag":t[i]=e[i];break;case"airlineCode":t[i]=""}r.FltintlSearchStore.getInstance().set(t)}}),r.FlightSearchSubjoinStore=new t.Class(e,{__propertys__:function(){this.key="S_FLIGHT_SUBJOIN",this.lifeTime="1D",this.defaultData={"depart-sorttype":"price","depart-orderby":"asc","arrive-sorttype":"price","arrive-orderby":"asc"}},initialize:function($super,e){$super(e)}}),r.FltintlSearchStore=new t.Class(e,{__propertys__:function(){this.key="S_FLIGHT_INTLAirTicket",this.lifeTime="1D",this.defaultData={airlineCode:"",ext:"",flag:0,flightType:7,sortRule:1,sortType:2,pageIdx:1,policyIdx:-1,"class":0,segments:[{aPort:"",aCty:"TYO",dPort:"",dCty:"SHA",dDate:"2013/8/15  0:00:00"}],ver:0,shoppingIdx:-1,tripType:1,passengerType:1}},initialize:function($super,e){$super(e)}}),r.FlightListStore=new t.Class(e,{__propertys__:function(){this.lifeTime="5M",this.key="P_FLIGHT_TicketList"},initialize:function($super,e){$super(e)}}),r.FlightInterCityListStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_InterCityList",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.FlightCityListStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_CITYLIST",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.zqInCityStore=new t.Class(e,{__propertys__:function(){this.key="zqInCityInfo",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.zqInCityDateStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_oneselfInCityDateStore",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.LastInCitySelectDateTime=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_LastInCitySelectDateTime",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.LastzqInAirportSelectDateTime=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_LastzqInAirportSelectDateTime",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.zqInAirportStore=new t.Class(e,{__propertys__:function(){this.key="zqInAirportInfo",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.zqInAirportDateStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_zqInAirportDateStore",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.zqInAirportDateAndAddressStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_zqInAirportDateAndAddressStore",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.zqInCityDateAndAddressStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_zqInCityDateAndAddressStore",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.zqInCitySelectStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_zqInCitySelectStore",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.zqInAirportSelectStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_zqInAirportSelectStore",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.FlightDetailsStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_USERSELECTDETAILS",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.FlightDetailParamStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_DETAILSPARAM",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.FlightOrderInfoStore=new t.Class(e,{__propertys__:function(){this.key="F_FLIGHT_ORDERINFO",this.lifeTime="30M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.FlightOrderListStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_ORDERLIST",this.lifeTime="3M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.FlightOrderDetailStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_ORDERDETAIL",this.lifeTime="30M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.RepeatOrderCheckStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_REPEAT_ORDER",this.lifeTime="30M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.FlightTicketRefundChangeStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_TICKETREFUNDCHANGE",this.lifeTime="30M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.FlightTicketChangeForm=new t.Class(e,{__propertys__:function(){this.key="F_FLIGHT_TICKETCHANGE",this.lifeTime="30M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.FlightTicketRefundFormStore=new t.Class(e,{__propertys__:function(){this.key="F_FLIGHT_TICKETREFUND",this.lifeTime="30M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.FlightOrderParamStore=new t.Class(e,{__propertys__:function(){this.key="USER_FLIGHT_ORDERPARAM",this.lifeTime="15M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.OrderDetailReturnPage=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_RETURNPAGE",this.lifeTime="15M"},initialize:function($super,e){$super(e)}}),r.FlightSelectedInfo=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_SELECTEDINFO",this.lifeTime="1H"},initialize:function($super,e){$super(e)}}),r.FlightPickTicketSelectStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_PICKTICKETSELECT",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.FlightAirlineStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_AIRLINE",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.FlightAircraftStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_AIRCTRAFT",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.FlightTakeOfTimeStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_ENUM_TAKETIME",this.lifeTime="1D",this.defaultData=[{title:"全天",start:null,end:null,value:""},{title:"00:00-05:59",start:"00:00",end:"05:59",value:"00:00-05:59"},{title:"06:00-11:59",start:"06:00",end:"11:59",value:"06:00-11:59"},{title:"12:00-17:59",start:"12:00",end:"17:59",value:"12:00-17:59"},{title:"18:00-23:59",start:"18:00",end:"23:59",value:"18:00-23:59"}]},initialize:function($super,e){$super(e)}}),r.FlightCabinStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_ENUM_CABINS",this.lifeTime="1D",this.defaultData=[{title:"不限",value:""},{title:"经济舱",value:"0"},{title:"公务/头等舱",value:"3"}]},initialize:function($super,e){$super(e)}}),r.FlightFilterStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_LIST_FILTER",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.FlightPickTicketStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_PICK_TICKET",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.FlightPickTicketParamStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_PICK_TICKET_PARAM",this.lifeTime="1D",this.defaultData={ticketIssueCty:"BJS",tripType:1,ver:0,items:[]}},initialize:function($super,e){$super(e)}}),r.FlightAdTimeOutStore=new t.Class(e,{__propertys__:function(){this.key="FLIGHT_AD_TIMEOUT",this.lifeTime="24H"},initialize:function($super,e){$super(e)}}),r.LowestPriceSearchStore=new t.Class(e,{__propertys__:function(){this.lifeTime="24H",this.key="FLIGHT_LOWEST_PRICE",this.defaultData={ver:0,aCty:"SHA",dCty:"BJS"}},initialize:function($super,e){$super(e)}}),r.TempSaveDataStore=new t.Class(e,{__propertys__:function(){this.lifeTime="1D",this.key="FLIGHT_TempSaveData"},initialize:function($super,e){$super(e)}}),r.FlightCabinListStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_CabinList",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.FlightCabinParamStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_CabinParam",this.lifeTime="30M",this.defaultData={flag:"0",ext:""}},initialize:function($super,e){$super(e)}}),r.FlightSelectSeatStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_SELECTSEAT",this.lifeTime="2M",this.defaultData={}},initialize:function($super,e){$super(e)}}),r.FlightSubmitCheckinStore=new t.Class(e,{__propertys__:function(){this.key="P_FLIGHT_SUBMITCHECKIN",this.lifeTime="2M",this.defaultData={}},initialize:function($super,e){$super(e)}}),r.CheckinParamStore=new t.Class(e,{__propertys__:function(){this.key="F_CHECKIN_PARAM",this.lifeTime="30M",this.defaultData={card:null,cardType:1,cardName:"身份证",airCode:null,airName:null,tel:null,tno:null,cards:[{id:1,name:"身份证"}]}},initialize:function($super,e){$super(e)}}),r.CheckinResultStore=new t.Class(e,{__propertys__:function(){this.key="F_CHECKIN_RESULT",this.lifeTime="30M",this.defaultData={}},initialize:function($super,e){$super(e)}}),r.CheckinListStore=new t.Class(e,{__propertys__:function(){this.key="FLIGHT_CHECKIN_LIST",this.lifeTime="30M",this.defaultData={}},initialize:function($super,e){$super(e)},getCurCheckInfo:function(e){var t=this.getAttr("fcinfos")||[],n={},r=[];for(var i=0,s=t.length;i<s;i++)if(t[i].oid==e.oid&&t[i].dacode==e.dacode)return n=t[i],_.has(e,"index")?(r.push(t[i].ciplst[e.index]),n.ciplst=r,n):n}}),r.CheckinSearchParamStore=new t.Class(e,{__propertys__:function(){this.key="FLIGHT_CHECKIN_SEARCH_PARAM",this.lifeTime="30M",this.defaultData={}},initialize:function($super,e){$super(e)}}),r.CheckPassengerStore=new t.Class(e,{__propertys__:function(){this.key="FLIGHT_CHECK_PASSENGER",this.lifeTime="1H"},initialize:function($super,e){$super(e)}}),r.CheckinSegmentStore=new t.Class(e,{__propertys__:function(){this.key="F_CHECKIN_SEGMENT",this.lifeTime="1M"},initialize:function($super,e){$super(e)}}),r.CancelCheckResultStore=new t.Class(e,{__propertys__:function(){this.key="FLIGHT_CANCEL_CHECK_RESULT",this.lifeTime="5M"},initialize:function($super,e){$super(e)}}),r.FlightOrderInfoInviceStore=new t.Class(e,{__propertys__:function(){this.key="F_FLIGHT_ORDERINFO_INVOICE",this.lifeTime="30D",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.FlightCancelCheckStore=new t.Class(e,{__propertys__:function(){this.key="FLIGHT_CANCEL_CHECK",this.lifeTime="1H"},initialize:function($super,e){$super(e)}}),r.FlightOrderBookingStore=new t.Class(e,{__propertys__:function(){this.key="FLIGHT_ORDER_BOOKING",this.lifeTime="1H"},initialize:function($super,e){$super(e)}}),r.CheckinAirListStore=new t.Class(e,{__propertys__:function(){this.key="FLIGHT_CHECK_AirList",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.CustomerCouponStore=new t.Class(e,{__propertys__:function(){this.key="FLIGHT_CUSTOMER_COUPON",this.lifeTime="5M"},initialize:function($super,e){$super(e)}}),r.FlightBookingResultStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_BOOKING_RESULT",this.lifeTime="1D",this.isUserData=!0,this.defaultData={oid:0,rc:!1,rmsg:"",scode:"",sexpire:"",extno:""}},initialize:function($super,e){$super(e)}}),r.OrderCreateStore=new t.Class(e,{__propertys__:function(){this.key="F_ORDER_CREATE_RESULT",this.lifeTime="150M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.PackageSelectStore=new t.Class(e,{__propertys__:function(){this.key="U_FLIGHT_PackageSelectInfo",this.lifeTime="150M",this.defaultData={pkgtype:1},this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.MdIndexStore=new t.Class(e,{__propertys__:function(){this.key="MD_Index",this.lifeTime="150M",this.isUserData=!1,this.defaultData={IsReturn:!1,OWClick:0,RTClick:0,DCity:"",ACity:"",ChangeCityClick:0,FlightType:"",DTime:"",ATime:"",IsQuery:!1,IsService:!1,IsFlightSituation:!1,IsChooseSeat:!1}},increaseCntByKey:function(e){var t=["OWClick","RTClick","ChangeCityClick"].some(function(t){return e===t});if(t){var n=parseInt(this.getAttr(e)||0);this.setAttr(e,++n)}},initialize:function($super,e){$super(e)}}),r.MdListStore=new t.Class(e,{__propertys__:function(){this.key="MD_List",this.lifeTime="150M",this.isUserData=!1,this.defaultData={DCity:"",ACity:"",FlightType:"",DTime:"",ATime:"",IsReturn:!1,DateQuery:"",SortWay:"",IsFilter:!1,FlightNoSequence:"",MoreClassSequence:"",SubClass:"",SubClassSequence:1,ActiveType:""}},addOpValue:function(e,t){var n=["SortWay","MoreClassSequence"].some(function(t){return e===t});if(n){var r=this.getAttr(e);r+=r===""?t:","+t,this.setAttr(e,r)}},initialize:function($super,e){$super(e)}}),r.MdTransStore=new t.Class(e,{__propertys__:function(){this.key="MD_Trans",this.lifeTime="150M",this.isUserData=!1,this.defaultData={}},initialize:function($super,e){$super(e)}}),r.MdBookingStore=new t.Class(e,{__propertys__:function(){this.key="MD_Booking",this.lifeTime="150M",this.isUserData=!1,this.defaultData={FlightNoSequence:"",SubClassSequence:"",ActiveType:"",IsReturn:!1,IsClickLogin:!1,IsLoginNow:!1,IsChangeSubClass:!1,IsCheckTGQ:!1,MorePassengerClick:0,IsContactPhone:!1,ContactPhonePass:!1,IsCancelInsurance:!1,IsNeedSegment:!1,IsDeliveryType:!1,IsWriteAddressee:!1,IsDeliveryArea:!1,IsDeliveryAddress:!1,IsDeliveryPostCode:!1,NextStepNotPassClick:0}},addOpValue:function(e,t){var n=this.getAttr(e);n+=n===""?t:","+t,this.setAttr(e,n)},increaseCntByKey:function(e){var t=["MorePassengerClick","NextStepNotPassClick"].some(function(t){return e===t});if(t){var n=parseInt(this.getAttr(e)||0);this.setAttr(e,++n)}},initialize:function($super,e){$super(e)}}),r.FlightCCBStore=new t.Class(e,{__propertys__:function(){this.key="E_CCB_SALES",this.lifeTime="99D",this.isUserData=!1,this.defaultData={}},initialize:function($super,e){$super(e)}}),r.FlightLowestPriceStore=new t.Class(e,{__propertys__:function(){this.key="FlightLowestPriceStore",this.lifeTime="2M",this.isUserData=!1,this.defaultData={}},initialize:function($super,e){$super(e)}}),r}),define("relationship",{"Flight/Domestic/DeliveryV2/Query":{deliveries:function(e){return e.deliverys?(e.deliverys||[]).map(function(e){var t={};t.type=e.dtype,t.name=e.dname,t.exinfo=e.exinfo;var n=0;return t.addrs=e.slst?e.slst.map(function(e){var t={};t.id=e.siteid,t.name=e.sitename;var r="";if(e.stime!=null){var i=(new Date(e.stime)).getHours().toString();r+=i.length<2?"0"+i:i;var s=(new Date(e.stime)).getMinutes().toString();r+=s.length<2?"0"+s:s}t.btime=r;var o="";if(e.etime!=null){var i=(new Date(e.etime)).getHours().toString();o+=i.length<2?"0"+i:i;var s=(new Date(e.etime)).getMinutes().toString();o+=s.length<2?"0"+s:s}return t.etime=o,t.dstr=e.siteid,t.site=e.exinfo.ssiteid,t.ext=e.extinfo,t.fee=e.exinfo.fee,t.index=n,n+=1,t}):null,t}):[]}},"Flight/Domestic/FlightDetailV2/Query":function(e){if(e.items&&e.items.length)return e;var t={availTM:0,couponBalance:0,ext:null,flag:null,insurances:[],items:[],notice:null,rebateDur:0,strategy:{},needinv:null,originData:null,ispackage:null,hasTravalPackage:!1,pkglist:[],invoiceinfo:[]};if(e.notes&&e.notes.length)for(var n=0;n<e.notes.length;n++){var r=e.notes[n];r.notetype==1&&r.notes&&r.notes.length&&(t.notice=r.notes[0].notes)}for(var n=0;n<e.segs.length;n++){var i=e.segs[n],s=e.pols[n],o={basicInfo:{},ext:"",policy:{},proRmk:"",rmk:{},routingIdx:"",stopCities:[]},u=i.flgs[0].basinfo,a=i.flgs[0].aportinfo,f=i.flgs[0].dportinfo,l=i.flgs[0].dateinfo,c=i.flgs[0].craftinfo,h=i.flgs[0].stopinfo;o.basicInfo.aCtyCode=a.city,o.basicInfo.aCtyId=null,o.basicInfo.aPortCode=a.aport,o.basicInfo.aTerminal=a.bsname,o.basicInfo.aTime=l.adate,o.basicInfo.aaname=a.aportsname,o.basicInfo.acname=a.cityname,o.basicInfo.agreementId="",o.basicInfo.airlineCode=u.aircode,o.basicInfo.aname=u.airsname,o.basicInfo.channel="",o.basicInfo.ctinfo={},o.basicInfo.ctinfo.ckind=c.kind==1?"L":c.kind==2?"M":c.kind==3?"S":"Unknow",o.basicInfo.ctinfo.ctname=c.cname,o.basicInfo.ctinfo.maxs=c.max,o.basicInfo.ctinfo.mins=c.min,o.basicInfo.ctinfo.wlvl="",o.basicInfo.dCtyCode=f.city,o.basicInfo.dCtyId=f.cityid,o.basicInfo.dPortCode=f.aport,o.basicInfo.dTerminal=f.bsname,o.basicInfo.dTime=l.ddate,o.basicInfo.daname=f.aportsname,o.basicInfo.dcname=f.cityname,o.basicInfo.flag=null,o.basicInfo.flightNo=u.flgno,o.basicInfo.planeType=c.craft,o.basicInfo.puncRate=l.prate,o.basicInfo.polid=s.polid;if(h.isstop)for(var p=0;p<h.citys.length;p++){var d=h.citys[p];o.stopCities.push({name:d.cityname,aTime:null,dTime:null,Time:d.StopTime})}o.policy.isAddChd=null,o.policy.activityBM="",o.policy.babyPolicy=null,o.policy.cardTypes=s.salepolinfo.cards,o.policy.childPolicy=null,n==0&&(t.needinv=s.needinv,t.invoiceinfo=s.invoiceinfo||[]),o.policy.isApplyChild=null;var v=s.grades[0];o.policy.class=v.grade,o.policy.classForDisp=v.dplclass;var m=s.prices;for(var g=0;g<m.length;g++){var y=m[g];y.psgtype==1?(o.policy.discount=y.discount,o.policy.price=y.price,o.policy.sPrice=y.stand,o.policy.fuelCost=y.fuel,o.policy.tax=y.tax,o.policy.isApplyChild=y.appchild):y.psgtype==3?(o.policy.babyPolicy=o.policy.babyPolicy||{},o.policy.babyPolicy.fuelCost=y.fuel,o.policy.babyPolicy.isApply=!0,o.policy.babyPolicy.price=y.price,o.policy.babyPolicy.tax=y.tax):y.psgtype==2&&(o.policy.childPolicy=o.policy.childPolicy||{},o.policy.childPolicy.fuelCost=y.fuel,o.policy.childPolicy.isApply=!0,o.policy.childPolicy.price=y.price,o.policy.childPolicy.tax=y.tax)}o.policy.minNum=s.salepolinfo.mintkt;var b=s.pkginfo;for(var w=0;w<b.length;w++){var E=b[w],S=0;if(E.packageinfo&&E.packageinfo.psgs&&E.packageinfo.psgs.length)for(var x=0;x<E.packageinfo.psgs.length;x++){var T=E.packageinfo.psgs[x];if(T.psgtype==1){S=T.min;break}}if(E.basicinfo&&E.basicinfo.pkgtype==1&&n==0){var N={};N.amt=null,N.type=null,N.ext=null,N.min=S,N.price=E.price,N.productId=null,N.rmk=null,N.salesRmk=null,N.sites=null,N.typeId=E.basicinfo.pkgid,N.url=E.basicinfo.pkgdescurl,t.insurances.push(N)}}if(n==0){var C=b.filter(function(e,t){return e.basicinfo.pkgtype==1}),k=b.filter(function(e,t){return e.basicinfo.pkgtype==2});C.length&&k.length&&(t.ispackage=!0,t.pkglist=b)}o.policy.payments=[],o.policy.productType=null,o.policy.qty=s.quantity;var L=s.promos;for(var A=0;A<L.length;A++){var O=L[A];switch(O.promotype){case 1:o.policy.rebateAmt=O.price,O.promodates&&O.promodates.length&&(o.policy.rebateAmtDescription=O.promodates[0].rmk);break;case 6:t.flag=7;break;case 3:o.policy.gift=O.price,O.promodates&&O.promodates.length&&(o.policy.giftDescription=O.promodates[0].rmk);case 4:o.basicInfo.hasMeal=!0;break;case 5:t.hasTravalPackage=!0,o.bIsPackage=!0}}o.policy.subclass=null,o.policy.subclassForDisp=null,o.prodRmk="";var M=s.notes;for(var _=0;_<M.length;_++){var D=M[_];switch(D.notetype){case 2:o.prodRmk=D.notes[0].notes;break;case 3:o.prodRmk=D.notes[0].notes;break;case 5:o.rmk.ticketRmk=D.notes[0].notes;break;case 4:o.basicInfo.IsK=!0}}var P=s.frinfo;for(var H=0;H<P.length;H++){var B=P[H];B.psgtype==1?(o.rmk.notice="",o.rmk.ticketTitle="",o.rmk.ticketBody="",o.rmk.refNote=B.refnote,o.rmk.rerNote=B.rer,o.rmk.endNote=B.end,o.rmk.ext=null,o.rmk.specialClass=null):B.psgtype==3?o.policy.babyPolicy!=null&&(o.policy.babyPolicy=o.policy.babyPolicy||{},o.policy.babyPolicy.refRerEndNote={},o.policy.babyPolicy.refRerEndNote.endNote=B.end,o.policy.babyPolicy.refRerEndNote.refNote=B.refnote,o.policy.babyPolicy.refRerEndNote.rerNote=B.rer):B.psgtype==2&&o.policy.childPolicy!=null&&(o.policy.childPolicy=o.policy.childPolicy||{},o.policy.childPolicy.refRerEndNote={},o.policy.childPolicy.refRerEndNote.endNote=B.end,o.policy.childPolicy.refRerEndNote.refNote=B.refnote,o.policy.childPolicy.refRerEndNote.rerNote=B.rer)}i.segno==1?t.items.unshift(o):t.items.push(o)}return t.originData=e,t},"Flight/Domestic/FlightVarList/Query":{Data:function(e){var t=[];if(e&&e.items){$(e.items).each(function(e,r){var i={ActualArriveTime:n(r.aaTime),ActualDepartTime:n(r.adTime),AirCompanyName:r.airlineName,ArriveAirportCode:r.aPort,ArriveAirportName:"",ArriveTerminal:r.aTerminal,DepartAirportCode:r.dPort,DepartAirportName:"",DepartTerminal:r.dTerminal,EstimateArriveTime:n(r.eaTime),EstimateDeparTime:n(r.edTime),FlightNo:r.flightNo,PlanArriveTime:n(r.paTime),PlanDepartTime:n(r.pdTime),StatusRemark:r.status,StopAirport:r.stopPort,StopCity:r.stopCty,puncRate:r.puncRate,AirlineCode:r.airlineCode,ActualArriveDate:r.aaDate,ActualDepartDate:r.adDate,AZone:r.azone,DZone:r.dzone,DStpe:r.dstpe,eaDate:r.eaDate,edDate:r.edDate,interval:r.interval,sDate:r.sDate,pdDate:r.pdDate,paDate:r.paDate,fTime:r.fTime,fcTime:r.fcTime,plane:r.airmodel,planeAge:r.planage,cftkind:r.cftkind,follow:!1,borgate:r.borgate};t.push(i)});function n(e){return e?e.slice(0,2)+":"+e.slice(2):"--:--"}return t}},Message:null,Query:null,ServerCode:1},"Flight/Domestic/Order/RepeatOrderCheck":{mappingRequest:function(e,t){var n={pinfo:[],finfo:[],ver:0};return e&&e.forEach(function(e,t){var r={cnum:e.passportNo,ctype:e.passportType,nation:e.natl,psgid:e.id,psgname:e.name};n.pinfo.push(r)}),t&&t.items.forEach(function(e,t){var r={dcity:e.basicInfo.dCtyCode,dcityid:e.basicInfo.dCtyId,ddate:e.basicInfo.dTime};n.finfo.push(r)}),n}}}),define("mapping",["relationship"],function(relationship){function convert(data1,mapping,originData1){var originData1=originData1||data1,data2={};if(typeof mapping=="object")for(var k in mapping){var v=mapping[k];if(typeof v=="object")data2[k]=convert(data1[k],v,originData1);else if(typeof v=="function")data2[k]=v.apply(data2,[originData1,k,data1]);else if(typeof v=="string")if(v.length>1&&v.substring(0,1)=="&"){var v1=v.substring(1),v2;try{var a=v1.split("."),exp="";for(var i=0;i<a.length;i++)exp+="['",exp+=a[i],exp+="']";v2=eval((originData1?"originData1":"data1")+exp)}catch(e){}data2[k]=v2}else data2[k]=v;else data2[k]=v}else typeof mapping=="function"&&(data2=mapping.apply(data2,[originData1,k,data1]));return data2}function translate(e,t){var n;for(var r in relationship)if((new RegExp(r)).test(e)){n=relationship[r];break}return n?convert(t,n):t}return{convert:convert,translate:translate}}),define("BusinessModel",["cModel","cBase","mapping","cAjax"],function(e,t,n,r){var i=new t.Class(e,{__propertys__:function(){},initialize:function($super,e){},excute:function(t,i,s,o,u){var a=_.clone(this.getParam()||{}),f=this.getTag(),l=this.result&&this.result.get(f),a,c,h,p=this.buildurl(),d=this.head.get();this.isAbort=!1;var v=this;!l||this.ajaxOnly||s?(this.method.toLowerCase()!=="get"&&this.usehead&&this.contentType!==e.CONTENT_TYPE_JSONP&&(a.head=this.head.get()),c=$.proxy(function(r){var s=r.head,u;this.contentType!==e.CONTENT_TYPE_JSONP&&this.usehead&&s.auth&&s.auth!==d.auth&&this.head.setAuth(s.auth),s&&s.errcode===0?(u=r,u=function(){return n.translate(p,u)}(),typeof this.dataformat=="function"&&(u=this.dataformat(u)),this.result&&this.result.set(u,f),t&&t.call(o||this,u,r,!0)):i&&i.call(o||this,r)},this),h=$.proxy(function(e){if(v.isAbort){v.isAbort=!1,u&&u.call(o||this,e);return}i&&i.call(o||this,e)},o||this),this.contentType===e.CONTENT_TYPE_JSON?this.ajax=r.cros(p,this.method,a,c,h):this.contentType===e.CONTENT_TYPE_JSONP?this.ajax=r.jsonp(p,a,c,h):this.ajax=r.post(p,a,c,h)):t.call(o||this,l,null,!1)},getDataWithSync:function(e,t,n){var r=this.buildurl(),i=_.clone(this.getParam()||{});i.head=this.head.get(),$.ajax({url:r,async:!n,data:JSON.stringify(i),type:"post",dataType:"json",contentType:"application/json",timeout:i.timeout||2e5,success:e.bind(this),error:t.bind(this)})},buildurl:function(){var e=this.baseurl(),t=this.protocol+"://"+e.domain+"/"+e.path+(typeof this.url=="function"?this.url():this.url);return t},baseurl:function(e){var t=location.host,n="m.ctrip.com",r="restapi";return t.match(/^m\.ctrip\.com/i)||t.match(/^secure\.ctrip\.com/i)?(n="m.ctrip.com",r="restapi"):t.match(/^(localhost|172\.16|127\.0)/i)||window.DEBUG_MODE?(n="ws.mobile.flight.fat36.qa.nt.ctripcorp.com",r="FlightWirelessApi"):t.match(/^10\.8\.2\.111/i)||t.match(/^10\.8\.5\.10/i)?(n="m.ctrip.com",r="restapi"):t.match(/^m\.uat\.qa\.ctripcorp\.com/i)?(n="ws.mobile.flight.uat.ctripcorp.com",r="FlightWirelessApi"):t.match(/^m\.fat/i)||t.match(/^waptest\.ctrip|^210\.13\.100\.191/i)||t.match(/^wapsecuretest\.ctrip|^210\.13\.100\.191/i)||window.DEBUG_MODE?(n="ws.mobile.flight.fat36.qa.nt.ctripcorp.com",r="FlightWirelessApi"):(n="m.ctrip.com",r="restapi"),{domain:n,path:r}}});return i}),define("FlightModel",["cBase","FlightStore","mapping","cAjax","BusinessModel"],function(e,t,n,r,i){var s={};return s.CheckInCancelSubmitModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/CheckIn/CheckInCancelSubmit",this.method="POST",this.param={ver:99,oid:0},this.isUserData=!0},initialize:function($super,e){$super(e)},formatParam:function(e){var t={aucde:e.aucde,oid:e.oid,fcsinf:{fno:e.fno,dcode:e.dacode,acode:e.aacode,ddate:e.depdat,setno:e.ciplst[0].setno},psginf:{ctype:e.ciplst[0].ctype,cno:e.ciplst[0].cno,tno:e.ciplst[0].tno,psgname:e.ciplst[0].psgnam,phone:e.ciplst[0].phone}};this.param=t}}),s.GetAuthCodeModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/CheckIn/AuthCodeSearch",this.method="POST",this.param={ver:99,oid:0,fcsinf:{fno:0,dcode:0,acode:0,ddate:"2005/12/12",setno:0},psginf:{ctype:0,cno:0,tno:0,psgname:"",phone:""}},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.OrderCancelModel=new e.Class(i,{__propertys__:function(){this.url="/Basic/Order/Cancel",this.method="POST",this.param={ver:99,oid:0,biztype:3},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.FlightCityListModel=new e.Class(i,{__propertys__:function(){this.url="/Data/AirportCity",this.method="GET",this.param={ver:99},this.dataformat=function(e){var t=e.cities||[],n={};if(t.length)for(var r=0,i=t.length;r<i;r++)n[t[r].portCode]=t[r];return e.cities2=n,e},this.result=t.FlightCityListStore.getInstance()},initialize:function($super,e){$super(e)}}),s.FlightInterCityListModel=new e.Class(i,{__propertys__:function(){this.url="/Data/InternationalCity",this.method="GET",this.param={dataVer:0,ver:0,type:64},this.dataformat=function(e){var t=e.cities||[],n={},r,i={},s,o=[];if(t.length)for(var u=0,a=t.length;u<a;u++)r=n[t[u].einitial]=n[t[u].einitial]||[],s=i[t[u].einitial]=i[t[u].einitial]||{},s[t[u].code+""+t[u].flag]||((t[u].flag&64)==64?o.push(t[u]):r.push(t[u]),s[t[u].code+""+t[u].flag]=!0);for(var u in n)n[u].sort(function(e,t){return e.hotFlag-t.hotFlag});return o.sort(function(e,t){return e.hotFlag-t.hotFlag}),e.cities2=n,e.hotcity=o,e},this.result=t.FlightInterCityListStore.getInstance()},initialize:function($super,e){$super(e)}}),s.FlightDetailModel=new e.Class(i,{__propertys__:function(){function e(e,t,n){var r={};return $(e).each(function(e,i){if(t==i[n])return r=i,!1}),r}return this.url="/Flight/Domestic/FlightDetailV2/Query",this.method="POST",this.param=t.FlightDetailParamStore.getInstance(),this.result=t.FlightDetailsStore.getInstance(),$(originData.pols).each(function(t,n){var r=e(n.prices,psgType,"psgtype"),i=e(n.frinfo,psgType,"psgtype"),s=e(n.promos,1,"promotype"),o=e(n.notes,5,"notetype"),u=e(n.notes,4,"notetype"),a={"class":n.grades[0].grade,classForDisp:n.grades[0].dplclass,discount:r.discount,flag:u.notes&&u.notes[0]?u.notes[0].desc||u.notes[0].notes:"",fuelCost:r.fuel,price:r.price,tax:r.tax,rebateAmt:s.price||0,rebateRmk:s.promodates&&s.promodates[0]?s.promodates[0].rmk:"",giftCardInfo:e(n.pkginfo,2,"pkgtype"),promos:n.promos,pkginfo:n.pkginfo,polid:n.polid,rmk:{endNote:i.end,ext:null,notice:"",refNote:i.refnote,rerNote:i.rer,specialClass:"",ticketBody:"",ticketRmk:o.notes&&o.notes[0]?o.notes[0].desc||o.notes[0].notes:"",ticketTitle:o.notetit||""}};cabinsData.cabins.push(a)}),cabinsData}}),s.FlightOrderSumbitModel=new e.Class(i,{__propertys__:function(){this.url="/html5/Flight/AddFlightOrder",this.method="POST",this.param={dataVer:99,ver:99}},initialize:function($super,e){$super(e)}}),s.FlightOrderListModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/OrderList/Query",this.method="POST",this.param={dataVer:99,ver:99},this.result=t.FlightOrderListStore.getInstance(),this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.FlightOrderDetailModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Order/Query",this.method="POST",this.param={dataVer:99,ver:99},this.result=t.FlightOrderDetailStore.getInstance(),this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.FlightTicketRefundChangeModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Ticket/RefundChangeStatus/Query",this.result=t.FlightTicketRefundChangeStore.getInstance(),this.method="POST",this.param={},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.FlightTicketChangeModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Ticket/Change",this.method="POST",this.param={},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.FlightTicketRefundModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Ticket/Refund",this.method="POST",this.param={},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.FlightListModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/FlightList/Query",this.param=t.FlightSearchStore.getInstance(),this.result=t.FlightListStore.getInstance()},initialize:function($super,e){$super(e)}}),s.FlightAirlineModel=new e.Class(i,{__propertys__:function(){this.url="/Data/Airline?ver=1",this.method="GET",this.param={},this.result=t.FlightAirlineStore.getInstance(),this.dataformat=function(e){var t=e.airlines||[],n={};if(t.length)for(var r=0,i=t.length;r<i;r++)n[t[r].code]=t[r];return n}},initialize:function($super,e){$super(e)}}),s.FlightAircraftModel=new e.Class(i,{__propertys__:function(){this.url="/Data/Aircraft?ver=1",this.method="GET",this.param={},this.result=t.FlightAircraftStore.getInstance(),this.dataformat=function(e){var t=e.aircrafts||[],n={};if(t.length)for(var r=0,i=t.length;r<i;r++)n[t[r].type]=t[r];return n}},initialize:function($super,e){$super(e)}}),s.FlightPickTicketModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/DeliveryV2/Query",this.param={},this.result=t.FlightPickTicketStore.getInstance(),this.isUserData=!0},initialize:function($super,e){$super(e)},setFlightNo:function(e){var t=this.param.get();item=t.items&&t.items[0]||{},item.flightNo=e,t.items=[item],this.param.set(t)}}),s.FlightTicketRefundChangeModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Ticket/RefundChangeStatus/Query",this.result=t.FlightTicketRefundChangeStore.getInstance(),this.method="POST",this.param={},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.FlightTicketChangeModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Ticket/Change",this.method="POST",this.param={},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.ExpressStatusSearchModel=new e.Class(i,{__propertys__:function(){this.url="/customer/Express/status/query",this.method="POST",this.param={},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.LowestPriceSearchModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Flight/LowestPrice/Query",this.method="POST",this.param=t.LowestPriceSearchStore.getInstance(),this.result=t.FlightLowestPriceStore.getInstance()},initialize:function($super,e){$super(e)}}),s.SelectSeatModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/ModelFigure/Query",this.method="POST",this.param={},this.result=t.FlightSelectSeatStore.getInstance()},initialize:function($super,e){$super(e)}}),s.CheckinSearchModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/CheckIn/AircraftRulesSearch",this.method="POST",this.param=t.CheckinSearchParamStore.getInstance(),this.result=t.CheckinResultStore.getInstance()},initialize:function($super,e){$super(e)}}),s.CheckinListModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/CheckIn/CheckInListSearch",this.method="POST",this.param={ver:0},this.result=t.CheckinListStore.getInstance()},initialize:function($super,e){$super(e)}}),s.SeatSubmitModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Seat/Submit",this.method="POST",this.param={}},initialize:function($super,e){$super(e)}}),s.CheckinSegmentModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/CheckIn/CheckInSegmentSearch",this.method="POST",this.param={},this.result=t.CheckinSegmentStore.getInstance()},initialize:function($super,e){$super(e)}}),s.SubmitCheckinModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/CheckIn/CheckInSubmit",this.method="POST",this.param={}},initialize:function($super,e){$super(e)}}),s.CheckAirListModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/CheckIn/AircraftRulesSearch",this.method="POST",this.param={},this.result=t.CheckinAirListStore.getInstance()},initialize:function($super,e){$super(e)}}),s.OrderCreateModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Order/OrderCreate",this.method="POST",this.param={},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.CustomerCouponModel=new e.Class(i,{__propertys__:function(){this.method="POST",this.param={ver:1,pageIdx:1,flag:1},this.isUserData=!0,this.result=t.CustomerCouponStore.getInstance();var e=this;this.buildurl=function(){return e.protocol+"://"+e.getdomain().domain+"/"+e.getdomain().path+"/customer/coupon/query"}},initialize:function($super,e){$super(e)},getdomain:function(e){var e=e||window.location.host;return e.match(/^m\.ctrip\.com/i)||e.match(/^secure\.ctrip\.com/i)?(domain="m.ctrip.com",path="restapi"):e.match(/^(localhost|172\.16|127\.0)/i)||window.DEBUG_MODE?(domain="m.fat19.qa.nt.ctripcorp.com",path="restapi.common"):e.match(/^10\.8\.2\.111/i)||e.match(/^10\.8\.5\.10/i)?(domain="m.ctrip.com",path="restapi"):e.match(/^m\.uat\.qa\.ctripcorp\.com/i)?(domain="m.uat.qa.ctripcorp.com",path="restapi"):e.match(/^m\.fat/i)||e.match(/^waptest\.ctrip|^210\.13\.100\.191/i)||e.match(/^wapsecuretest\.ctrip|^210\.13\.100\.191/i)||window.DEBUG_MODE?(domain="m.fat19.qa.nt.ctripcorp.com",path="restapi.common"):(domain="m.ctrip.com",path="restapi"),{domain:domain,path:path}}}),s.PaymentModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Order/OrderSubmit",this.method="POST",this.param={ver:0},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.PaymentThirdModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Order/OrderSubmit",this.method="POST",this.param={ver:0},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.PaymentThirdPartySignatureForFlightSearch=new e.Class(i,{__propertys__:function(){this.method="POST",this.param={ver:1},this.isUserData=!0;var e=this;this.buildurl=function(){return e.getdomain().protocol+"://"+e.getdomain().domain+"/"+e.getdomain().path+"/Flight/International/PaymentRelationChange/Query"}},initialize:function($super,e){$super(e)},getdomain:function(e){var t="http",n="m.ctrip.com",r="restapi",e=e||window.location.host;return e.match(/^m\.ctrip\.com/i)||e.match(/^secure\.ctrip\.com/i)?(t="http",n="m.ctrip.com",r="restapi"):e.match(/^10\.8\.2\.111/i)||e.match(/^10\.8\.5\.10/i)?(t="http",n="m.ctrip.com",r="restapi"):e.match(/^m\.uat\.qa\.nt\.ctripcorp\.com/i)?(n="ws.mobile.flight.uat.ctripcorp.com",r="FlightWirelessApi"):e.match(/^(localhost|172\.16|127\.0)/i)?(t="http",n="172.16.156.70:88",r="restapi"):e.match(/^m\.fat/i)?(t="http",n="ws.mobile.flight.fat36.qa.nt.ctripcorp.com",r="FlightWirelessApi"):(t="http",n="m.ctrip.com",r="restapi"),{protocol:t,domain:n,path:r}}}),s.RepeatOrderCheckModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Order/RepeatOrderCheck",this.method="POST",this.param={ver:0},this.result=t.RepeatOrderCheckStore.getInstance(),this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.FlightVarListModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/FlightVarList/Query",this.method="POST",this.param={queryType:2,ver:0},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.XiaoMiModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/International/Miui/Push",this.method="POST",this.param={ver:0}},initialize:function($super,e){$super(e)}}),s.NonmemberLoginModel=new e.Class(i,{__propertys__:function(){this.url="/User/Nonmember/Login",this.method="POST",this.param={},this.isUserData=!0,this.protocol="https"},initialize:function($super,e){$super(e)}}),s.AddrCheckModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Delivery/AddressCheck",this.method="POST",this.param={ver:0},this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.FlightDetailModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/FlightDetailV2/Query",this.method="POST",this.param=t.FlightDetailParamStore.getInstance(),this.result=t.FlightDetailsStore.getInstance(),this.isUserData=!0},initialize:function($super,e){$super(e)}}),s.FlightOrderCreateModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/Order/OrderCreate",this.param={},this.method="POST"},initialize:function($super,e){$super(e)}}),s.FlightCabinModel=new e.Class(i,{__propertys__:function(){this.url="/Flight/Domestic/FlightDetailV2/Query",this.method="POST",this.param=t.FlightDetailParamStore.getInstance(),this.result=t.FlightCabinListStore.getInstance(),this.dataformat=this.formatData},initialize:function($super,e){$super(e)},formatData:function(e){function i(e,t,n){var r={};return $(e).each(function(e,i){if(t==i[n])return r=i,!1}),r}var n=t.FlightSearchStore.getInstance().getAttr("passengerType"),r=e.originData;return cabinsData={head:r.head,cabins:[],ext:null,flag:0},$(r.pols).each(function(e,t){var r=i(t.prices,n,"psgtype"),s=i(t.frinfo,n,"psgtype"),o=i(t.promos,1,"promotype"),u=i(t.notes,5,"notetype"),a=i(t.notes,4,"notetype"),f={"class":t.grades[0].grade,classForDisp:t.grades[0].dplclass,discount:r.discount,flag:a.notes&&a.notes[0]?a.notes[0].desc||a.notes[0].notes:"",fuelCost:r.fuel,price:r.price,tax:r.tax,rebateAmt:o.price||0,rebateRmk:o.promodates&&o.promodates[0]?o.promodates[0].rmk:"",giftCardInfo:i(t.pkginfo,2,"pkgtype"),promos:t.promos,pkginfo:t.pkginfo,polid:t.polid,rmk:{endNote:s.end,ext:null,notice:"",refNote:s.refnote,rerNote:s.rer,specialClass:"",ticketBody:"",ticketRmk:u.notes&&u.notes[0]?u.notes[0].desc||u.notes[0].notes:"",ticketTitle:u.notetit||""}};cabinsData.cabins.push(f)}),cabinsData}}),s.FlightOrderSumbitModel=new e.Class(i,{__propertys__:function(){this.url="/html5/Flight/AddFlightOrder",this.method="POST",this.param={dataVer:99,ver:99}},initialize:function($super,e){$super(e)}}),s}),define("flight/utility/utility",["c"],function(e){var t=/^(19[0-9]{2}|20[01]{1}\d{1})(0[1-9]{1}|1[0-2]{1})(0[1-9]{1}|[12]\d{1}|3[01]{1})$/,n={birthReg:t,ArrayIndexOf:Array.prototype.indexOf?function(e,t){return e=[].slice.call(e,0),e.indexOf(t)}:function(e,t){for(var n=e.length,r=!1;n--&&!r;){r=e[n]===t;if(r)return n}return n},QueryStringBuilder:function(e){function r(e){return e=e&&e.toLowerCase(),n.ArrayIndexOf(i,e)}function d(e,t){if(e&&t){var n=r(e);n>=0&&n<o.length?o[n]=t:(s.push(e),o.push(t),i.push(e.toLowerCase())),u[e]=t}return t}function v(e){var t=e?o[r(e)]:u;return t}function m(e){var t=u,n=r(e);e&&n>0?(delete u[e],s.splice(n,1),o.splice(n,1),i.splice(n,1)):(u={},s=[],o=[],i=[])}var t=arguments.callee;if(!(this instanceof t))return new t(e);var i=[],s=[],o=[],u={};if(e){var a=e.split("&");if(a)for(var f=a.length-1;f>=0;f--){var l=a[f],c=l&&l.split("="),h=c&&c[0],p=c&&c[1];h&&(u[h]=p,d(h,p))}}var g=function(e){try{e=e?decodeURIComponent(e):""}catch(t){}return encodeURIComponent(e).replace(/\*/g,"%2A").replace(/-/g,"%2D").replace(/_/g,"%5F").replace(/\./g,"%2E").replace(/!/g,"%21").replace(/~/g,"%7E").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")};this.set=d,this.get=v,this.remove=m,this.toString=function(e,t){e=e||"=",t=t||"&";var n=[];for(var r=0;r<s.length;r++)o[r]&&n.push(g(s[r])+e+g(o[r]));return n.join(t)||""}},getDaysOfMonth:function(e,t){var n=30;switch(t){case 1:case 3:case 5:case 7:case 8:case 10:case 12:n=31;break;case 2:n=e%4===0&&e%100!==0?29:28;break;default:n=30}return n},sendUbt:function(e,t){var n="";for(var r in t)t.hasOwnProperty(r)&&(n+=r+"="+t[r]+"&");n=n?n.substring(0,n.length-1):n,n+="&ver=20140825",window.$_bf&&window.$_bf.loaded===!0?window.$_bf.tracklog(e,n):setTimeout(function(){window.$_bf.tracklog(e,n)},500)},validateName:function(e,t,r,i,s,o,u,a){DataControl.errorType="",DataControl.errorMessage="";var f=/^[a-z]+\s*/i,l=/^[\u4e00-\u9fa5]{2,14}$/,c=/^[\u4e00-\u9fa5]$/;if(o==1){if(!r)return DataControl.errorMessage="请填写姓名",DataControl.errorType=".js_newName",DataControl.tipIconType=DataControl.TIPICONS.RED,u?t(DataControl.errorType,DataControl.errorMessage,a):"",!1;if(!l.test(r))return DataControl.errorMessage="填写正确的中文姓名",DataControl.errorType=".js_newName",DataControl.tipIconType=DataControl.TIPICONS.RED,u?t(DataControl.errorType,DataControl.errorMessage,a):"",!1}else{var h=o==8||o==7||o==10;if(!n.NoCard_C_E_Name(t.bind(e),r,i,s,h,o,u,a))return!1}return!0},validateFirstName:function(e,t,n,r){var i=/^\s*[a-z]+\s*$/i;return n=typeof n=="undefined"?!0:n,t==""?(DataControl.errorMessage="请填写姓",DataControl.errorType=".js_firstName",DataControl.tipIconType=DataControl.TIPICONS.RED,n?e(DataControl.errorType,DataControl.errorMessage,r):"",!1):i.test(t)?!0:(DataControl.errorMessage="请填写正确的英文姓氏",DataControl.errorType=".js_firstName",DataControl.tipIconType=DataControl.TIPICONS.RED,n?e(DataControl.errorType,DataControl.errorMessage,r):"",!1)},validateLastName:function(e,t,n,r,i){var s=/^\s*[a-z]+\s*[a-z]*\s*$/i;return r=typeof r=="undefined"?!0:r,n==""?(DataControl.errorMessage="请填写名",DataControl.errorType=".js_lastName",DataControl.tipIconType=DataControl.TIPICONS.RED,r?e(DataControl.errorType,DataControl.errorMessage,i):"",!1):s.test(n)?(t+n).length>26?(DataControl.errorMessage="英文姓名不能超过26个字符，如姓名过长请使用缩写，姓氏不能缩写，名可以缩写",DataControl.errorType=".js_enName",DataControl.tipIconType=DataControl.TIPICONS.RED,r?e(DataControl.errorType,DataControl.errorMessage,i):"",!1):!0:(DataControl.errorMessage="请填写正确的名",DataControl.errorType=".js_lastName",DataControl.tipIconType=DataControl.TIPICONS.RED,r?e(DataControl.errorType,DataControl.errorMessage,i):"",!1)},getBirth:function(e){var t=e.replace(/\s/g,"").substring(6,14);return t},formatBirth:function(e){return e=e||"",e+="",e&&e.length==8?e.slice(0,4)+"年"+e.slice(4,6)+"月"+e.slice(6,8)+"日":""},validateCard:function(t,r,i,s,o,u){o=typeof o=="undefined"?!0:o,DataControl.errorMessage="",DataControl.errorType="";if(r==1)return i.no=i.no.replace(/\s/g,""),i.birth=n.getBirth(i.no),!i.no||!i.no.length?(DataControl.errorMessage="请填写证件号码",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,o?t(DataControl.errorType,DataControl.errorMessage,u):"",!1):i.no.length==15?(DataControl.errorMessage="根据国家法律规定，第一代居民身份证自2013年1月1日起停止使用。请填写您的18位身份证号码。",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,o?t(DataControl.errorType,DataControl.errorMessage,u):"",!1):e.utility.validate.isIdCard(i.no)?!0:(DataControl.errorMessage="请填写正确的身份证号码!",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,o?t(DataControl.errorType,DataControl.errorMessage,u):"",!1);if(r!=1){var a=/^[A-Za-z0-9]+$/g;return!i.no||!i.no.length?(DataControl.errorMessage="请填写证件号码",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,o?t(DataControl.errorType,DataControl.errorMessage,u):"",!1):i.no.length>20?(DataControl.errorMessage="请填写正确的护照号码",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,o?t(DataControl.errorType,DataControl.errorMessage,u):"",!1):a.test(i.no)?r==25&&s&&DataControl.getAge(s)>=16?(DataControl.errorType=".js_birth",DataControl.errorMessage="年龄已满16岁，不允许使用户口簿",DataControl.tipIconType=DataControl.TIPICONS.BLUE,o?t(DataControl.errorType,DataControl.errorMessage,u):"",!1):r==27&&s&&DataControl.getAge(s)>=12?(DataControl.errorType=".js_birth",DataControl.errorMessage="年龄已满12岁，不允许使用出生证明",DataControl.tipIconType=DataControl.TIPICONS.BLUE,o?t(DataControl.errorType,DataControl.errorMessage,u):"",!1):!0:(DataControl.errorMessage=r!=2?"证件号码只能是英文或数字":"请填写正确的护照号码",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,o?t(DataControl.errorType,DataControl.errorMessage,u):"",!1)}},formatCardNo:function(e){e=e.replace(/\s/g,"");var t=[];return t[0]=e.substring(0,6),t[1]=e.substring(6,14),t[2]=e.substring(14),$.trim(t.join(" "))},testBirth:function(n,r,i,s,o){function u(t){var n=parseInt(t.substring(4,6),10),r=(new Date(e.base.Date.parse(t))).getMonth()+1;return n==r}return r=$.trim(r||""),r?!t.test(r)||t.test(r)&&!u(r)?(DataControl.errorType=".js_birth",DataControl.errorMessage="请输入正确的出生日期，格式如：19990909",DataControl.tipIconType=DataControl.TIPICONS.RED,i?n(DataControl.errorType,DataControl.errorMessage,o):"",!1):DataControl.getAge(r)==-2?(DataControl.errorType=".js_birth",DataControl.errorMessage="出生不满14天的婴儿不能登机",DataControl.tipIconType=DataControl.TIPICONS.BLUE,i?n(DataControl.errorType,DataControl.errorMessage,o):"",!1):s==25&&r&&DataControl.getAge(r)>=16?(DataControl.errorType=".js_birth",DataControl.errorMessage="年龄已满16周岁，不能使用户口簿",DataControl.tipIconType=DataControl.TIPICONS.BLUE,i?n(DataControl.errorType,DataControl.errorMessage,o):"",!1):s==27&&r&&DataControl.getAge(r)>=12?(DataControl.errorType=".js_birth",DataControl.errorMessage="年龄已满12周岁，不能使用出生证明",DataControl.tipIconType=DataControl.TIPICONS.BLUE,i?n(DataControl.errorType,DataControl.errorMessage,o):"",!1):!0:(DataControl.errorType=".js_birth",DataControl.errorMessage="请填写出生日期",DataControl.tipIconType=DataControl.TIPICONS.RED,i?n(DataControl.errorType,DataControl.errorMessage,o):"",!1)},NoCard_C_E_Name:function(e,t,n,r,i,s,o,u){t=t.replace(/\s/g,"");var a=/^[\u4e00-\u9fa5]{2,14}$/,f=/^[a-z]+\s*/i,l=/^\s*[a-z]+\s*$/i,c=/^\s*[a-z]+\s*[a-z]*\s*$/i,h=null,p=!0;return $("#cname-container-"+u).css("display")=="none"?(n==""&&(DataControl.errorMessage="请填写姓",DataControl.errorType=".js_firstName",o?e(DataControl.errorType,DataControl.errorMessage,u):"",p=!1),p&&!l.test(n)?(DataControl.errorMessage="请填写正确的英文姓氏",DataControl.errorType=".js_firstName",o?e(DataControl.errorType,DataControl.errorMessage,u):"",p=!1):n.length>26&&(DataControl.errorMessage="英文姓名不能超过26个字符，如姓名过长请使用缩写，姓氏不能缩写，名可以缩写",DataControl.errorType=".js_firstName",o?e(DataControl.errorType,DataControl.errorMessage,u):"",p=!1),r==""?(p&&(DataControl.errorMessage="请填写名",DataControl.errorType=".js_lastName"),o?e(".js_lastName","请填写名",u):"",p=!1):c.test(r)?r.length>26&&(DataControl.errorMessage="英文姓名不能超过26个字符，如姓名过长请使用缩写，姓氏不能缩写，名可以缩写",DataControl.errorType=".js_lastName",o?e(DataControl.errorType,DataControl.errorMessage,u):"",p=!1):(p&&(DataControl.errorMessage="请填写正确的名",DataControl.errorType=".js_lastName"),o?e(".js_lastName","请填写正确的名",u):"",p=!1),n&&n.length<26&&r&&r.length<26&&(n+r).length>26&&(p&&(DataControl.errorMessage="英文姓名不能超过26个字符，如姓名过长请使用缩写，姓氏不能缩写，名可以缩写",DataControl.errorType=".js_lastName"),o?e(".js_lastName","英文姓名不能超过26个字符，如姓名过长请使用缩写，姓氏不能缩写，名可以缩写",u):"",p=!1),p):t?(i?h=a.test(t)&&!DataControl.isFan(t):h=a.test(t),h?!0:(DataControl.errorMessage="填写正确的中文姓名",DataControl.errorType=".js_newName",o?e(DataControl.errorType,DataControl.errorMessage,u):"",!1)):(DataControl.errorMessage="请填写姓名",DataControl.errorType=".js_newName",o?e(DataControl.errorType,DataControl.errorMessage,u):"",!1)},checkPassenger:function(e,t,r,i,s,o){var u=[];_.isArray(r)?u=r:u[0]=r;var a=this;return _.every(u,function(r){var u=$.trim(r.cname),a=r.ename,f=r.firstName||"",l=r.lastName||"",c=r.defaIdCard||{},h=r.birth,p=c?c.type:1,d=r.gender,v=/^\w+\/\w+\s*\w+$/i,m=/^[\u4e00-\u9fa5]{2,14}$/,g=/^(19[0-9]{2}|20[01]{1}\d{1})(0[1-9]{1}|1[0-2]{1})(0[1-9]{1}|[12]\d{1}|3[01]{1})$/;c.birth=n.getBirth(c.no);switch(i){case"firstName":return n.validateFirstName(t,f,o,s);case"lastName":return n.validateLastName(t,f,l,o,s);case"ename":case"cname":return n.validateName(e,t,u,f,l,p,o,s);case"defaIdCard":return n.validateCard(t,p,c,h,o,s);case"birth":return n.testBirth(t,h,o,p,s)}})},rollMiddle:function(e){var t=$("body").height(),n=$(e).offset().top+$(e).height();n>t/2?document.body.scrollTop=n-t/2:document.body.scrollTop=0},showTip:function(e,t,r,i){var s=$(t).parent(),o='<div class="form-tips '+e+'">'+'<i class="flight-errtips-icon"></i>'+"<em>"+r+"</em>"+"</div>";s.find(".form-tips").length===0?s.append(o):(s.find(".form-tips").removeClass().addClass("form-tips "+e).show(),s.find(".form-tips em").text(r)),i&&(n.rollMiddle(t),s.find(".form-tips").addClass("twinkle"))},hideTip:function(e){var t=$(e).parent();t.find(".form-tips").hide()},isRepeatName:function(e){var t={},n=null;for(var r in e){if(t[e[r]]){n=e[r];break}t[e[r]]=e[r]}return n},popUp:function(e,t){var n=e.find(".j_singlePopup .j_popupCtn"),r=e.find(".j_singlePopup");n.html(t);var i=r.removeClass("js_hide").show().on("click",function(){$(this).addClass("js_hide")})},getDateItems:function(){function u(e,t){e+="";for(var n=0;n<t-e.length;n++)e="0"+e;return e}var e=new Date,t=e.getFullYear(),r=[],i=[],s=[];for(var o=t-80;o<=t;o++)r.push({key:n.formatZero(o,4),name:o+"年"});for(var o=1;o<=12;o++)i.push({key:n.formatZero(o,2),name:o+"月"});for(var o=1;o<=31;o++)s.push({key:n.formatZero(o,2),name:o+"日"});return[r,i,s]},getDayItem:function(e,t){var r=31,i=[];switch(t){case 1:case 3:case 5:case 7:case 8:case 10:case 12:r=31;break;case 2:r=e%4==0&&e%100!=0?29:28;break;default:r=30}for(var s=1;s<=r;s++)i.push({key:n.formatZero(s,2),name:s+"日"});return i},formatZero:function(e,t){e+="";for(var n=0;n<t-e.length;n++)e="0"+e;return e},add:function(e,t,n){var r=0,i,s,o=0;for(var u=0;u<arguments.length;u++)i=this.getDecimalCount(arguments[u]),r=Math.max(r,i);s=Math.pow(10,r);for(var a=0;a<arguments.length;a++)o+=arguments[a]*s;return o/s},mul:function(e,t){var n=0,r=0,i=0,s="",o=arguments.length,u=1;for(n=0;n<o;n++)u*=Number(arguments[n].toString().replace(".","")),r=this.getDecimalCount(arguments[n]),i+=r;return u/Math.pow(10,i)},getDecimalCount:function(e){var t=0;try{t=e.toString().split(".")[1].length}catch(n){t=0}return t}};return n}),define("lowpricecalendar",["cHolidayPriceCalendar","FlightModel","FlightStore","CommonStore","c"],function(e,t,n,r,i){var s=n.FlightSearchStore.getInstance(),o=n.LowestPriceSearchStore.getInstance(),u=r.SalesObjectStore.getInstance(),a=i.base,f=t.LowestPriceSearchModel.getInstance(),l={},c={},h={CreateCalendar:function(t,n,r){l.head={auth:null,errcode:0};var o=new Array;r=="back"?f.setParam({aCty:s.getSearchDetails(0,"dCtyCode"),dCty:s.getSearchDetails(0,"aCtyCode")}):f.setParam({aCty:s.getSearchDetails(0,"aCtyCode"),dCty:s.getSearchDetails(0,"dCtyCode")}),f.excute(function(f,h,p){f.prices=f.prices||[];for(var d=0,v=f.prices.length;d<v;d++)f.prices[d].dDate=new Date(f.prices[d].dDate.replace(/-/g,"/")),lowestDayKey=a.Date.format(f.prices[d].dDate,"Y/m/d"),c[lowestDayKey]=f.prices[d].price;o=f.prices,l.prices=o;var m=e.serverDate,g=m.getFullYear(),y=m.getMonth(),b=m.getDate(),w;for(var E=[],d=0,S=365;S>d;d++)E[d]={date:l.prices[d]?l.prices[d].dDate:a.Date.parse(a.Date.format(m,"Ymd")).addDay(d).date,price:l.prices[d]?l.prices[d].price:""};var x,T;r=="back"?(x=s.getSearchDetails(0,"acityName"),T=s.getSearchDetails(0,"dcityName")):(x=s.getSearchDetails(0,"dcityName"),T=s.getSearchDetails(0,"acityName"));var N=s.getAttr("_items")[0].date,C=a.Date.format(N,"Y-m-d"),k=s.getAttr("_items").length>1?a.Date.format(s.getAttr("_items")[1].date,"Y-m-d"):null,L=a.Date.format((new a.Date(m)).addDay(364),"Y-m-d"),A=new e({header:{title:'<span class="jPriceTitle">低价日历</span><span class="jPriceCity">'+x+"-"+T+"</span>",tel:"4000086666",home:!0,homeHandler:function(){var e=u.get();e&&e.sid&&+e.sid==1896?window.location="map://leftClick()":t.jump("/html5/",!0)}},monthsNum:13,format:"Y-m-d",priceDate:E,onShow:function(e){this.findMinPrice(),t.hideLoading(),t.isShowData=!1,$(".cui_cldweek").css("top","43px"),setTimeout(function(){t.__hide()},500),this.$el.find(".cui_cld_daycrt").removeClass("cui_cld_daycrt");try{var n=r=="start"?a.Date.format(m,"Y/m/d"):a.Date.format(N,"Y/m/d");this.$el.find(".cui_cld_daybox li").each(function(e,t){new Date($(t).data("date"))<new Date(n)&&($(this).removeClass(),$(this).addClass("cui_cld_daypass invalid"))}),r=="back"?(this.$el.find('[data-date="'+k+'"]').addClass("cui_cld_daycrt"),this.$el.find('[data-date="'+k+'"] em').text("返回")):(this.$el.find('[data-date="'+C+'"]').addClass("cui_cld_daycrt"),this.$el.find('[data-date="'+C+'"] em').text("出发")),flagHightLight=0}catch(i){}this.$el[0].offsetHeight},onHide:function(){t.hideLoading(),t.__show(),$("body").data("cui-date",""),this.remove(),t.isShowData=!0},callback:function(e,s,o){this.hide();var u=i.utility.Date.format(e,"Y/m/d");this.$el.find(".cui_cld_daycrt").removeClass("cui_cld_daycrt"),o.addClass("cui_cld_daycrt");var f=r=="start"?{start:e}:{back:e};u==a.Date.format(L,"Y/m/d")?f.back=a.Date.parse(L).date:k&&u>a.Date.format(k,"Y/m/d")&&r=="start"&&(f.back=a.Date.parse(u).addDay(1).date,0),n.call(t,e,r,f)}});A.show()},function(e){e&&e.msg?setTimeout(function(){t.showToast(e.msg,0,function(){t.back("index")})},1e3):setTimeout(function(){t.showToast("数据加载失败",0,function(){t.back("index")})},1e3)},!1,this)}};return h}),define("flight/dest/views/index",["libs","c","CommonStore","FlightStore","flight/utility/utility","FlightModel","cMultipleDate",buildViewTemplatesPath("index.html"),"cWidgetFactory","cWidgetCalendar","lowpricecalendar"],function(e,t,n,r,i,o,u,a,f,l,c){try{window["h5.flt.homepage.speed"]=window["h5.flt.homepage.speed"]||{},window["h5.flt.homepage.speed"].begin=Date.now()}catch(h){}var p="h5.flt.homepage",d=(t.ui,t.base),v=n.SalesObjectStore.getInstance(),m=r.MdIndexStore.getInstance(),g=f.create("Calendar"),y=new t.base.Class(t.ui.Layer,{__propertys__:function(){var e=this;this.contentDom,this.mask=new t.ui.Mask,this.mask.addEvent("onShow",function(){$(window).bind("resize",this.onResize),this.onResize();var t=this;this.root.bind("click",function(){t.hide(),t.root.unbind("click"),e.hide()})})},initialize:function($super,e){$super({onCreate:function(){},onShow:function(){for(var t in e)this[t]=e[t];this.mask.show(),this.setzIndexTop(),"string"==typeof this.html&&(this.html=$(this.html)),this.contentDom.html(this.html),this.closeDom&&this.contentDom.find(this.closeDom).on("click",function(){b&&b.hide()}),window.clearInterval(this.setIntervalResource);var n=$("body"),r=n.width()/2,i=n.height()/2.5;this.root.css({"margin-left":-r,"margin-top":-i})},onHide:function(){this.mask&&this.mask.hide()}})}}),b=null,w=r.FlightCCBStore.getInstance(),E=t.view.extend({pageid:"212003",tpl:a,hasAd:!0,adContainer:"in_footer",flightStore:r.FlightSearchStore.getInstance(),flightAdStore:r.FlightAdTimeOutStore.getInstance(),flightCityListStore:r.FlightCityListStore.getInstance(),flightInterCityListStore:r.FlightInterCityListStore.getInstance(),flightDeliveryStore:r.FlightPickTicketSelectStore.getInstance(),flightSearchSubjoin:r.FlightSearchSubjoinStore.getInstance(),flightFilterStore:r.FlightFilterStore.getInstance(),lowestPriceSearchStore:r.LowestPriceSearchStore.getInstance(),calendar:null,getAppUrl:function(){0;var e="";if(window.localStorage&&null!=window.localStorage.getItem("SALES")&&""!=window.localStorage.getItem("SALES")){var t=JSON.parse(window.localStorage.getItem("SALES"));null!=t.data&&(e=t.data.sourceid)}var n=this.flightStore.getSearchDetails(0,"date").replace(/\//g,""),r=this.flightStore.getSearchDetails(0,"dkey"),i=this.flightStore.getSearchDetails(0,"akey"),s=this.flightStore.getAttr("tabtype")||1,o="";if(1==s)o="/flight_inquire?c1="+s+"&c2="+r+"&c3="+i+"&c4="+n+"&extendSourceID="+e;else{var u=this.flightStore.getSearchDetails(1,"date").replace(/\//g,"");o="/flight_inquire?c1="+s+"&c2="+r+"&c3="+i+"&c4="+n+"&c5="+u+"&extendSourceID="+e}return 0,o},getQueryStringByName:function(e){var t=location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==t||t.length<1?"":t[1]},curTab:1,showTopPanel:!0,lockKey:!0,render:function(){this.viewdata.req=this.request,this.$el.html(this.tpl),this.els={elcitytabItems:this.$el.find(".city_tab li"),elpanelbox:this.$el.find("#panel-box"),elcitysel:this.$el.find("#citysel"),eldepartDatetop:this.$el.find("#js_departDate em"),eldepartDatebottom:this.$el.find("#js_departDate b"),elbackDatetop:this.$el.find("#js_backDate em"),elbackDatebottom:this.$el.find("#js_backDate b"),eldepartcity_w:this.$el.find("#js_departcity_w"),elbackcity_w:this.$el.find("#js_backcity_w"),elheader:this.$el.find("header"),elflightroot:this.$el.find(".flightroot")}},events:{"click #js_return":"backAction","click .city_tab li":"switchtabAction","click #js_departDate":"departDateAction","click #js_backDate":"backDateAction","click #js_departcity_w span":"selectDepartCityAction","click #js_backcity_w span":"selectBackCityAction","click #searchlistsubmit":"searchflightAction","click #js_exchange_btn":"exchangeAction","click .passenger":"selectPassenger","click .flight-img-svc":"promiseAction","click #checkin":"checkin","click #flightSchedule":"flightSchedule"},clearCurFilter:function(){this.flightFilterStore.remove(),this.flightSearchSubjoin.remove()},clearIntlFilter:function(){this.flightSearchSubjoin.removeAttr("departfilter-type"),this.flightSearchSubjoin.removeAttr("departfilter-value"),this.flightSearchSubjoin.removeAttr("departfilter-type-cabin"),this.flightFilterStore.removeAttr("departfilter-type"),this.flightFilterStore.removeAttr("departfilter-value"),this.flightSearchSubjoin.removeAttr("departfilter-type"),this.flightSearchSubjoin.removeAttr("departfilter-value"),this.flightSearchSubjoin.removeAttr("departfilter-type-cabin"),this.flightFilterStore.removeAttr("departfilter-type"),this.flightFilterStore.removeAttr("departfilter-value")},closeAdPanelAction:function(){this.flightAdStore.setAttr("top",!1),this.closeTopPanel(),this.els.eltoppanel.css("display","none")},backAction:function(){m.setAttr("IsReturn",!0);var e=v.get();try{this.mdSubmit()}catch(t){0}e&&e.sid&&1896==+e.sid?window.location="map://leftClick()":w.getAttr("isCCB")?this.jump("/webapp/mkt/ccb/"):this.jump("/html5/",!0)},exchangeAction:function(){m.increaseCntByKey("ChangeCityClick");var e=m.getAttr("DCity"),t=m.getAttr("ACity");m.setAttr("DCity",t),m.setAttr("ACity",e);var n,r,i,s,o,u,a,f,l,c,h=this.$el.find("#js_departcity_w"),p=this.$el.find("#js_departcity_w span"),d=this.$el.find("#js_backcity_w"),v=this.$el.find("#js_backcity_w span"),g=p.clone().removeClass(),y="<em>"+p.text()+"</em>",b=v.clone().removeClass(),w="<em>"+v.text()+"</em>",E=this;this.lockKey&&(this.lockKey=!1,p.addClass("switch_right"),v.addClass("switch_left"),setTimeout(function(){p.hasClass("switch_right")&&(h.html(g.html(w)),d.html(b.html(y))),E.lockKey=!0},500)),n=this.flightStore.getSearchDetails(0,"dCtyCode"),r=this.flightStore.getSearchDetails(0,"dCtyId"),i=this.flightStore.getSearchDetails(0,"dcityName"),s=this.flightStore.getSearchDetails(0,"dkey"),o=this.flightStore.getSearchDetails(0,"aCtyCode"),u=this.flightStore.getSearchDetails(0,"aCtyId"),a=this.flightStore.getSearchDetails(0,"acityName"),f=this.flightStore.getSearchDetails(0,"akey"),l=this.flightStore.getAttr("amode"),c=this.flightStore.getAttr("dmode"),this.flightStore.setSearchDetails(0,"dCtyCode",o),this.flightStore.setSearchDetails(0,"dCtyId",u),this.flightStore.setSearchDetails(0,"dcityName",a),this.flightStore.setSearchDetails(0,"dkey",f),this.flightStore.setSearchDetails(0,"aCtyCode",n),this.flightStore.setSearchDetails(0,"aCtyId",r),this.flightStore.setSearchDetails(0,"acityName",i),this.flightStore.setSearchDetails(0,"akey",s),this.flightStore.setSearchDetails(1,"dCtyCode",n),this.flightStore.setSearchDetails(1,"dCtyId",r),this.flightStore.setSearchDetails(1,"dcityName",i),this.flightStore.setSearchDetails(1,"dkey",s),this.flightStore.setSearchDetails(1,"aCtyCode",o),this.flightStore.setSearchDetails(1,"aCtyId",u),this.flightStore.setSearchDetails(1,"acityName",a),this.flightStore.setSearchDetails(1,"akey",f),this.flightStore.setAttr("amode",c),this.flightStore.setAttr("dmode",l)},searchflightAction:function(){m.setAttr("IsQuery",!0);var e=this.flightStore.getSearchDetails(0,"dCtyCode"),t=this.flightStore.getSearchDetails(0,"aCtyCode"),n=(this.flightStore.getAttr("tabtype"),this.flightStore.getAttr("amode")),r=this.flightStore.getAttr("dmode"),i=d.getServerDate().getTime();if(e===t)return void this.showToast("出发城市和到达城市相同，请重新选择");if(2==this.curTab){var s=this.flightStore.getSearchDetails(0,"aCtyCode"),o=this.flightStore.getSearchDetails(0,"acityName"),u=this.flightStore.getSearchDetails(0,"akey"),a=this.flightStore.getSearchDetails(0,"dCtyCode"),f=this.flightStore.getSearchDetails(0,"dcityName"),l=this.flightStore.getSearchDetails(0,"dkey"),c=parseInt(this.flightStore.getSearchDetails(0,"dCtyId")||0),h=parseInt(this.flightStore.getSearchDetails(0,"aCtyId")||0),p=this.flightStore.getSearchDetails(0,"dDportCode")||"",v=this.flightStore.getSearchDetails(0,"aAportCode")||"";this.flightStore.setSearchDetails(1,"aCtyCode",a),this.flightStore.setSearchDetails(1,"acityName",f),this.flightStore.setSearchDetails(1,"akey",l),this.flightStore.setSearchDetails(1,"dCtyCode",s),this.flightStore.setSearchDetails(1,"dcityName",o),this.flightStore.setSearchDetails(1,"dkey",u),this.flightStore.setSearchDetails(1,"dCtyId",h),this.flightStore.setSearchDetails(1,"aCtyId",c),this.flightStore.setSearchDetails(1,"dDportCode",v),this.flightStore.setSearchDetails(1,"aAportCode",p)}else this.flightStore.removeSearchDetails(1);this.flightStore.setAttr("submittime",i),this.flightStore.setCurSearchDetails([0]),this.flightStore.setAttr("ticketIssueCty",e);var g=!!this.flightStore.getAttr("tofltintl");this.clearCurFilter(),this.clearIntlFilter();try{this.mdSubmit()}catch(y){0}2==n||2==r||g?(this.flightStore.saveToFltintlSearch(),this.jump("/webapp/fltintl/#flightlist?v="+(new Date).getTime())):(this.flightStore.setAttr("passengerType",1),this.lowestPriceSearchStore.setAttr("aCty",t),this.lowestPriceSearchStore.setAttr("dCty",e),this.forward("list?v="+(new Date).getTime()))},selectDepartCityAction:function(){this.checkUcStore(),this.forward("citylist/!depart")},selectBackCityAction:function(){this.checkUcStore(),this.forward("citylist/!back")},switchtabAction:function(e){var t=$(e.currentTarget),n=1==t.data("type")?"OWClick":"RTClick",r=1==t.data("type")?"OW":"RT";m.increaseCntByKey(n),m.setAttr("FlightType",r),1==t.data("type")&&m.setAttr("ATime",""),this.switchTab(t.data("type"))},departDateAction:function(){this.isShowData&&(this.isShowData=!1,c.CreateCalendar(this,this.setPanelDate,"start"),this.checkUcStore())},backDateAction:function(){this.isShowData&&(this.isShowData=!1,c.CreateCalendar(this,this.setPanelDate,"back"),this.checkUcStore())},promiseAction:function(){m.setAttr("IsService",!0);var e=['<div class="flight-windows-svc"><img src="http://pic.c-ctrip.com/h5/flight/tc-fwcn.png" width="100%"></div>'].join(""),e=$(e);b||(b=new y({html:e,closeDom:".flight-windows-svc"})),b.show()},switchTab:function(e){this.flightStore.setAttr("tabtype",e),this.els.elcitytabItems.removeClass("cityTabCrt"),this.els.elcitytabItems.filter("[data-type='"+e+"']").addClass("cityTabCrt");switch(e){case 1:this.els.elpanelbox.removeClass("backtrack");var t=this.flightStore.getSearchDetails(0,"date");t=t?d.Date.parse(t).valueOf():(new d.Date(this.getServerDate())).addDay(1).valueOf(),this.setPanelDate(null,null,{start:t}),this.flightStore.setAttr("tripType",1);break;case 2:var t=this.flightStore.getSearchDetails(0,"date"),n=this.flightStore.getSearchDetails(1,"date"),r=(new d.Date(d.Date.format(this.getServerDate(),"Y-m-d"))).addDay(364).valueOf();t=t?d.Date.parse(t).valueOf():(new d.Date(this.getServerDate())).addDay(1).valueOf(),n?(n=d.Date.parse(n).valueOf(),t>n&&(n=t>=r?new Date(t.valueOf()):(new d.Date(t)).addDay(1).valueOf()),this.flightStore.setSearchDetails(1,"date",d.Date.format(n,"Y/m/d H:i:s"))):n=(new d.Date(t.valueOf())).addDay(1).valueOf(),this.flightStore.setAttr("tripType",2),t.setHours(0,0,0,0),n.setHours(0,0,0,0),t>n&&(n=(new d.Date(t)).addDay(1).valueOf()),t>r&&(t=new Date(r.valueOf())),n>=r&&(n=new Date(r.valueOf())),this.flightStore.setSearchDetails(0,"date",d.Date.format(t,"Y/m/d H:i:s")),this.flightStore.setSearchDetails(1,"date",d.Date.format(n,"Y/m/d H:i:s")),this.els.elpanelbox.addClass("backtrack"),this.setPanelDate(null,null,{start:t,back:n})}this.curTab=e},renderPage:function(e,t,n,r,i){var s=this,o=!1;if(m.setAttr("DCity",t),m.setAttr("ACity",n),null!=r&&null!=i){var u="",a="",f="",l="",c="",h="";if(r&&r.length>0)for(var p=0,d=r.length;d>p;p++)n&&""!=n&&(r[p].code.toLowerCase()==n.toLowerCase()||r[p].name==decodeURI(n)||r[p].id==n)&&(a=r[p].name,u=r[p].code,f=r[p].id,s.flightStore.setAttr("amode","1")),t&&""!=t&&(r[p].code.toLowerCase()==t.toLowerCase()||r[p].name==decodeURI(t)||r[p].id==t)&&(c=r[p].name,l=r[p].code,h=r[p].id,s.flightStore.setAttr("dmode","1"));if(i&&i.length>0)for(var p=0,d=i.length;d>p;p++)n&&""!=n&&(i[p].code.toLowerCase()==n.toLowerCase()||i[p].name==decodeURI(n)||i[p].id==n)&&(a=i[p].name,u=i[p].code,f=i[p].id,o=!0,s.flightStore.setAttr("amode","2")),t&&""!=t&&(i[p].code.toLowerCase()==t.toLowerCase()||i[p].name==decodeURI(t)||i[p].id==t)&&(c=i[p].name,l=i[p].code,h=i[p].id,o=!0,s.flightStore.setAttr("dmode","2"));(""==f||""==a)&&(u=s.flightStore.getSearchDetails(0,"aCtyCode")||"SHA",f=s.flightStore.getSearchDetails(0,"akey")||2,a=s.flightStore.getSearchDetails(0,"acityName")||"上海"),(""==h||""==c)&&(l=s.flightStore.getSearchDetails(0,"dCtyCode")||"BJS",h=s.flightStore.getSearchDetails(0,"dkey")||2,c=s.flightStore.getSearchDetails(0,"dcityName")||"北京"),e-2==0?(s.flightStore.setSearchDetails(0,"dCtyCode",l),s.flightStore.setSearchDetails(0,"dcityName",c),s.flightStore.setSearchDetails(0,"dkey",h),s.flightStore.setSearchDetails(0,"aCtyCode",u),s.flightStore.setSearchDetails(0,"acityName",a),s.flightStore.setSearchDetails(0,"akey",f),s.flightStore.setSearchDetails(1,"aCtyCode",l),s.flightStore.setSearchDetails(1,"acityName",c),s.flightStore.setSearchDetails(1,"akey",h),s.flightStore.setSearchDetails(1,"dCtyCode",u),s.flightStore.setSearchDetails(1,"dcityName",a),s.flightStore.setSearchDetails(1,"dkey",f)):(s.flightStore.setSearchDetails(0,"dCtyCode",l),s.flightStore.setSearchDetails(0,"dcityName",c),s.flightStore.setSearchDetails(0,"dkey",h),s.flightStore.setSearchDetails(0,"aCtyCode",u),s.flightStore.setSearchDetails(0,"acityName",a),s.flightStore.setSearchDetails(0,"akey",f),s.flightStore.removeSearchDetails(1)),s.flightStore.setAttr("ticketIssueCty",c),s.flightStore.setCurSearchDetails([0]),s.els.eldepartcity_w.find("em").html(c),s.els.elbackcity_w.find("em").html(a);var v=s.flightStore.getAttr("amode"),g=s.flightStore.getAttr("dmode");if(0,2==v||2==g){s.$el.find(".passenger").show();var y=s.flightStore.getAttr("passengerType");1==y?(s.$el.find(".passengerType").html("成人"),s.$el.find(".tips").hide()):(s.$el.find(".passengerType").html("儿童"),s.$el.find(".tips").show())}else s.$el.find(".passenger").hide()}},updatePage:function(e){var t=this,n=""!=t.getQueryStringByName("SearchType")&&null!=t.getQueryStringByName("SearchType")?t.getQueryStringByName("SearchType"):""!=t.getQueryStringByName("flighttype")&&null!=t.getQueryStringByName("flighttype")?t.getQueryStringByName("flighttype"):""!=t.getQueryStringByName("trip")&&null!=t.getQueryStringByName("trip")?t.getQueryStringByName("trip"):"";n=n.toLowerCase(),"d"==n?n=2:"s"==n&&(n=1);var r=t.flightStore.getAttr("tabtype")||1;""!=n&&(t.flightStore.setAttr("tabtype",n),t.flightStore.setAttr("__tripType",n),t.flightStore.setAttr("tripType",n),r=n);var i=""!=t.getQueryStringByName("dday")&&null!=t.getQueryStringByName("dday")?parseInt(t.getQueryStringByName("dday")):""!=t.getQueryStringByName("dayoffset")&&null!=t.getQueryStringByName("dayoffset")?parseInt(t.getQueryStringByName("dayoffset")):"";if(0==isNaN(i)&&i>0){var s=(new d.Date(d.getServerDate())).addDay(i).format("Y/m/d"),o=(new d.Date(d.getServerDate())).addDay(i+1).format("Y/m/d");r-2==0?(t.flightStore.setSearchDetails(0,"date",s),t.flightStore.setSearchDetails(1,"date",o)):t.flightStore.setSearchDetails(0,"date",s)}var u=""!=t.getQueryStringByName("dcity")&&null!=t.getQueryStringByName("dcity")?t.getQueryStringByName("dcity"):""!=t.getQueryStringByName("_dcity")&&null!=t.getQueryStringByName("_dcity")?t.getQueryStringByName("_dcity"):""!=t.getQueryStringByName("departure")&&null!=t.getQueryStringByName("departure")?t.getQueryStringByName("departure"):"",a=""!=t.getQueryStringByName("acity")&&null!=t.getQueryStringByName("acity")?t.getQueryStringByName("acity"):""!=t.getQueryStringByName("_acity")&&null!=t.getQueryStringByName("_acity")?t.getQueryStringByName("_acity"):""!=t.getQueryStringByName("arrival")&&null!=t.getQueryStringByName("arrival")?t.getQueryStringByName("arrival"):"";if(""!=u||""!=a){var f=null,l=null;null!=t.flightCityListStore.get()&&null!=t.flightInterCityListStore.get()?(f=t.flightCityListStore.get(),l=t.flightInterCityListStore.get(),t.renderPage(r,u,a,f.cities,l.cities)):(t.showLoading(),t.baseDataModel.excute(function(e){t.hideLoading(),t.renderPage(r,u,a,e.flightCityList.cities,e.flightInterCityList.cities)},function(){t.hideLoading()},t,t))}else{var c=t.flightStore.getSearchDetails(0,"dcityName"),h=t.flightStore.getSearchDetails(0,"acityName");t.els.eldepartcity_w.find("em").html(c),t.els.elbackcity_w.find("em").html(h),m.setAttr("DCity",c),m.setAttr("ACity",h);var p=t.flightStore.getAttr("amode"),g=t.flightStore.getAttr("dmode");if(2==p||2==g){t.$el.find(".passenger").show();var y=t.flightStore.getAttr("passengerType");1==y?(t.$el.find(".passengerType").html("成人"),t.$el.find(".tips").hide()):(t.$el.find(".passengerType").html("儿童"),t.$el.find(".tips").show())}else t.$el.find(".passenger").hide()}t.els.eldepartcity_w.find("span").removeClass(),t.els.elbackcity_w.find("span").removeClass(),t.switchTab(parseInt(r));var b=this.getQuery("sourceid");if(b&&+b>0){for(var w=0,E=["497","1107","1108","3516","3512","3511","3503","3513","1595","1596","3524","3517","3518","1591","1825","1826","1827","1828","1829","1830","1831"],S=0,x=E.length;x>S;S++){var T=E[S];if(T==b){w=1;break}}w&&this.footer.checkForceDownload(b)}var N=v.get();(b&&(1575==+b||1867==+b)||N&&N.sid&&(1575==+N.sid||1867==+N.sid))&&(this.$el.find("#in_footer").hide(),this.$el.find("#js_return").hide(),this.footer&&this.footer.hide(),this.hasAd=!1);var C=1===this.flightStore.getAttr("tabtype")?"OW":"RT";m.setAttr("FlightType",C),e.call(this)},createCalendar:function(){var e=this.getServerDate(),t=this,n=this.flightStore.getSearchDetails(0,"date"),r=this.flightStore.getSearchDetails(1,"date");n=n?d.Date.parse(n).valueOf():this.getServerDate(),e>n&&(n=e,this.flightStore.setSearchDetails(0,"date",d.Date.format(n,"Y/m/d"))),r=r?d.Date.parse(r).valueOf():(new d.Date(n)).addDay(1).valueOf();var t=this;this.calendar=new g({Months:13,date:{start:{headtitle:"出发日期选择",title:function(e,t){var n="<em>"+t(e)+"</em><i>出发</i>";return n},value:n},back:{headtitle:"返程日期选择",title:function(e,t){var n="<em>"+t(e)+"</em><i>返回</i>";return n},value:r,bound:{rules:{">":"start"},error:function(){t.showToast("请选择比出发日期更晚的时间",1)}}}},title:"出发日期选择",callback:function(e,n,r,i,s){var o=r.start,u=r.back;"start"===n&&o>=u&&this.setDate(s>o?{back:(new d.Date(o)).addDay(1).valueOf(),start:o}:{back:new Date(o),start:o}),t.setPanelDate.apply(t,arguments),this.hide()},onShow:function(){t.$el.hide(),t.setCalendarUbt()},onHide:function(){window.scrollTo(0,0),t.$el.show(),t.recoverIndexUbt()}}),this.calendar.create(),this.flightStore.setAttr("calendarendtime",d.Date.format(this.calendar.getEndDate(),"Y/m/d H:i:s"))},setPanelDate:function(e,t,n,r){var i,e,r;for(var s in n)switch(i=[],e=n[s],r=this.calendar.getDateInfo(e),r.chineseday&&i.push(r.chineseday),r.holiday&&i.push(r.holiday),r.daytitle&&(i=[r.daytitle]),i.push(r.week),s){case"start":this.els.eldepartDatetop.html(d.Date.format(e,"m月d日")),this.els.eldepartDatebottom.html(i[0]),this.flightStore.setSearchDetails(0,"date",d.Date.format(e,"Y/m/d"));try{m.setAttr("DTime",d.Date.format(e,"Y/m/d"))}catch(o){0}break;case"back":this.els.elbackDatetop.html(d.Date.format(e,"m月d日")),this.els.elbackDatebottom.html(i[0]),this.flightStore.setSearchDetails(1,"date",d.Date.format(e,"Y/m/d"));try{m.setAttr("ATime",d.Date.format(e,"Y/m/d"))}catch(o){0}}},onCreate:function(){this.render(),this.createCalendar(),this.baseDataModel=new u({models:{flightCityList:o.FlightCityListModel.getInstance(),flightInterCityList:o.FlightInterCityListModel.getInstance()}})},onLoad:function(){$("meta[name='viewport']").attr("content","width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no");for(var e=document.getElementsByTagName("meta"),t=0;t<e.length;t++)"viewport"==e[t].getAttribute("name")&&e[t].setAttribute("content","width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no");this.isShowData=!0;var n="";if(window.localStorage&&null!=window.localStorage.getItem("SALES")&&""!=window.localStorage.getItem("SALES")){var r=JSON.parse(window.localStorage.getItem("SALES"));null!=r.data&&(n=parseInt(r.data.sourceid))}v.get();if(449843==this.getQuery("sid")||449843==this.getQueryStringByName("sid")||this.getQueryStringByName("sid")+""=="449843"){var i=this.getQueryStringByName("os")||this.getQuery("os")||1,s=this.getQueryStringByName("osver")||this.getQuery("osver")||"2.18";w.setAttr("osType",i),w.setAttr("osVer",s),w.setAttr("isCCB",!0)}try{window["h5.flt.homepage.speed"].updatePageBegin=Date.now()}catch(o){}this.updatePage(function(){try{window["h5.flt.homepage.speed"].updatePageEnd=Date.now()}catch(e){}this.turning();try{window["h5.flt.homepage.speed"].end=Date.now(),"undefined"==typeof window.__bfi&&(window.__bfi=[]);var t={onloadTime:window["h5.flt.homepage.speed"].end-window["h5.flt.homepage.speed"].begin,updatePageTime:window["h5.flt.homepage.speed"].updatePageEnd-window["h5.flt.homepage.speed"].updatePageBegin};window.__bfi.push(["_tracklog","h5.flt.homepage.speed",JSON.stringify(t)])}catch(e){}})},onShow:function(){this.setTitle("机票搜索页")},onHide:function(){this.resizehandler&&$(window).unbind("resize",this.resizehandler),$("meta[name='viewport']").attr("content","width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"),this.hideLoading()},checkUcStore:function(){if(navigator.userAgent.indexOf(" UCBrowser")>-1){this.flightStore.setAttr("rcsay","imbad");var e=this.flightStore.getAttr("rcsay");"imbad"!=e&&window.location.reload()}},setCalendarUbt:function(){this.pageid="214278"},recoverIndexUbt:function(){this.pageid="212003"},selectPassenger:function(){var e=this,n=this.$el.find(".passenger"),r=[{key:"成人"},{key:"儿童(2～12岁)"}],i=1==e.flightStore.getAttr("passengerType")?0:1;s=new t.ui.ScrollRadioList({title:"乘客类型",index:n.attr("index"),index:i,data:r,content:1,disItemNum:3,itemClick:function(t){var n=1==t.index?2:1;e.flightStore.setAttr("passengerType",n),2==n?(e.$el.find(".tips").show(),e.$el.find(".passengerType").html("儿童")):(e.$el.find(".tips").hide(),e.$el.find(".passengerType").html("成人"))}}),s.show()},checkin:function(){m.setAttr("IsChooseSeat",!0);try{this.mdSubmit()}catch(e){0}this.jump("/webapp/flight/#checkin")},flightSchedule:function(){m.setAttr("IsFlightSituation",!0);try{this.mdSubmit()}catch(e){0}this.jump("/html5/Flight/Schedule/")},mdSubmit:function(){i.sendUbt(p,m.get()),m.remove()}});return E}),define("adLayer",["libs","cBase","cUIAbstractView","cUIMask"],function(e,t,n,r){var i={},s={prefix:"cui-"};return i.__propertys__=function(){this.tpl=this.template(['<div class="'+s.prefix+'layer-padding">','<div class="'+s.prefix+'layer-content"><%=content%></div>',"</div>"].join("")),this.content="",this.contentDom,this.mask=new r({classNames:[s.prefix+"opacitymask"]}),this.addClass(s.prefix+"layer"),this.viewdata={},this.windowResizeHander,this.setIntervalResource,this.setIntervalTotal=0},i.initialize=function($super,e){var t={content:!0};this.setOption(function(e,n){switch(!0){case t[e]:this[e]=n;break;case"class"===e:this.addClass(n)}}),this.bindEvent(),$super(e),this.loadViewData()},i.loadViewData=function(){this.viewdata.content=this.content},i.setViewData=function(e){this.viewdata=cUtility.mix(this.viewdata,e),this.setRootHtml(this.createHtml())},i.bindEvent=function(){this.addEvent("onCreate",function(){this.windowResizeHander=$.proxy(this.reposition,this),this.contentDom=this.root.find("."+s.prefix+"layer-content")}),this.addEvent("onShow",function(){this.mask.show(),$(this.mask.root[0]).removeClass("cui-mask").css({"z-index":2e3}),$(window).bind("resize",this.windowResizeHander),this.root.css("visibility","hidden"),this.reposition(),this.setIntervalResource=setInterval($.proxy(function(){this.setIntervalTotal<10?this.windowResizeHander():(this.setIntervalTotal=0,this.root.css("visibility","visible"),clearInterval(this.setIntervalResource)),this.setIntervalTotal++},this),1),this.setzIndexTop()}),this.addEvent("onHide",function(){$(window).unbind("resize",this.windowResizeHander),clearInterval(this.setIntervalResource),this.root.css("visibility","visible"),this.mask.hide()})},i.createHtml=function(){return this.tpl(this.viewdata)},i.maskToHide=function(e){this.mask.root.on("click",$.proxy(function(){this.hide(),typeof e=="function"&&e(),this.mask.root.off("click")},this)),this.mask.addEvent("onHide",function(){this.root.off("click"),this.root.remove()})},new t.Class(n,i)}),define("adLoad",["libs","cBase","adLayer"],function(e,t,n){var r="",i={},s={prefix:"cui-"},o="width: 150px; height: 75px;  border-radius: 5px; background: rgba(0,0,0,0.7);  margin: auto; position: relative; z-index: 9999;",u={};return u["class"]=s.prefix+"loading",u.onCreate=function(){},u.onHide=function(){0,r!=""&&(clearTimeout(r),r="")},u.onShow=function(){0,this.contentDom.html('<div   class="cui-breaking-load flight-loading" ><div class="cui-i cui-w-loading" style="top:-20px;"></div><div class="cui-i cui-m-logo"  style="top:-20px;" ></div><div id="js_loadFrame" style="position:absolute;top:30px; left:-45px;"><div class="jsFlightCanvas"  ><div class="js_MY_loadText" style="text-align:center;color:#099fde;width:140px;height:20px;" ></div></div></div></div>'),this.reposition();var e=["100%价格保证","一站式售后保障","7x24小时热线服务"],t=4,n=0,i=function(){n>2&&(n=0);var s=e[n];$(".js_MY_loadText").html(s),n++,r=setTimeout(i,t*1e3)};i()},i.__propertys__=function(){this.contentDom,this.loadHtml=""},i.initialize=function($super){$super(u)},i.setHtml=function(e){this.loadHtml=e},new t.Class(n,i)}),define("flight/dest/views/list",["cSales","libs","c","CommonStore","FlightModel","FlightStore","flight/utility/utility","cMultipleDate","adLoad",buildViewTemplatesPath("list.html")],function(e,t,n,r,i,s,o,u,a,f){try{window["h5.flt.searchresult.speed"]=window["h5.flt.searchresult.speed"]||{},window["h5.flt.searchresult.speed"].begin=Date.now()}catch(l){}var c="h5.flt.searchresult",h=s.MdListStore.getInstance(),p=s.MdTransStore.getInstance();require(["cHolidayPriceCalendar"],function(){try{window["h5.flt.searchresult.speed"].loadCalendarEnd=Date.now()}catch(e){}});try{setTimeout(function(){var e=1==localStorage.getItem("__DEBUG__")?"flight/views/bookinginfo":"flight/dest/views/bookinginfo";require([e],function(){0},function(){0})},200)}catch(l){0}var d=(n.ui,n.base),v=r.SalesObjectStore.getInstance(),m={},g={},y=s.FlightCCBStore.getInstance(),b=new a,w=n.view.extend({pageid:"212004",hasAd:!1,tpl:f,flightSearchSubjoin:s.FlightSearchSubjoinStore.getInstance(),flightSearchStore:s.FlightSearchStore.getInstance(),flightFilterStore:s.FlightFilterStore.getInstance(),flightList:i.FlightListModel.getInstance(),flightCityListStore:s.FlightCityListStore.getInstance(),flightInterCityListStore:s.FlightInterCityListStore.getInstance(),lowestPrice:i.LowestPriceSearchModel.getInstance(),lowestPriceStore:s.LowestPriceSearchStore.getInstance(),flightSelectedStore:s.FlightSelectedInfo.getInstance(),flightOrderStore:s.FlightOrderInfoStore.getInstance(),flightDeliveryStore:s.FlightPickTicketSelectStore.getInstance(),flightListStore:s.FlightListStore.getInstance(),baseDataModel:null,basedata:null,cityType:null,sdatalist:"[]",IsDate:function(e){var t=/^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)$/;return t.exec(e)?!0:!1},getAppUrl:function(){0;var e="";if(window.localStorage&&null!=window.localStorage.getItem("SALES")&&""!=window.localStorage.getItem("SALES")){var t=JSON.parse(window.localStorage.getItem("SALES"));null!=t.data&&(e=parseInt(t.data.sourceid))}var n=this.flightSearchStore.getSearchDetails(0,"date").replace(/\//g,""),r=this.flightSearchStore.getSearchDetails(0,"dCtyId"),i=this.flightSearchStore.getSearchDetails(0,"aCtyId"),s=this.flightSearchStore.getAttr("tabtype")||1,o="";if(1==s)o="/flight_inland_singlelist?c1="+s+"&c2="+r+"&c3="+i+"&c4="+n+"&extendSourceID="+e;else{var u=(this.flightSearchStore.getSearchDetails(1,"date")||"").replace(/\//g,"");o="/flight_inland_tolist?c1="+s+"&c2="+r+"&c3="+i+"&c4="+n+"&c5="+u+"&extendSourceID="+e}return o},getSdateList:function(){return JSON.parse(this.sdatalist)},renderPage:function(e,t,n,r,i){var s=this;if(null!=r){var o="",u="",a="",f="",l="",c="";if(r&&r.length>0)for(var h=0,p=r.length;p>h;h++)n&&""!=n&&(r[h].code.toLowerCase()==n.toLowerCase()||r[h].name==decodeURI(n)||r[h].id==n)&&(u=r[h].name,o=r[h].code,a=r[h].id,s.flightSearchStore.setAttr("amode","1")),t&&""!=t&&(r[h].code.toLowerCase()==t.toLowerCase()||r[h].name==decodeURI(t)||r[h].id==t)&&(l=r[h].name,f=r[h].code,c=r[h].id,s.flightSearchStore.setAttr("dmode","1"));(""==a||""==u)&&(o=s.flightSearchStore.getSearchDetails(0,"aCtyCode")||"SHA",a=s.flightSearchStore.getSearchDetails(0,"akey")||2,u=s.flightSearchStore.getSearchDetails(0,"acityName")||"上海"),(""==c||""==l)&&(f=s.flightSearchStore.getSearchDetails(0,"dCtyCode")||"BJS",c=s.flightSearchStore.getSearchDetails(0,"dkey")||2,l=s.flightSearchStore.getSearchDetails(0,"dcityName")||"北京"),e-2==0?(s.flightSearchStore.setSearchDetails(0,"dCtyCode",f),s.flightSearchStore.setSearchDetails(0,"dcityName",l),s.flightSearchStore.setSearchDetails(0,"dkey",c),s.flightSearchStore.setSearchDetails(0,"aCtyCode",o),s.flightSearchStore.setSearchDetails(0,"acityName",u),s.flightSearchStore.setSearchDetails(0,"akey",a),s.flightSearchStore.setSearchDetails(1,"aCtyCode",f),s.flightSearchStore.setSearchDetails(1,"acityName",l),s.flightSearchStore.setSearchDetails(1,"akey",c),s.flightSearchStore.setSearchDetails(1,"dCtyCode",o),s.flightSearchStore.setSearchDetails(1,"dcityName",u),s.flightSearchStore.setSearchDetails(1,"dkey",a)):(s.flightSearchStore.setSearchDetails(0,"dCtyCode",f),s.flightSearchStore.setSearchDetails(0,"dcityName",l),s.flightSearchStore.setSearchDetails(0,"dkey",c),s.flightSearchStore.setSearchDetails(0,"aCtyCode",o),s.flightSearchStore.setSearchDetails(0,"acityName",u),s.flightSearchStore.setSearchDetails(0,"akey",a),s.flightSearchStore.removeSearchDetails(1)),s.flightSearchStore.setAttr("ticketIssueCty",f),s.flightSearchStore.setCurSearchDetails([0]),s.updatePageDate(),s.reloadData(i)}},getSemParam:function(e){var t=this,n=this.getServerDate(),r=""!=t.getQuery("SearchType")&&null!=t.getQuery("SearchType")?t.getQuery("SearchType"):""!=t.getQuery("flighttype")&&null!=t.getQuery("flighttype")?t.getQuery("flighttype"):""!=t.getQuery("trip")&&null!=t.getQuery("trip")?t.getQuery("trip"):"";r=r.toLowerCase(),"d"==r?r=2:"s"==r&&(r=1);var i=t.flightSearchStore.getAttr("tabtype")||1;""!=r&&(t.flightSearchStore.setAttr("tabtype",r),t.flightSearchStore.setAttr("__tripType",r),t.flightSearchStore.setAttr("tripType",r),i=r);var s=""!=t.getQuery("dday")&&null!=t.getQuery("dday")?parseInt(t.getQuery("dday")):""!=t.getQuery("dayoffset")&&null!=t.getQuery("dayoffset")?parseInt(t.getQuery("dayoffset")):"";if(0==isNaN(s)&&s>0){var o=(new d.Date(n)).addDay(s).format("Y/m/d"),u=(new d.Date(n)).addDay(s+1).format("Y/m/d");i-2==0?(t.flightSearchStore.setSearchDetails(0,"date",o),t.flightSearchStore.setSearchDetails(1,"date",u),h.setAttr("DTime",o),h.setAttr("ATime",u)):(t.flightSearchStore.setSearchDetails(0,"date",o),h.setAttr("DTime",o))}var a=""!=t.getQuery("dcity")&&null!=t.getQuery("dcity")?t.getQuery("dcity"):""!=t.getQuery("_dcity")&&null!=t.getQuery("_dcity")?t.getQuery("_dcity"):""!=t.getQuery("departure")&&null!=t.getQuery("departure")?t.getQuery("departure"):"",f=""!=t.getQuery("acity")&&null!=t.getQuery("acity")?t.getQuery("acity"):""!=t.getQuery("_acity")&&null!=t.getQuery("_acity")?t.getQuery("_acity"):""!=t.getQuery("arrival")&&null!=t.getQuery("arrival")?t.getQuery("arrival"):"";if(""!=a&&""!=f){var l=null,c=null;if(null!=t.flightCityListStore.get())l=t.flightCityListStore.get(),c=t.flightInterCityListStore.get(),t.renderPage(i,a,f,l.cities,e);else{try{window["h5.flt.searchresult.speed"].loadBaseDataBegin=Date.now()}catch(p){}t.baseDataModel.excute(function(n,r,s){try{s&&(window["h5.flt.searchresult.speed"].loadBaseDataEnd=Date.now())}catch(o){}t.renderPage(i,a,f,n.flightCityList.cities,e)},function(){b.hide()},t,t)}}else t.updatePageDate(),this.reloadData(e)},datalist:[],isEmpty:!1,isRedirect:!1,getQueryStringByName:function(e){var t=location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==t||t.length<1?"":t[1]},render:function(){this.viewdata.req=this.request;try{window["h5.flt.searchresult.speed"].renderTplBegin=Date.now()}catch(e){}this.$el.html(this.tpl);try{window["h5.flt.searchresult.speed"].renderTplEnd=Date.now()}catch(e){}this.els={elf_list:this.$el.find(".f_list"),elflightlisttpl:this.$el.find("#flightlisttpl"),elt1:this.$el.find(".tab_time .t1"),elt2:this.$el.find(".tab_time .t2"),elt3:this.$el.find(".tab_time .t3"),elt4:this.$el.find(".tab_time .t4"),eltabby:this.$el.find(".tab_by li"),eltabtime:this.$el.find('li[data-type="time"]'),eltabfilter:this.$el.find('li[data-type="filter"]'),eltabprice:this.$el.find('li[data-type="price"]'),elflightTotal:this.$el.find("#flightTotal"),eltitle:this.$el.find("#title"),elemptylisttpl:this.$el.find("#emptylisttpl")},this.flightListTplFun=_.template(this.els.elflightlisttpl.html()),this.isShowData=!0},events:{"click #js_return":"backAction","click #js_home":"homeAction","click .tab_time li":"switchDate","click .js_subswitch":"switchsubListAction","click .js_flight_item":"tapFlightitemAction","click .js_flight_seat":"tapFlightSeatAction","click .tab_by li":"tapSortAction"},tapSortAction:function(e){var t,n=$(e.currentTarget),r=n.attr("data-type");switch(r){case"time":if(this.isEmpty)return;switch(h.addOpValue("SortWay","Time"),this.flightSearchSubjoin.setAttr("depart-sorttype","time"),t=this.flightSearchSubjoin.getAttr("depart-orderby")||"asc",n.hasClass("hover")||(t="asc"==t?"desc":"asc"),t){case"desc":this.flightSearchSubjoin.setAttr("depart-orderby","asc"),this.renderList();break;case"asc":this.flightSearchSubjoin.setAttr("depart-orderby","desc"),this.renderList()}break;case"filter":h.setAttr("IsFilter",!0),this.forward("flightlistfilter");break;case"price":if(this.isEmpty)return;if(h.addOpValue("SortWay","Price"),"price"!==this.flightSearchSubjoin.getAttr("depart-sorttype"))this.flightSearchSubjoin.setAttr("depart-sorttype","price"),this.renderList();else switch(t=this.flightSearchSubjoin.getAttr("depart-orderby")||"desc"){case"desc":this.flightSearchSubjoin.setAttr("depart-orderby","asc"),this.renderList();break;case"asc":this.flightSearchSubjoin.setAttr("depart-orderby","desc"),this.renderList()}}},sortHandler:{time_Asc:function(e,t){var n=d.Date.parse(e.dTime).valueOf(),r=d.Date.parse(t.dTime).valueOf();return n-r},time_Desc:function(e,t){var n=d.Date.parse(e.dTime).valueOf(),r=d.Date.parse(t.dTime).valueOf();return r-n},price_Asc:function(e,t){var n=e.cabins&&e.cabins[0]&&e.cabins[0].price||0,r=t.cabins&&t.cabins[0]&&t.cabins[0].price||0;return n-r},price_Desc:function(e,t){var n=e.cabins&&e.cabins[0]&&e.cabins[0].price||0,r=t.cabins&&t.cabins[0]&&t.cabins[0].price||0;return r-n}},homeAction:function(){var e=v.get();e&&e.sid&&1896==+e.sid?window.location="map://leftClick()":this.jump(y.getAttr("isCCB")?"/webapp/mkt/ccb/":"/html5/")},backAction:function(){h.setAttr("IsReturn",!0);try{this.mdSubmit()}catch(e){0}0,this.back("index")},tapFlightitemAction:function(e){var t=$(e.currentTarget),n=$(e.target);if(!n.is(".js_subswitch")){var r=t.attr("data-key"),i=t.attr("data-ckey"),s=this.datalist[r];if(s.cabins.length>i){var o=s.cabins[i];if(!o)return void this.showToast("对不起，由于您长时间未操作，请重新查询");this.flightSelectedStore.setAttr("depart",{flight:s,cabin:o}),this.toNextPage(s,o)}}},tapFlightSeatAction:function(e){var t=$(e.currentTarget),n=t.attr("data-key"),r=t.attr("data-parent-key"),i=this.datalist[r],s=i.cabins&&i.cabins[n];if(!s)return void this.showToast("对不起，由于您长时间未操作，请重新查询");try{var o=2==s.class?"C":3==s.class?"F":"Y";h.setAttr("SubClass",o),h.setAttr("FlightNoSequence",r);var u=t.parent().find("li").length;switch(!0){case 0===+n:h.setAttr("SubClassSequence",1);break;case+n===u-1:h.setAttr("SubClassSequence",-1);break;default:h.setAttr("SubClassSequence",0)}s.rebateAmt>0&&h.setAttr("ActiveType","PayBack")}catch(e){0}this.flightSelectedStore.setAttr("depart",{flight:i,cabin:s}),this.toNextPage(i,s)},toNextPage:function(e){var t=+(this.flightSearchStore.getAttr("tabtype")||1);switch(this.flightSelectedStore.removeAttr("arrive"),this.flightOrderStore.setAttr("selInsure","1"),t){case 1:this.isRedirect=!0,this.flightSearchStore.setAttr("fullCabin",!1);try{this.mdSubmit()}catch(n){0}this.forward("bookinginfo"),window.__isRequireBookininfoSucc||window.location.reload();break;case 2:this.flightSearchStore.getSearchDetails(0,"date")+" "+(e.dTime||"").substr(10,8),this.flightSearchStore.setAttr("tripType",2),this.flightSearchStore.setCurSearchDetails([0,1]);var r=this.flightSearchStore.getAttr("_items")[0].date,i=this.flightSearchStore.getAttr("_items")[1].date;(new Date(r)).getTime()>(new Date(i)).getTime()?this.flightSearchStore.setSearchDetails(1,"date",d.Date.format((new d.Date(r)).addDay(1),"Y/m/d")):"";try{this.mdSubmit()}catch(n){0}0,this.forward("backlist")}},clearCurFilter:function(){this.flightSearchSubjoin.removeAttr("departfilter-type"),this.flightSearchSubjoin.removeAttr("departfilter-value"),this.flightFilterStore.removeAttr("departfilter-type"),this.flightFilterStore.removeAttr("departfilter-value")},resetSort:function(){this.flightSearchSubjoin.setAttr("depart-sorttype","time"),this.flightSearchSubjoin.setAttr("depart-orderby","asc")},switchsubListAction:function(e){var t=$(e.currentTarget),n=t.parent(),r=n.next(".js_sublist");try{h.addOpValue("MoreClassSequence",n.data("key"))}catch(e){0}"block"===r.css("display")?(r.hide(),t.removeClass("flight-packup").addClass("flight-packdown")):(r.show(),t.removeClass("flight-packdown").addClass("flight-packup"))},switchDate:function(e){var t=this;if("cheap-calendar"==$(e.currentTarget)[0].className||"today t2"==$(e.currentTarget)[0].className){if(!this.isShowData)return;this.isShowData=!1,m.prices&&m.prices.length>0&&require(["cHolidayPriceCalendar"],function(e){for(var r=e.serverDate,i=(r.getFullYear(),r.getMonth(),r.getDate(),[]),s=0,o=m.prices.length;o>s;s++)i[s]={date:m.prices[s].dDate,price:m.prices[s].price};var u=t.flightSearchStore.getSearchDetails(0,"dcityName"),a=t.flightSearchStore.getSearchDetails(0,"acityName"),f=new e({header:{title:'<span class="jPriceTitle">低价日历</span><span class="jPriceCity">'+u+"-"+a+"</span>",tel:"4000086666",home:!0,homeHandler:function(){var e=v.get();e&&e.sid&&1896==+e.sid?window.location="map://leftClick()":t.jump("/html5/",!0)}},monthsNum:12,voidInvalid:!1,format:"Y-m-d",priceDate:i,onShow:function(){this.findMinPrice(),$(".cui_cldweek").css("top","43px"),t.isShowData=!1,setTimeout(function(){t.__hide()},500),this.$el.find(".cui_cld_daycrt").removeClass("cui_cld_daycrt");try{var e=t.flightSearchStore.getAttr("_items")[0].date,n=d.Date.format(e,"Y-m-d"),r=this.$el.find('[data-date="'+n+'"]');r.addClass("cui_cld_daycrt");try{var i,s;"BackCompat"==document.compatMode?(i=document.body.clientHeight,s=document.body.scrollHeight):(i=document.documentElement.clientHeight,s=document.documentElement.scrollHeight),window.scrollTo(0,parseInt(r.offset().top-i/2))}catch(o){}flagHightLight=0}catch(u){}this.$el[0].offsetHeight},onHide:function(){t.__show(),$("body").data("cui-date",""),this.remove(),t.isShowData=!0},callback:function(e,r,i){this.hide();var s=n.utility.Date.format(e,"Y/m/d");this.$el.find(".cui_cld_daycrt").removeClass("cui_cld_daycrt"),i.addClass("cui_cld_daycrt"),t.lowestPriceClick(s)}});h.setAttr("DateQuery","PriceCalendar"),f.show(),t.GoToView="calendar"})}var r=$(e.currentTarget),i=r.attr("data-date"),s=this.flightSearchStore.getAttr("calendarendtime");s=d.Date.parse(s,!0);try{var o=r.hasClass("yesterday")?"BeforeDay":r.hasClass("tomorrow")?"AfterDay":"";h.setAttr("DateQuery",o)}catch(e){0}if(i&&(i=d.Date.parse(i,!0))<=s){this.flightSearchStore.setSearchDetails(0,"date",d.Date.format(i,"Y/m/d"));try{h.setAttr("DTime",d.Date.format(i,"Y/m/d")),this.mdSubmit()}catch(e){0}this.flightSearchStore.setCurSearchDetails([0]),this.updateTopDatePanel(i),b.show(),this.reloadData(function(){b.hide()})}},lowestPriceClick:function(e){var t=e,n=this.flightSearchStore.getAttr("calendarendtime");if(n=d.Date.parse(n,!0),t&&(t=d.Date.parse(t,!0))<=n){this.flightSearchStore.setSearchDetails(0,"date",d.Date.format(t,"Y/m/d"));try{h.setAttr("DTime",d.Date.format(t,"Y/m/d")),this.mdSubmit()}catch(r){0}this.flightSearchStore.setCurSearchDetails([0]),this.updateTopDatePanel(t),b.show(),this.reloadData(function(){b.hide()})}},buildEvent:function(){},disposeData:function(e){var t=e,n=this.flightSearchSubjoin.getAttr("departfilter-type"),r=this.flightSearchSubjoin.getAttr("departfilter-value"),i=/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}\s+(\d{1,2}:\d{1,2}):\d{1,2}$/i;switch(!0){case"0"===n&&!!r:t=_.filter(t,function(e){var t=i.exec(e.dTime);t=t&&t[1];var n=parseInt(t.replace(":","")),s=r.split("-"),o=parseInt(s[0].replace(":","")),u=parseInt(s[1].replace(":",""));return n>=o&&u>=n});break;case"1"===n&&!!r:t||(t=[]),t=_.filter(t,function(e){return e.cabins=_.filter(e.cabins,function(e){return 3==r?5===e.classForDisp||3==e["class"]||4===e.classForDisp||2==e["class"]:0==r?6===e.classForDisp||2!=e["class"]&&3!=e["class"]:!1}),e.cabins&&e.cabins.length>0});break;case"2"===n&&!!r:t=_.filter(t,function(e){return r===e.airlineCode})}var s=this.flightSearchSubjoin.getAttr("depart-sorttype"),o=this.flightSearchSubjoin.getAttr("depart-orderby");switch(0,this.els.eltabby.removeClass("hover"),!0){case"time"===s&&"asc"===o:t.sort(this.sortHandler.time_Asc),this.els.eltabtime.addClass("hover"),this.els.eltabtime.find("em").removeClass("flight-icon-pxd"),this.els.eltabtime.find("em").addClass("flight-icon-pxu");break;case"time"===s&&"desc"===o:t.sort(this.sortHandler.time_Desc),this.els.eltabtime.addClass("hover"),this.els.eltabtime.find("em").removeClass("flight-icon-pxu"),this.els.eltabtime.find("em").addClass("flight-icon-pxd");break;case"price"===s&&"asc"===o:t.sort(this.sortHandler.price_Asc),this.els.eltabprice.addClass("hover"),this.els.eltabprice.find("em").removeClass("flight-icon-pxd"),this.els.eltabprice.find("em").addClass("flight-icon-pxu");break;case"price"===s&&"desc"===o:t.sort(this.sortHandler.price_Desc),this.els.eltabprice.addClass("hover"),this.els.eltabprice.find("em").removeClass("flight-icon-pxu"),this.els.eltabprice.find("em").addClass("flight-icon-pxd")}return t},renderList:function(){function e(e,t,n,r,i){if("nds"==t){var s=$.grep(e,function(e){return 10==e.discount?null==r?5==n?5===e.classForDisp||3==e["class"]:6==n?6===e.classForDisp||2!=e["class"]&&3!=e["class"]:4==n?4===e.classForDisp||2==e["class"]:e.classForDisp===n:e.classForDisp+""+e["class"]==n+""+r:!1});if(s&&s.length>0)return s[0]}if("min"==t){for(var o=0;o<e.length;o++)for(var u=o;u<e.length;u++)if(e[o].price-e[u].price>0){var a=e[o];e[o]=e[u],e[u]=a}var s=$.grep(e,function(e){return null==r?6==n?6===e.classForDisp||2!=e["class"]&&3!=e["class"]:5==n?5===e.classForDisp||3==e["class"]:4==n?4===e.classForDisp||2==e["class"]:e.classForDisp===n:e.classForDisp+""+e["class"]==n+""+r});if(s&&s.length>0)return i?s.length-i>0?s[i]:null:s[0]}return null}function t(e,t){for(var n=0;n<e.length;n++)if(e[n]["class"]==t["class"]&&e[n].classForDisp==t.classForDisp&&e[n].price==t.price)return!0;return!1}var r=this.flightSearchStore.getSearchDetails(0,"date"),i=this.flightSearchStore.getSearchDetails(1,"date"),s=this.flightSearchStore.getSearchDetails(0,"dcityName"),o=this.flightSearchStore.getSearchDetails(0,"acityName"),u=this.flightSearchStore.getAttr("tabtype")||1;try{h.setAttr("DCity",s),h.setAttr("ACity",o),h.setAttr("FlightType",1===u?"OW":"RT"),h.setAttr("DTime",r),h.setAttr("ATime",i?i:"")}catch(a){0}this.datalist=this.disposeData(this.getSdateList());for(var f=this.flightSearchSubjoin.getAttr("departfilter-type-cabin"),l=v.get(),c=0;c<this.datalist.length;c++){var p=new Array,d=this.datalist[c].cabins,m=e(d,"min",6),g=e(d,"min",6,null,1),y=e(d,"nds",6),b=e(d,"min",4),w=e(d,"nds",4),E=e(d,"min",2,3),S=e(d,"min",5),x=e(d,"nds",5),T=e(d,"min",3,3);null==m||t(p,m)||p.push(m),null==g||t(p,g)||p.push(g),null==y||t(p,y)||p.push(y),null==b||t(p,b)||p.push(b),null==w||t(p,w)||p.push(w),null==E||t(p,E)||p.push(E),null==S||t(p,S)||p.push(S),null==x||t(p,x)||p.push(x),null==T||t(p,T)||p.push(T),this.datalist[c].cabins=p.length>0?p:d}var N={list:this.datalist,cDate:n.base.Date,bd:this.basedata,filterClass:f,_sales:l,_viewBuildSeatTitlt:this._viewBuildSeatTitlt,_viewfilterfirst:this._viewfilterfirst},C=this.flightListTplFun(N);try{window["h5.flt.searchresult.speed"].renderListBegin=Date.now()}catch(a){}this.els.elf_list.html(C);try{window["h5.flt.searchresult.speed"].renderListEnd=Date.now()}catch(a){}for(var k=0,c=0;c<this.datalist.length;c++)null!=this.datalist[c].flightNo&&k++;this.els.elflightTotal.html(k)},afterReFilter:function(){},updatePageDate:function(){var e=this.flightSearchStore.getSearchDetails(0,"date"),t=this.flightSearchStore.getSearchDetails(1,"date"),n=this.flightSearchStore.getSearchDetails(0,"dcityName"),r=this.flightSearchStore.getSearchDetails(0,"acityName"),i=this.flightSearchStore.getAttr("tabtype")||1,s=this.flightSearchSubjoin.getAttr("depart-sorttype"),o=this.flightSearchSubjoin.getAttr("depart-orderby"),u=d.Date.parse(e,!0),a=d.Date.parse(t,!0);switch(i&&(i=+i),i){case 1:this.els.eltitle.html(n+"-"+r);break;case 2:u>a&&(u=new Date(a.valueOf()),this.flightSearchStore.setSearchDetails(0,"date",d.Date.format(u,"Y/m/d H:i:s"))),this.els.eltitle.html("去程: "+n+"-"+r)}switch(!0){case"time"===s&&"asc"===o:this.els.eltabtime.addClass("hover"),this.els.eltabtime.find("em").html("↑");break;case"time"===s&&"desc"===o:this.els.eltabtime.addClass("hover"),this.els.eltabtime.find("em").html("↓");break;case"price"===s&&"asc"===o:this.els.eltabprice.addClass("hover"),this.els.eltabprice.find("em").html("↑");break;case"price"===s&&"desc"===o:this.els.eltabprice.addClass("hover"),this.els.eltabprice.find("em").html("↓")}},updateTopDatePanel:function(e){e.setHours(0,0,0,0);var t=(new d.Date(e)).addDay(-1),n=new d.Date(e),r=(new d.Date(e)).addDay(1),i=(new d.Date(this.getServerDate())).setHours(0,0,0,0).valueOf(),s=this.flightSearchStore.getAttr("calendarendtime");s=d.Date.parse(s,!0),t.valueOf()>=i?(this.$el.find(".yesterday").removeClass("flight-listdate-disable"),this.els.elt1.attr("data-date",t.format("Y/m/d")),this.$el.find(".t1 .price").html(g[t.format("Y/m/d")]?"<dfn>&yen;</dfn>"+g[t.format("Y/m/d")]:" ")):(this.$el.find(".yesterday").addClass("flight-listdate-disable"),this.$el.find(".t1 .price").html(""),this.els.elt1.attr("data-date","")),n.valueOf()>=i?(this.$el.find("#js_CurDate").text(n.format("Y-m-d w")),this.els.elt2.attr("data-date",n.format("Y/m/d")),this.$el.find(".t2 .price").html(g[n.format("Y/m/d")]?"<dfn>&yen;</dfn>"+g[n.format("Y/m/d")]:"")):(this.els.elt2.html("--"),this.els.elt2.attr("data-date","")),r.valueOf()<=s?(this.$el.find(".tomorrow").removeClass("flight-listdate-disable"),this.els.elt3.attr("data-date",r.format("Y/m/d")),this.$el.find(".t3 .price").html(g[r.format("Y/m/d")]?"<dfn>&yen;</dfn>"+g[r.format("Y/m/d")]:"")):(this.$el.find(".tomorrow").addClass("flight-listdate-disable"),this.els.elt3.attr("data-date",""),this.$el.find(".t3 .price").html(""))},reloadData:function(e){var t=this;this.els.elf_list.empty(),this.flightSearchStore.setCurSearchDetails([0]);try{window["h5.flt.searchresult.speed"].loadFlightListBegin=Date.now()}catch(n){}this.els.elflightTotal.html(0),this.flightList.excute(function(t,n,r){try{r&&(window["h5.flt.searchresult.speed"].loadFlightListEnd=Date.now())}catch(i){}if(t.count||t.items&&t.items.length){this.sdatalist=JSON.stringify(t.items||[]),this.datalist=(t.items||[]).sort(this.sortHandler.price_Asc);for(var s=1/0,o=0,u=t.items.length;u>o;o++)t.items[o].cabins.length>0&&(s=+t.items[o].cabins[0].price<s?t.items[o].cabins[0].price:s);this.$el.find(".t2 .price").html("<dfn>&yen;</dfn>"+s),this.isEmpty=this.datalist.length?!1:!0,this.renderList(this.datalist||[])}else this.els.elf_list.html(this.els.elemptylisttpl.html()),this.isEmpty=!0;e.call(this,t)},function(n){b.hide(),n&&n.msg?setTimeout(function(){t.showToast(n.msg,0,function(){t.back("index")})},1e3):setTimeout(function(){t.showToast("数据加载失败",0,function(){t.back("index")})},1e3),e.call(this)},this.flightSearchStore.getAttr("fullCabin"),this)},updatePage:function(e){var t=this.getQuery("sourceid");if(t&&+t>0){for(var n=0,r=["497","1107","1108","3516","3512","3511","3503","3513","1595","1596","3524","3517","3518","1591","1825","1826","1827","1828","1829","1830","1831"],i=0,s=r.length;s>i;i++){var o=r[i];if(o==t){n=1;break}}n&&this.footer.checkForceDownload(t)}b.show(),this.getSemParam(e)},lowestPriceList:function(){var e=this;m.head={auth:null,errcode:0};var t=new Array,n={};try{window["h5.flt.searchresult.speed"].loadLowestPriceBegin=Date.now()}catch(r){}if(this.$el.find(".t2 .price").html(""),this.lowestPrice.excute(function(e,t,r){n=e;try{r&&(window["h5.flt.searchresult.speed"].loadLowestPriceEnd=Date.now())}catch(i){}},function(){},!1,this),n&&n.prices&&n.prices.length>0){for(var i=0,s=n.prices.length;s>i;i++)n.prices[i].dDate=new Date(n.prices[i].dDate.replace(/-/g,"/")),lowestDayKey=d.Date.format(n.prices[i].dDate,"Y/m/d"),g[lowestDayKey]=n.prices[i].price;t=n.prices,m.prices=t}else{n.prices=[];for(var o=this.getServerDate(),i=0,s=90;s>i;i++)n.prices.push({dDate:d.Date.parse(d.Date.format(o,"Ymd")).addDay(i).date,price:""}),lowestDayKey=d.Date.format(n.prices[i].dDate,"Y/m/d"),g[lowestDayKey]=n.prices[i].price;t=n.prices,m.prices=t}var u=e.flightSearchStore.getSearchDetails(0,"date"),a=d.Date.parse(u,!0);a=d.Date.format(a,"Y/m/d H:i:s"),a=new Date(a),e.updateTopDatePanel(a)},onCreate:function(){0,this.render(),this.buildEvent(),this.baseDataModel=new u({models:{flightCityList:i.FlightCityListModel.getInstance(),flightInterCityList:i.FlightInterCityListModel.getInstance()}}),this.$el.css({background:"#fff"})},getSalesObj:function(){var t=this,n=t.getQuery("sales"),i=t.getQuery("sourceid"),s=r.SalesStore.getInstance().get();null!=s&&null==i&&null==n&&(i=s.sourceid),(n||i)&&e.getSalesObject(n||i,$.proxy(function(){e.replaceContent(t.$el)},this))},onLoad:function(e){var t=this;t.turning();try{window["h5.flt.searchresult.speed"].viewOnloadBegin=Date.now()}catch(n){}var r=this.flightSearchStore.getAttr("items")[0];if(this.lowestPriceStore.setAttr("aCty",r.aCtyCode),this.lowestPriceStore.setAttr("dCty",r.dCtyCode),this.lowestPriceList(),this.__assert()){this.refer=e||"","bookinginfo"===this.refer&&this.isRedirect&&this.flightListStore.get()&&!this.flightSearchStore.getAttr("fullCabin")?this.turning():(this.isRedirect=!1,this.flightSearchStore.setAttr("__tripType",1),this.updatePage(function(){b.hide();try{window["h5.flt.searchresult.speed"].end=Date.now(),"undefined"==typeof window.__bfi&&(window.__bfi=[]);var e={renderListTime:window["h5.flt.searchresult.speed"].renderListEnd-window["h5.flt.searchresult.speed"].renderListBegin,renderTplTime:window["h5.flt.searchresult.speed"].renderTplEnd-window["h5.flt.searchresult.speed"].renderTplBegin,onloadTime:window["h5.flt.searchresult.speed"].end-window["h5.flt.searchresult.speed"].viewOnloadBegin};window["h5.flt.searchresult.speed"].loadCalendarTime&&(e.loadCalendarTime=window["h5.flt.searchresult.speed"].loadCalendarEnd-window["h5.flt.searchresult.speed"].begin),window["h5.flt.searchresult.speed"].loadFlightListEnd&&(e.listAPI=window["h5.flt.searchresult.speed"].loadFlightListEnd-window["h5.flt.searchresult.speed"].loadFlightListBegin),window["h5.flt.searchresult.speed"].loadLowestPriceEnd&&(e.priceAPI=window["h5.flt.searchresult.speed"].loadLowestPriceEnd-window["h5.flt.searchresult.speed"].loadLowestPriceBegin),window.__bfi.push(["_tracklog","h5.flt.searchresult.speed",JSON.stringify(e)])}catch(t){}}));var i=v.get(),s=this.getQuery("sourceid");(s&&(1575==+s||1867==+s)||i&&i.sid&&(1575==+i.sid||1867==+i.sid))&&(this.$el.find("#js_home").hide(),this.$el.find("#footer").hide(),this.footer&&this.footer.hide(),this.hasAd=!1),this.getSalesObj()}},onShow:function(){0,this.setTitle("机票列表页");var e=this.flightSearchStore.getSearchDetails(0,"date"),t=this.flightSearchStore.getSearchDetails(1,"date"),n=this.flightSearchStore.getSearchDetails(0,"dcityName"),r=this.flightSearchStore.getSearchDetails(0,"acityName"),i=this.flightSearchStore.getAttr("tabtype")||1;try{h.setAttr("DCity",n),h.setAttr("ACity",r),h.setAttr("FlightType",1===i?"OW":"RT"),h.setAttr("DTime",e),h.setAttr("ATime",t?t:"")}catch(s){0}"bookinginfo"===this.refer&&this.isRedirect&&this.restoreScrollPos()},onHide:function(e){0,("index"===e||""===e)&&(this.clearCurFilter(),this.resetSort()),"bookinginfo"!=e&&"calendar"!=this.GoToView&&this.els.elf_list.empty(),b.hide()},_viewBuildSeatTitlt:function(e,t){var n,r=3==+t?"头等舱":2==+t?"公务舱":"经济舱";return n=1===e?'<i class="clr-ff9a14">高端'+r+"</i>":2===e?'<i class="clr-ff9a14">超值'+r+"</i>":3===e?'<i class="clr-ff9a14">豪华'+r+"</i>":4===e?"商务舱":5===e?"头等舱":6===e?"经济舱":7===e?'<i class="clr-ff9a14">空中'+r+"</i>":r},_viewfilterfirst:function(e){if(e&&e.length>0){for(var t=0,n=null,r=0;r<e.length;r++)0==r?(t=e[0].price,n=e[0],n.ckey=0):t-e[r].price>0&&(t=e[r].price,n=e[r],n.ckey=r);return n}},__assert:function(){return!0},mdSubmit:function(){var e=h.getAttr("FlightNoSequence"),t=h.getAttr("SubClassSequence"),n=h.getAttr("ActiveType");p.setAttr("dObj",{fns:e,scs:t,at:n}),o.sendUbt(c,h.get()),h.remove()}});return w}),define("text",["module"],function(e){var t,n,r,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a=typeof location!="undefined"&&location.href,f=a&&location.protocol&&location.protocol.replace(/\:/,""),l=a&&location.hostname,c=a&&(location.port||undefined),h=[],p=e.config&&e.config()||{};t={version:"2.0.5+",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,p.isBuild&&(h[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}p.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),h=p.useXhr||t.useXhr;!a||h(u,f,l,c)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(h.hasOwnProperty(n)){var s=t.jsEscape(h[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(p.env==="node"||!p.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(p.env==="xhr"||!p.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);p.onXhr&&p.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText))},s.send(null)};else if(p.env==="rhino"||!p.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(p.env==="xpconnect"||!p.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var n,s,o={},u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),s.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),o),s.close(),n.close(),t(o.value)}catch(a){throw new Error((u&&u.path||"")+": "+a)}};return t}),define("text!flight/dest/views/list.html",[],function(){return'<style type="text/css">\r\n    /*********************黄金分割线***************/\r\n\r\n\r\n    .jsFlightCanvas div:nth-of-type(1) {\r\n        -webkit-backface-visibility: visible;\r\n        -webkit-transform-origin: center center;\r\n        -webkit-animation: demo 4s 0s 1 ease normal none;\r\n    }\r\n\r\n    @-webkit-keyframes demo {\r\n        0% {\r\n            opacity: 0;\r\n        }\r\n\r\n        54% {\r\n            opacity: 1;\r\n        }\r\n\r\n        100% {\r\n            opacity: 0;\r\n        }\r\n    }\r\n\r\n    .jsFlightCanvas div:nth-of-type(1) {\r\n        -moz-backface-visibility: visible;\r\n        -moz-transform-origin: center center;\r\n        -moz-animation: demo 4s 0s 1 ease normal none;\r\n    }\r\n\r\n    @-moz-keyframes demo {\r\n        0% {\r\n            opacity: 0;\r\n        }\r\n\r\n        54% {\r\n            opacity: 1;\r\n        }\r\n\r\n        100% {\r\n            opacity: 0;\r\n        }\r\n    }\r\n\r\n    .type_date {\r\n        background-color: #f5f5f5;\r\n        position: fixed;\r\n        top: 44px;\r\n        width: 100%;\r\n        z-index: 299;\r\n        /*border: solid 1px #ccc;*/\r\n    }\r\n\r\n\r\n    .tpye_bar {\r\n        /*  border-bottom: 1px solid #cfcfcf;*/\r\n        background-color: #f5f5f5;\r\n        position: fixed;\r\n        bottom: 0px;\r\n        width: 100%;\r\n        z-index: 299;\r\n        height: 43px;\r\n        -webkit-transform: translateY(0);\r\n        -ms-transform: translateY(0);\r\n        -o-transform: translateY(0);\r\n        /*\r\n        -webkit-transition: all .5s ease 0;\r\n        -ms-transition: all .5s ease 0;\r\n        -o-transition: all .5s ease 0;\r\n        transition: all .5s ease 0;\r\n            */\r\n    }\r\n\r\n        .tpye_bar.hide {\r\n            -webkit-transform: translateY(100px);\r\n            -ms-transform: translateY(100px);\r\n            -o-transform: translateY(100px);\r\n            transform: translateY(100px);\r\n            /*\r\n            -webkit-transition: all .5s ease 0;\r\n            -ms-transition: all .5s ease 0;\r\n            -o-transition: all .5s ease 0;\r\n            transition: all .5s ease 0;\r\n                 */\r\n        }\r\n</style>\r\n\r\n<header style="position: fixed; top: 0px; z-index: 2000">\r\n    <a class="js_home"><b class="icon_home i_bef" id="js_home"></b></a>\r\n    <a href="tel:4000086666" class="icon_phone i_bef __hreftel__" id="js_phone"></a>\r\n    <h1 class="twotitle"><span id="title">机票预订</span><p class="result">共<span id="flightTotal">0</span>个结果</p></h1>\r\n    <i class="returnico" id="js_return"></i>\r\n</header>\r\n\r\n\r\n<div id="js_FlightMenuFrame2" class="type_date">\r\n    <ul class="tab_time flight-listdate">\r\n        <li class="yesterday t1">\r\n            <div>前一天</div>\r\n            <div class="price"></div>\r\n        </li>\r\n        <li class="today t2">\r\n            <div class="date">\r\n                <i class="flight-cheap-calendar">低</i>\r\n                <label id="js_CurDate">2014-05-30 周三</label>\r\n            </div>\r\n            <div class="price"></div>\r\n        </li>\r\n        <li class="tomorrow t3">\r\n            <div>后一天</div>\r\n            <div class="price"></div>\r\n        </li>\r\n    </ul>\r\n</div>\r\n\r\n\r\n\r\n<menu style="margin-top: 88px" id="js_FlightListFrame">\r\n\r\n    <!--机票查询列表-->\r\n    <section class="f_list" style="padding-bottom:45px"></section>\r\n\r\n</menu>\r\n\r\n<div id="js_FlightMenuFrame" class="tpye_bar">\r\n    <ul class="tab_by" style="background-color: #f5f5f5">\r\n        <li data-type="time" class="bytime" style="width:33%">\r\n            时间\r\n            <em class="flight-icon-pxu">↑</em>\r\n        </li>\r\n        <li data-type="filter" class="byfilter" style="width: 34%">\r\n            筛选\r\n            <em class="flight-icon-sx"></em>\r\n        </li>\r\n        <li data-type="price" class="byprice hover" style="width: 33%">\r\n            价格\r\n            <em class="flight-icon-pxu">↑</em>\r\n        </li>\r\n       \r\n    </ul>\r\n</div>\r\n\r\n\r\n<script type="text/template" id="flightlisttpl">\r\n    <div>\r\n        <%_.each(list,function(v,k){%>\r\n        <%\r\n        if(v.flightNo){\r\n        var cabin =  _viewfilterfirst(v.cabins,filterClass)|| {} ;\r\n        var ckind = v.ctinfo?v.ctinfo.ckind:\'N\';\r\n\r\n        %>\r\n        <ul class="f_list_tab js_flight_item" data-key="<%=k%>" style="z-index:100;"  data-ckey="<%=cabin.ckey%>" >\r\n\r\n            <li class="f_info" style="box-sizing: border-box;width:100%;">\r\n                <div class="flight-list-start">\r\n                    <p>\r\n                        <span class="fnt-18"><%=(cDate.parse(v.dTime).format(\'H:i\'))%></span>\r\n                    </p>\r\n                    <p><%=v.daname %><%=(v.dTerminal!=null)?v.dTerminal:"" %></p>\r\n                </div>\r\n                <div class="flight-list-middle">\r\n                    <i class="flight-icon-fx"></i>\r\n                    <%if((v.flag & 2) === 2 && v.stopCities && v.stopCities.length>0){ %>\r\n                    <% for( var c=0;c< v.stopcities.length;c++){%>\r\n                    <span class="flight-list-jt">\r\n                        <%=v.stopCities[0]["name"] %>\r\n                    </span>\r\n                    <%  }%>\r\n                    <%  }%>\r\n                </div>\r\n                <div class="flight-list-end">\r\n                    <p>\r\n                        <span class="fnt-18"><%=(cDate.parse(v.aTime).format(\'H:i\'))%></span>\r\n                    </p>\r\n                    <p><%=v.aaname %><%=(v.aTerminal!=null)?v.aTerminal:"" %></p>\r\n                </div>\r\n                <div class="flight-list-hs" style="width:95%;white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">\r\n\r\n                    <!-- <span class="pubFlights_<%=v.airlineCode%>"></span> -->\r\n\r\n                    <img src=\'<%="http://pic.c-ctrip.com/flight_intl/airline_logo/40x35/"+v.airlineCode+".png" %>\' />\r\n\r\n                    <span><%=v.aname %><%=v.flightNo %></span>\r\n                    <span class="clr-eee">|</span>\r\n                    <span><%=(v.ctinfo)?v.ctinfo.ctname:v.planeType %><%=(ckind === \'M\' ? \'(中)\' : (ckind === \'L\' ? \'(大)\' : \'\' ))%></span>\r\n                </div>\r\n            </li>\r\n\r\n\r\n            <li class="f_price">\r\n\r\n\r\n                <%if(cabin["rebateAmt"]){\r\n                if(!_sales || !_sales.sid || (+_sales.sid != 1575 && +_sales.sid != 1867)){\r\n                %>\r\n                <span class="fantxt2">返&yen;<%=cabin.rebateAmt %></span>\r\n                <%} }%>\r\n\r\n                <dfn>&yen;</dfn>\r\n                <strong>\r\n                    <%=cabin.price %>\r\n                </strong>\r\n\r\n\r\n\r\n                <p>\r\n                    <%if(cabin.discount &&  cabin.discount < 0){ %>\r\n                       旅行套餐\r\n                    <%}else{%>\r\n\r\n                     <%=_viewBuildSeatTitlt(cabin.classForDisp,cabin.class)%>\r\n                    <%}%>\r\n\r\n                    <% var strDis = "" %>\r\n                    <% if(cabin.discount >= 10) {%>\r\n                    <% strDis = "全价"; %>\r\n                    <%}else if(cabin.discount >0 && cabin.discount < 10){%>\r\n                    <% strDis = cabin.discount+"折"; %>\r\n                    <%}else{ %>\r\n                    <% strDis =  ""; %>\r\n                    <%}%>\r\n                    <%=strDis %>\r\n                </p>\r\n\r\n\r\n\r\n                <p>\r\n                    <em class="f_num">\r\n                        <%if(cabin.qty<=3){%>\r\n                        <span class="clr-red"><%=cabin.qty %>张</span>\r\n                        <%}else if(cabin.qty<=9){%>\r\n\r\n                        <%}else if(cabin.qty>9){%>\r\n\r\n                        <%} %>\r\n                    </em>\r\n                </p>\r\n            </li>\r\n\r\n\r\n\r\n            <%if(v.cabins && v.cabins.length){ %>\r\n            <li class="flight-listfold flight-packdown js_subswitch"></li>\r\n            <%} %>\r\n\r\n        </ul>\r\n        <!--展开详情-->\r\n\r\n        <ul class="js_sublist f_detail" style="display:none;background:#f5f5f5;">\r\n            <% for(var i=0 ;i\r\n            <v.cabins.length; i++ ){ %>\r\n                <% var cabin = v.cabins[i]; %>\r\n                <li class="js_flight_seat" data-flightno="<%=v.flightNo %>" data-classfordisp="<%=cabin.classForDisp %>" data-parent-key="<%=k %>" data-key="<%=i %>" data-class="c<%=cabin.class %>">\r\n                    <span class="xq_info">\r\n                        <%if(cabin.discount &&  cabin.discount < 0){ %>\r\n                        旅行套餐\r\n                        <%}else{%>\r\n                        <%=_viewBuildSeatTitlt(cabin.classForDisp,cabin.class)%>\r\n                        <%}%>\r\n                        <% if(cabin.discount && cabin.discount < 10 && cabin.discount >0){%><%=cabin.discount %>折<%}else if(cabin.discount == 10){%>全价<%} %>\r\n                    </span>\r\n\r\n\r\n\r\n                    <span class="xq_price">\r\n\r\n\r\n\r\n                        <%if(cabin.rebateAmt){%>\r\n                        <% if(!_sales || !_sales.sid || (+_sales.sid != 1575 && +_sales.sid != 1867)){ %>\r\n                        <span class="fantxt2">返&yen;<%=cabin.rebateAmt %></span>\r\n                        <%} %>\r\n                        <%}%>\r\n\r\n                        <em class="xq-yp">\r\n                            <%if(cabin.qty<=3){%>\r\n                            <span style="color:#f00">\r\n                                <%=cabin.qty %>张\r\n                            </span>\r\n                            <%}else if(cabin.qty<=9){%>\r\n\r\n                            <%}else if(cabin.qty>9){%>\r\n\r\n                            <%} %>\r\n                        </em>\r\n                        <button class="flight-btn-price">\r\n                            <dfn>&yen;</dfn>\r\n                            <strong><%=cabin.price %></strong>\r\n                        </button>\r\n                    </span>\r\n                </li>\r\n                <%} %>\r\n        </ul>\r\n\r\n\r\n        <%}}) %>\r\n    </div>\r\n</script>\r\n<script type="text/template" id="emptylisttpl">\r\n    <div class="cui-load-error">\r\n        <div class="cui-i cui-wifi cui-exclam">\r\n        </div>\r\n        请修改条件重新查询\r\n    </div>\r\n</script>'}),define("text!flight/dest/views/index.html",[],function(){return'<header>\r\n    <h1>机票查询</h1><i id="js_return" class="returnico"></i>\r\n</header>\r\n\r\n<aside class="cont_wrap">\r\n    <ul class="city_tab">\r\n        <li data-type="1" class="cityTabCrt">单程</li>\r\n        <li data-type="2">往返</li>\r\n    </ul>\r\n</aside>\r\n<section id="panel-box" class="pb85">\r\n    <ul class="flight-srhform">\r\n        <li class="flight-switch">\r\n            <dl>\r\n                <dd class="flight-departcity" id="js_departcity_w"><span id="js_departcity"><em>上海</em></span></dd>\r\n                <dt class="flight-cityswitch" id="js_exchange_btn">\r\n                    切换<i class="icon-switch"><i class="s1"></i><i class="s2"></i><i class="s3"></i></i>\r\n                </dt>\r\n                <dd class="flight-backcity" id="js_backcity_w"><span id="js_backcity"><em>北京</em></span></dd>\r\n            </dl>\r\n        </li>\r\n\r\n        <li class="city_tit_box">\r\n            <dl class="startdate city_tit city_padding_left">\r\n                <dd id="js_departDate" class="flight-date">\r\n                    <em>7月13日</em>\r\n                    <b>明天 周六</b>\r\n                </dd>\r\n            </dl>\r\n            <dl class="backdate city_tit city_padding_right">\r\n                <dd id="js_backDate" class="flight-date">\r\n                    <em>7月13日</em>\r\n                    <b>明天 周六</b>\r\n                </dd>\r\n            </dl>\r\n        </li>\r\n\r\n        <li class="passenger">\r\n            <dl>\r\n                <dd class="flight-pstype">\r\n                    <b class="passengerType">成人</b>\r\n                    <div class="tips">无成人陪伴的儿童<br>请直接向航空公司预订</div>\r\n                </dd>\r\n            </dl>\r\n        </li>\r\n        <li>\r\n            <button id="searchlistsubmit" class="flight-btnsrh" value="">查&nbsp;询</button>\r\n        </li>\r\n    </ul>\r\n\r\n    <div class="blk30"></div>\r\n\r\n\r\n    <div class="flight-img-svc">\r\n        <img src="http://pic.c-ctrip.com/h5/flight/fwcn.png" width="100%">\r\n    </div>\r\n\r\n</section>\r\n\r\n<!-- S 底部固定菜单 -->\r\n    <div>\r\n        <div class="flight-zjfooter-blank"></div>\r\n        <div class="flight-footer">\r\n            <ul>\r\n                <li class="ft1 current" id="flightSearch">机票查询</li>\r\n                <li class="ft2" id="flightSchedule">航班动态</li>\r\n                <li class="ft3" id="checkin">值机</li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n    <!-- E 底部固定菜单 -->'});