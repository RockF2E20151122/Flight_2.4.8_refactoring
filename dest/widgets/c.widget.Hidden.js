define(function(a){var b=(a("c"),a("flight/utility/utility")),c="h5.flt.booking",d=function(a){this.opts=$.extend(!0,{},a),this.parentView=this.opts.parentView,this.stores=this.parentView.stores};return d.prototype={onLoad:function(){var a=this.stores,b=a.mdTransStore,c=a.userStore,d=a.mdStore,e=a.flightOrderStore,f=a.flightDeliveryStore;try{var g=b.get();if(g&&g.dObj){var h=g.dObj.fns,i=g.dObj.scs,j=g.dObj.at;g.aObj&&(h+=","+g.aObj.fns,i+=","+g.aObj.scs,j+=","+g.aObj.at),d.setAttr("FlightNoSequence",h),d.setAttr("SubClassSequence",i),d.setAttr("ActiveType",j)}d.setAttr("IsLoginNow",!!c.isLogin()),d.setAttr("IsCancelInsurance",!e.getAttr("selInsure"));var k=e.get();k&&k.contact&&k.contact.mphone&&d.setAttr("IsContactPhone",!0),1!==f.getAttr("type")&&(d.setAttr("IsNeedSegment",!0),d.setAttr("IsDeliveryType",!0))}catch(l){0}},mdSubmit:function(){var a=this.stores.mdStore,d=this.stores.mdTransStore,e=a.getAttr("passengers"),f=1;for(var g in e)a.setAttr("IsPassengerName"+f,e[g].IsPassengerName),a.setAttr("PassengerNamePass"+f,e[g].PassengerNamePass),a.setAttr("CredentialsType"+f,e[g].CredentialsType),a.setAttr("IsCredentialsNO"+f,e[g].IsCredentialsNO),a.setAttr("CredentialsNOPass"+f,e[g].CredentialsNOPass),f++;a.setAttr("passengers",f-1),b.sendUbt(c,a.get()),a.remove(),d.remove()}},d});