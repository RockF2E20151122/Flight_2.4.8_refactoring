define(function(){function a(){var a=this,b=document.createElement("div");document.body.appendChild(b);var c={background:"#000",position:"fixed",top:0,left:0,color:"#fff",width:"90%",height:"90%","z-index":9999999,"font-size":"12px","line-height":"18px","text-align":"left"};for(var d in c)b.style[d]=c[d];var e=document.createElement("div");document.body.appendChild(e);var f={background:"#000",position:"fixed",top:0,left:0,color:"#fff",width:"50%","min-height":"36px","max-height":"30%",overflow:"hidden","z-index":9999999,"font-size":"12px","line-height":"18px","word-wrap":"break-word"};for(var d in f)e.style[d]=f[d];b.style.display="none",e.innerHTML='<div style="line-height: 36px;text-align: center">DEBUG</div>',a.fullView=!1,e.addEventListener("click",function(){0==a.fullView&&(e.style.display="none",a.fullView=!0,b.style.display="block",g.childNodes[g.childNodes.length-1].scrollIntoView())},!1),a.barCanMove=!1,e.addEventListener("touchstart",function(b){b.preventDefault(),a.timeoutBarCanMove=setTimeout(function(){a.timeoutBarCanMove=null,a.bar.style.opacity=.5,a.barCanMove=!0},500),a.touchStartInitPos={x:b.touches[0].clientX,y:b.touches[0].clientY}},!1),e.addEventListener("touchmove",function(b){if(b.preventDefault(),a.touchMoveLastPos=a.touchMoveLastPos||a.touchStartInitPos,a.timeoutBarCanMove)clearTimeout(a.timeoutBarCanMove),a.timeoutBarCanMove=null;else if(a.barCanMove){var c={x:b.touches[0].clientX,y:b.touches[0].clientY},d={x:c.x-a.touchMoveLastPos.x,y:c.y-a.touchMoveLastPos.y},f={left:parseInt(e.style.left)+d.x,top:parseInt(e.style.top)+d.y};f.left>=0&&f.left+e.offsetWidth<=window.innerWidth&&(e.style.left=f.left+"px"),f.top>=0&&f.top+e.offsetHeight<=window.innerHeight&&(e.style.top=f.top+"px")}a.touchMoveLastPos={x:b.touches[0].clientX,y:b.touches[0].clientY}},!1),e.addEventListener("touchend",function(){a.timeoutBarCanMove&&(clearTimeout(a.timeoutBarCanMove),a.timeoutBarCanMove=null),a.bar.style.opacity=1,a.barCanMove=!1,a.touchMoveLastPos=a.touchStartInitPos=null});var g=document.createElement("div");g.className="J_logDom";var h={height:"100%","margin-bottom":"36px","overflow-y":"scroll","word-wrap":"break-word"};for(var d in h)g.style[d]=h[d];b.appendChild(g);var i=document.createElement("div");i.className="J_btnsDom";var j={height:"36px",position:"absolute",width:"100%","background-color":"orange","overflow-x":"auto",bottom:"-36px",clear:"both"};for(var d in j)i.style[d]=j[d];b.appendChild(i);var k=[{name:"关闭",className:"J_btn_close",fn:function(){e.style.display="block",b.style.display="none",a.fullView=!1}},{name:"LOG",className:"J_btn_log",fn:function(){a.switchLogType("log")}},{name:"DEBUG",className:"J_btn_debug",fn:function(){a.switchLogType("debug")}},{name:"WARN",className:"J_btn_warn",fn:function(){a.switchLogType("warn")}},{name:"ERROR",className:"J_btn_error",fn:function(){a.switchLogType("error")}},{name:"ALL",className:"J_btn_all",style:{"background-color":"#fff",color:"#000"},fn:function(){a.switchLogType("all")}}];k.forEach(function(a){var b=document.createElement("div"),c={display:"inline-block","line-height":"36px",padding:"0px 3px",color:"#fff"};for(var d in c)b.style[d]=c[d];if(b.addEventListener("click",a.fn,!1),a.className&&(b.className=a.className),a.style)for(var d in a.style)b.style[d]=a.style[d];b.innerHTML=a.name,i.appendChild(b)}),this.memory=[],this.memory.push=function(b){Array.prototype.push.apply(this,arguments);var c=document.createElement("div");c.innerHTML=["["+b.date.toString("yyyy-MM-dd hh:mm:ss")+"]","["+b.type+"]",b.msg].join(" ");var d="white";switch(b.type){case"debug":d="yellow";break;case"warn":d="orange";break;case"error":d="red"}c.style.color=d,g.appendChild(c),a.updateBar('<div style="text-align:left;color:'+d+'">'+b.msg+"</div>"),c.scrollIntoView()},this.dom=b,this.bar=e,this.logDom=g,this.btnsDom=i,this.GLOBAL_SCOPE=new Function("return this")(),this.sysConsole=this.GLOBAL_SCOPE.console}Date.prototype.toString=function(){var a={d:"getDate",h:"getHours",m:"getMinutes",s:"getSeconds"},b=/(yy|M|d|h|m|s)\1?/g,c=Date.prototype.toString;return function(d){var e=this;return d?d.replace(b,function(b,c){var d,f=b!=c;switch(c){case"yy":return d=e.getFullYear(),f&&d||d%100;case"M":d=e.getMonth()+1;break;default:d=e[a[c]]()}return f&&9>=d&&"0"+d||d}):c.call(e)}}(),a.prototype={_stringify:function(a){var b;if(null!=a){b="{";var c=0;for(var d in a){c>0&&(b+=","),b+='"'+d+'":';try{b+=JSON.stringify(a[d])}catch(e){try{b+='"'+a[d].toString()+'"'}catch(f){b+='"[Object]"'}}c++}b+="}"}else b="null";return b},_translateLog:function(a){var b;if("object"==typeof a)try{b=this._stringify(a)}catch(c){b=a.toString()}else{var d=0,e=arguments;b="string"==typeof a?arguments[0].replace(/(%s|%d|%i|%f|%o)/gi,function(){d++;var a=e[d];return a}):a}return b},log:function(){var a=this._translateLog.apply(this,arguments),b=this.sysConsole;b&&b.log.apply(b,arguments),this.memory.push({type:"log",msg:a,date:new Date})},warn:function(){var a=this._translateLog.apply(this,arguments),b=this.sysConsole;b&&b.warn.apply(b,arguments),this.memory.push({type:"warn",msg:a,date:new Date})},debug:function(){var a=this._translateLog.apply(this,arguments),b=this.sysConsole;b&&b.debug.apply(b,arguments),this.memory.push({type:"debug",msg:a,date:new Date})},error:function(){var a=this._translateLog.apply(this,arguments),b=this.sysConsole;b&&b.error.apply(b,arguments),this.memory.push({type:"error",msg:a,date:new Date})},updateBar:function(a){this.bar.innerHTML=a},switchLogType:function(a){var b=this;Array.prototype.forEach.call(b.logDom.childNodes,function(b){b.style.display="all"!=a?b.innerHTML.indexOf("["+a+"]")>0?"block":"none":"block"}),Array.prototype.forEach.call(b.btnsDom.childNodes,function(b){var c={"background-color":"inherit",color:"inherit"},d={"background-color":"#fff",color:"#000"};for(var e in c)b.style[e]=c[e];if(new RegExp(a,"i").test(b.innerHTML))for(var e in d)b.style[e]=d[e]})}};var b=new a;return b});