define(["cHolidayCalendar"],function(a){"use strict";var b=_.defaults({unit:"Â¥",lowestCls:"price_lowest",monthTemplate:'<section class="cui_cldunit"><h1 class="cui_cldmonth"><%= monthFormate %></h1><ul class="cui_cld_daybox"><% _.each(month, function(day) { %><li <% if (day.price) { %> data-price="<%= day.price %>" <% } %> data-date="<%= day.format %>" class="<% if (day.invalid) { print("cui_cld_invalid cui_cld_daypass"); } else { print("cui_cld_valid"); } if(day.desc) { print(" cui_cld_day_havetxt"); } if (day.cls) { print(" " + day.cls); } %>"><em><%= day.value %></em><% if (day.desc) { %><i><%= day.desc %></i><% } %><% }); %></ul></section>',priceDate:[],startPriceTime:!1,voidInvalid:!0},a.defaults),c=a.extend({initialize:function(a){this.options=$.extend(!0,{},b,a),this.setPriceDate(this.options.priceDate)},generateMonthModel:function(b,c){for(var d,e,f,g,h=a.getDaysInMonth(b,c),i=[],j=this.options,k=1;h>=k;k++)d=new Date(b,c,k),f=d.getTime(),e=this.getDateDesc(d),g=j.priceDate[f],"undefined"!=typeof g?(e.value=e.desc?e.desc:k,e.desc=0!=g?j.unit+g:"",e.price=g):(e.invalid=j.voidInvalid,e.value=k),this.isPriceValidTime(d)||(e.invalid=!0),e.format=a.dateFormat(f,"Y-m-d"),i.push(e);return i},isPriceValidTime:function(a){var b=this.options.startPriceTime;return b?a.getTime()-b.getTime()>=0:this.isValid(a)},findMinPrice:function(){var a=this.$el.find(".cui_cld_daybox"),b=this.options.lowestCls;a.each(function(){var a,c=$(this).find("[data-price]"),d=[];c.each(function(){d.push(parseInt(this.getAttribute("data-price"),10))}),a=Math.min.apply(null,d),c.each(function(){var c=$(this),d=parseInt(c.attr("data-price"),10);d===a&&c.addClass(b)})})},setPriceDate:function(a){var b={};_.each(a,function(a){b[a.date.getTime()]=a.price}),this.options.priceDate=b}});return c});