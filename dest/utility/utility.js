define(["c"],function(a){var b=/^(19[0-9]{2}|20[01]{1}\d{1})(0[1-9]{1}|1[0-2]{1})(0[1-9]{1}|[12]\d{1}|3[01]{1})$/,c={birthReg:b,ArrayIndexOf:Array.prototype.indexOf?function(a,b){return a=[].slice.call(a,0),a.indexOf(b)}:function(a,b){for(var c=a.length,d=!1;c--&&!d;)if(d=a[c]===b)return c;return c},QueryStringBuilder:function(a){function b(a){return a=a&&a.toLowerCase(),c.ArrayIndexOf(h,a)}function d(a,c){if(a&&c){var d=b(a);d>=0&&d<j.length?j[d]=c:(i.push(a),j.push(c),h.push(a.toLowerCase())),k[a]=c}return c}function e(a){var c=a?j[b(a)]:k;return c}function f(a){var c=b(a);a&&c>0?(delete k[a],i.splice(c,1),j.splice(c,1),h.splice(c,1)):(k={},i=[],j=[],h=[])}var g=arguments.callee;if(!(this instanceof g))return new g(a);var h=[],i=[],j=[],k={};if(a){var l=a.split("&");if(l)for(var m=l.length-1;m>=0;m--){var n=l[m],o=n&&n.split("="),p=o&&o[0],q=o&&o[1];p&&(k[p]=q,d(p,q))}}var r=function(a){try{a=a?decodeURIComponent(a):""}catch(b){}return encodeURIComponent(a).replace(/\*/g,"%2A").replace(/-/g,"%2D").replace(/_/g,"%5F").replace(/\./g,"%2E").replace(/!/g,"%21").replace(/~/g,"%7E").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")};this.set=d,this.get=e,this.remove=f,this.toString=function(a,b){a=a||"=",b=b||"&";for(var c=[],d=0;d<i.length;d++)j[d]&&c.push(r(i[d])+a+r(j[d]));return c.join(b)||""}},getDaysOfMonth:function(a,b){var c=30;switch(b){case 1:case 3:case 5:case 7:case 8:case 10:case 12:c=31;break;case 2:c=a%4===0&&a%100!==0?29:28;break;default:c=30}return c},sendUbt:function(a,b){var c="";for(var d in b)b.hasOwnProperty(d)&&(c+=d+"="+b[d]+"&");c=c?c.substring(0,c.length-1):c,c+="&ver=20140825",window.$_bf&&window.$_bf.loaded===!0?window.$_bf.tracklog(a,c):setTimeout(function(){window.$_bf.tracklog(a,c)},500)},validateName:function(a,b,d,e,f,g,h,i){DataControl.errorType="",DataControl.errorMessage="";var j=/^[\u4e00-\u9fa5]{2,14}$/;if(1==g){if(!d)return DataControl.errorMessage="请填写姓名",DataControl.errorType=".js_newName",DataControl.tipIconType=DataControl.TIPICONS.RED,h?b(DataControl.errorType,DataControl.errorMessage,i):"",!1;if(!j.test(d))return DataControl.errorMessage="填写正确的中文姓名",DataControl.errorType=".js_newName",DataControl.tipIconType=DataControl.TIPICONS.RED,h?b(DataControl.errorType,DataControl.errorMessage,i):"",!1}else{var k=8==g||7==g||10==g;if(!c.NoCard_C_E_Name(b.bind(a),d,e,f,k,g,h,i))return!1}return!0},validateFirstName:function(a,b,c,d){var e=/^\s*[a-z]+\s*$/i;return c="undefined"==typeof c?!0:c,""==b?(DataControl.errorMessage="请填写姓",DataControl.errorType=".js_firstName",DataControl.tipIconType=DataControl.TIPICONS.RED,c?a(DataControl.errorType,DataControl.errorMessage,d):"",!1):e.test(b)?!0:(DataControl.errorMessage="请填写正确的英文姓氏",DataControl.errorType=".js_firstName",DataControl.tipIconType=DataControl.TIPICONS.RED,c?a(DataControl.errorType,DataControl.errorMessage,d):"",!1)},validateLastName:function(a,b,c,d,e){var f=/^\s*[a-z]+\s*[a-z]*\s*$/i;return d="undefined"==typeof d?!0:d,""==c?(DataControl.errorMessage="请填写名",DataControl.errorType=".js_lastName",DataControl.tipIconType=DataControl.TIPICONS.RED,d?a(DataControl.errorType,DataControl.errorMessage,e):"",!1):f.test(c)?(b+c).length>26?(DataControl.errorMessage="英文姓名不能超过26个字符，如姓名过长请使用缩写，姓氏不能缩写，名可以缩写",DataControl.errorType=".js_enName",DataControl.tipIconType=DataControl.TIPICONS.RED,d?a(DataControl.errorType,DataControl.errorMessage,e):"",!1):!0:(DataControl.errorMessage="请填写正确的名",DataControl.errorType=".js_lastName",DataControl.tipIconType=DataControl.TIPICONS.RED,d?a(DataControl.errorType,DataControl.errorMessage,e):"",!1)},getBirth:function(a){var b=a.replace(/\s/g,"").substring(6,14);return b},formatBirth:function(a){return a=a||"",a+="",a&&8==a.length?a.slice(0,4)+"年"+a.slice(4,6)+"月"+a.slice(6,8)+"日":""},validateCard:function(b,d,e,f,g,h){if(g="undefined"==typeof g?!0:g,DataControl.errorMessage="",DataControl.errorType="",1==d)return e.no=e.no.replace(/\s/g,""),e.birth=c.getBirth(e.no),e.no&&e.no.length?15==e.no.length?(DataControl.errorMessage="根据国家法律规定，第一代居民身份证自2013年1月1日起停止使用。请填写您的18位身份证号码。",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,g?b(DataControl.errorType,DataControl.errorMessage,h):"",!1):a.utility.validate.isIdCard(e.no)?!0:(DataControl.errorMessage="请填写正确的身份证号码!",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,g?b(DataControl.errorType,DataControl.errorMessage,h):"",!1):(DataControl.errorMessage="请填写证件号码",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,g?b(DataControl.errorType,DataControl.errorMessage,h):"",!1);if(1!=d){var i=/^[A-Za-z0-9]+$/g;return e.no&&e.no.length?e.no.length>20?(DataControl.errorMessage="请填写正确的护照号码",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,g?b(DataControl.errorType,DataControl.errorMessage,h):"",!1):i.test(e.no)?25==d&&f&&DataControl.getAge(f)>=16?(DataControl.errorType=".js_birth",DataControl.errorMessage="年龄已满16岁，不允许使用户口簿",DataControl.tipIconType=DataControl.TIPICONS.BLUE,g?b(DataControl.errorType,DataControl.errorMessage,h):"",!1):27==d&&f&&DataControl.getAge(f)>=12?(DataControl.errorType=".js_birth",DataControl.errorMessage="年龄已满12岁，不允许使用出生证明",DataControl.tipIconType=DataControl.TIPICONS.BLUE,g?b(DataControl.errorType,DataControl.errorMessage,h):"",!1):!0:(DataControl.errorMessage=2!=d?"证件号码只能是英文或数字":"请填写正确的护照号码",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,g?b(DataControl.errorType,DataControl.errorMessage,h):"",!1):(DataControl.errorMessage="请填写证件号码",DataControl.errorType=".js_no",DataControl.tipIconType=DataControl.TIPICONS.RED,g?b(DataControl.errorType,DataControl.errorMessage,h):"",!1)}},formatCardNo:function(a){a=a.replace(/\s/g,"");var b=[];return b[0]=a.substring(0,6),b[1]=a.substring(6,14),b[2]=a.substring(14),$.trim(b.join(" "))},testBirth:function(c,d,e,f,g){function h(b){var c=parseInt(b.substring(4,6),10),d=new Date(a.base.Date.parse(b)).getMonth()+1;return!(c!=d)}return d=$.trim(d||""),d?!b.test(d)||b.test(d)&&!h(d)?(DataControl.errorType=".js_birth",DataControl.errorMessage="请输入正确的出生日期，格式如：19990909",DataControl.tipIconType=DataControl.TIPICONS.RED,e?c(DataControl.errorType,DataControl.errorMessage,g):"",!1):-2==DataControl.getAge(d)?(DataControl.errorType=".js_birth",DataControl.errorMessage="出生不满14天的婴儿不能登机",DataControl.tipIconType=DataControl.TIPICONS.BLUE,e?c(DataControl.errorType,DataControl.errorMessage,g):"",!1):25==f&&d&&DataControl.getAge(d)>=16?(DataControl.errorType=".js_birth",DataControl.errorMessage="年龄已满16周岁，不能使用户口簿",DataControl.tipIconType=DataControl.TIPICONS.BLUE,e?c(DataControl.errorType,DataControl.errorMessage,g):"",!1):27==f&&d&&DataControl.getAge(d)>=12?(DataControl.errorType=".js_birth",DataControl.errorMessage="年龄已满12周岁，不能使用出生证明",DataControl.tipIconType=DataControl.TIPICONS.BLUE,e?c(DataControl.errorType,DataControl.errorMessage,g):"",!1):!0:(DataControl.errorType=".js_birth",DataControl.errorMessage="请填写出生日期",DataControl.tipIconType=DataControl.TIPICONS.RED,e?c(DataControl.errorType,DataControl.errorMessage,g):"",!1)},NoCard_C_E_Name:function(a,b,c,d,e,f,g,h){b=b.replace(/\s/g,"");var i=/^[\u4e00-\u9fa5]{2,14}$/,j=/^\s*[a-z]+\s*$/i,k=/^\s*[a-z]+\s*[a-z]*\s*$/i,l=null,m=!0;return"none"==$("#cname-container-"+h).css("display")?(""==c&&(DataControl.errorMessage="请填写姓",DataControl.errorType=".js_firstName",g?a(DataControl.errorType,DataControl.errorMessage,h):"",m=!1),m&&!j.test(c)?(DataControl.errorMessage="请填写正确的英文姓氏",DataControl.errorType=".js_firstName",g?a(DataControl.errorType,DataControl.errorMessage,h):"",m=!1):c.length>26&&(DataControl.errorMessage="英文姓名不能超过26个字符，如姓名过长请使用缩写，姓氏不能缩写，名可以缩写",DataControl.errorType=".js_firstName",g?a(DataControl.errorType,DataControl.errorMessage,h):"",m=!1),""==d?(m&&(DataControl.errorMessage="请填写名",DataControl.errorType=".js_lastName"),g?a(".js_lastName","请填写名",h):"",m=!1):k.test(d)?d.length>26&&(DataControl.errorMessage="英文姓名不能超过26个字符，如姓名过长请使用缩写，姓氏不能缩写，名可以缩写",DataControl.errorType=".js_lastName",g?a(DataControl.errorType,DataControl.errorMessage,h):"",m=!1):(m&&(DataControl.errorMessage="请填写正确的名",DataControl.errorType=".js_lastName"),g?a(".js_lastName","请填写正确的名",h):"",m=!1),c&&c.length<26&&d&&d.length<26&&(c+d).length>26&&(m&&(DataControl.errorMessage="英文姓名不能超过26个字符，如姓名过长请使用缩写，姓氏不能缩写，名可以缩写",DataControl.errorType=".js_lastName"),g?a(".js_lastName","英文姓名不能超过26个字符，如姓名过长请使用缩写，姓氏不能缩写，名可以缩写",h):"",m=!1),m):b?(l=e?i.test(b)&&!DataControl.isFan(b):i.test(b))?!0:(DataControl.errorMessage="填写正确的中文姓名",DataControl.errorType=".js_newName",g?a(DataControl.errorType,DataControl.errorMessage,h):"",!1):(DataControl.errorMessage="请填写姓名",DataControl.errorType=".js_newName",g?a(DataControl.errorType,DataControl.errorMessage,h):"",!1)},checkPassenger:function(a,b,d,e,f,g){var h=[];_.isArray(d)?h=d:h[0]=d;return _.every(h,function(d){{var h=$.trim(d.cname),i=(d.ename,d.firstName||""),j=d.lastName||"",k=d.defaIdCard||{},l=d.birth,m=k?k.type:1;d.gender}switch(k.birth=c.getBirth(k.no),e){case"firstName":return c.validateFirstName(b,i,g,f);case"lastName":return c.validateLastName(b,i,j,g,f);case"ename":case"cname":return c.validateName(a,b,h,i,j,m,g,f);case"defaIdCard":return c.validateCard(b,m,k,l,g,f);case"birth":return c.testBirth(b,l,g,m,f)}})},rollMiddle:function(a){var b=$("body").height(),c=$(a).offset().top+$(a).height();document.body.scrollTop=c>b/2?c-b/2:0},showTip:function(a,b,d,e){var f=$(b).parent(),g='<div class="form-tips '+a+'"><i class="flight-errtips-icon"></i><em>'+d+"</em></div>";0===f.find(".form-tips").length?f.append(g):(f.find(".form-tips").removeClass().addClass("form-tips "+a).show(),f.find(".form-tips em").text(d)),e&&(c.rollMiddle(b),f.find(".form-tips").addClass("twinkle"))},hideTip:function(a){var b=$(a).parent();b.find(".form-tips").hide()},isRepeatName:function(a){var b={},c=null;for(var d in a){if(b[a[d]]){c=a[d];break}b[a[d]]=a[d]}return c},popUp:function(a,b){var c=a.find(".j_singlePopup .j_popupCtn"),d=a.find(".j_singlePopup");c.html(b);d.removeClass("js_hide").show().on("click",function(){$(this).addClass("js_hide")})},getDateItems:function(){for(var a=new Date,b=a.getFullYear(),d=[],e=[],f=[],g=b-80;b>=g;g++)d.push({key:c.formatZero(g,4),name:g+"年"});for(var g=1;12>=g;g++)e.push({key:c.formatZero(g,2),name:g+"月"});for(var g=1;31>=g;g++)f.push({key:c.formatZero(g,2),name:g+"日"});return[d,e,f]},getDayItem:function(a,b){var d=31,e=[];switch(b){case 1:case 3:case 5:case 7:case 8:case 10:case 12:d=31;break;case 2:d=a%4==0&&a%100!=0?29:28;break;default:d=30}for(var f=1;d>=f;f++)e.push({key:c.formatZero(f,2),name:f+"日"});return e},formatZero:function(a,b){a+="";for(var c=0;c<b-a.length;c++)a="0"+a;return a},add:function(){for(var a,b,c=0,d=0,e=0;e<arguments.length;e++)a=this.getDecimalCount(arguments[e]),c=Math.max(c,a);b=Math.pow(10,c);for(var f=0;f<arguments.length;f++)d+=arguments[f]*b;return d/b},mul:function(){var a=0,b=0,c=0,d=arguments.length,e=1;for(a=0;d>a;a++)e*=Number(arguments[a].toString().replace(".","")),b=this.getDecimalCount(arguments[a]),c+=b;return e/Math.pow(10,c)},getDecimalCount:function(a){var b=0;try{b=a.toString().split(".")[1].length}catch(c){b=0}return b}};return c});