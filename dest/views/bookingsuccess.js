define(["libs","c","CommonStore","FlightStore","FlightModel","CPageModel","CPageStore",buildViewTemplatesPath("bookingsuccess.html")],function(a,b,c,d,e,f,g,h){var i=d.FlightDetailsStore.getInstance(),j=d.FlightOrderDetailStore.getInstance(),k=d.FlightOrderListStore.getInstance(),l=d.FlightOrderParamStore.getInstance(),m=d.FlightSelectedInfo.getInstance(),n=g.passengerQueryStore.getInstance(),o=(g.passengerEditStore.getInstance(),d.FlightOrderInfoStore.getInstance()),p=(d.FlightPickTicketSelectStore.getInstance(),g.CustomerAddrStore.getInstance(),d.zqInAirportDateAndAddressStore.getInstance()),q=d.zqInCityDateAndAddressStore.getInstance(),r=d.OrderDetailReturnPage.getInstance(),s=d.OrderCreateStore.getInstance(),t=c.UserStore.getInstance(),u=c.SalesObjectStore.getInstance(),v=b.view.extend({pageid:"212002",tpl:h,hasAd:!0,onCreate:function(){r.remove(),j.remove(),k.remove()},onLoad:function(){this.showLoading(),j.remove(),r.remove(),k.remove(),this.render(),this.updatePage(function(){this.hideLoading()}),this.turning()},onShow:function(){this.setTitle("携程旅行网手机触屏版-订单完成"),r.remove(),$("#headerview").length>0&&$("#headerview").hide()},onHide:function(){userInfo=t?t.getUser():null,userInfo&&userInfo.IsNonUser&&t.remove(),r.remove(),j.remove(),k.remove(),this.hideLoading(),$("#headerview").length>0&&$("#headerview").show()},render:function(){m.remove();var a=n.get();for(var b in a){var c=a[b];c.selected=0}var d=n.getTag();n.set(a,d),o.remove(),i.remove(),p.remove(),q.remove(),r.remove(),j.remove(),this.$el.html(this.tpl),this.elsBox={infobox_tpl:this.$el.find("#infotpl"),infobox_box:this.$el.find("#infobox")},this.infoboxtplfun=_.template(this.elsBox.infobox_tpl.html())},updatePage:function(a){var b=this.getQuery("orderid"),c=this.getQuery("extension"),d=this.getQuery("flag");userInfo=t?t.getUser():null;var e=u.get();if(e&&e.sid&&(1575==+e.sid||1867==+e.sid)&&(this.$el.find("#js_home").hide(),this.$el.find("#footer").hide(),this.footer&&this.footer.hide(),this.hasAd=!1),userInfo&&userInfo.Auth&&b){var f=s.get(b);if(f.user=userInfo,f.orderId=b,f.flag=d,f.ext=c,f._sales=e,f.days=this.getQuery("days"),c&&f.days&&+f.days>0&&!userInfo.IsNonUser){var g=window.navigator.userAgent,h="http://weixin.qq.com/m";g&&(g=g.toLowerCase(),(g.indexOf("iphone")>-1||g.indexOf("ios")>-1)&&(h="https://itunes.apple.com/cn/app/id414478124?mt=8&ls=1")),f.app=h}var i=this.infoboxtplfun(f);this.elsBox.infobox_box.html(i)}else{var j=this;this.showHeadWarning("订单完成","您的订单已提交成功，请返回至我的携程进行订单查询",function(){j.backAction(1),this.hide(),r.remove(),j.hideLoading()})}a.call(this)},events:{"click #js_return":"backAction","click #js_home":"backHome","click input[data-app]":"rebateAction","click .orderid":"viewOrder","click #reg":"regAction"},backAction:function(){userInfo=t?t.getUser():null,userInfo&&userInfo.IsNonUser&&t.remove(),this.jump("/webapp/flight/",!0)},backHome:function(){userInfo=t?t.getUser():null,userInfo&&userInfo.IsNonUser&&t.remove();var a=u.get();a&&a.sid&&1896==+a.sid?window.location="map://leftClick()":this.jump("/html5/",!0)},rebateAction:function(a){var b=$(a.currentTarget).attr("data-app");b&&(window.location.href=b)},viewOrder:function(a){var b=$(a.currentTarget).attr("data-id");if(userInfo=t?t.getUser():null,b&&userInfo&&userInfo.Auth){this.showLoading();var c={Id:b,url:"/webapp/flight/index.html#bookingsuccess?orderid="+b};l.set(c),this.jump("/webapp/flight/#flightorderdetail")}},regAction:function(a){window.location.href=$(a.currentTarget).attr("data-href")}});return v});