define(["cSales","libs","c","CommonStore","FlightModel","FlightStore","flight/utility/utility","cMultipleDate","adLoad",buildViewTemplatesPath("backlist.html")],function(a,b,c,d,e,f,g,h,i,j){require(["cHolidayPriceCalendar"]);var k=new i,l=(c.ui,c.base),m=d.SalesObjectStore.getInstance(),n={},o={},p="h5.flt.searchresult",q=f.MdListStore.getInstance(),r=f.MdTransStore.getInstance(),s=f.FlightCCBStore.getInstance(),t=c.view.extend({pageid:"212009",tpl:j,hasAd:!1,flightSearchSubjoin:f.FlightSearchSubjoinStore.getInstance(),flightSearchStore:f.FlightSearchStore.getInstance(),flightFilterStore:f.FlightFilterStore.getInstance(),flightList:e.FlightListModel.getInstance(),flightSelectedStore:f.FlightSelectedInfo.getInstance(),lowestPrice:e.LowestPriceSearchModel.getInstance(),lowestPriceStore:f.LowestPriceSearchStore.getInstance(),flightOrderStore:f.FlightOrderInfoStore.getInstance(),flightListStore:f.FlightListStore.getInstance(),baseDataModel:null,basedata:null,cityType:null,sdatalist:[],datalist:[],isEmpty:!1,isRedirect:!1,render:function(){this.viewdata.req=this.request,this.$el.html(this.tpl),this.els={elf_list:this.$el.find(".f_list"),elflightlisttpl:this.$el.find("#flightlisttpl"),elt1:this.$el.find(".tab_time .t1"),elt2:this.$el.find(".tab_time .t2"),elt3:this.$el.find(".tab_time .t3"),elt4:this.$el.find(".tab_time .t4"),eltabby:this.$el.find(".tab_by li"),eltabtime:this.$el.find('li[data-type="time"]'),eltabfilter:this.$el.find('li[data-type="filter"]'),eltabprice:this.$el.find('li[data-type="price"]'),elflightTotal:this.$el.find("#flightTotal"),eltitle:this.$el.find("#title"),elemptylisttpl:this.$el.find("#emptylisttpl")},this.flightListTplFun=_.template(this.els.elflightlisttpl.html()),this.isShowData=!0},events:{"click #js_return":"backAction","click #js_home":"homeAction","click .tab_time li":"switchDate","click .js_subswitch":"switchsubListAction","click .js_flight_item":"tapFlightitemAction","click .js_flight_seat":"tapFlightSeatAction","click .tab_by li":"tapSortAction"},tapSortAction:function(a){var b,c=$(a.currentTarget),d=c.attr("data-type");switch(d){case"time":if(this.isEmpty)return;switch(q.addOpValue("SortWay","Time"),this.flightSearchSubjoin.setAttr("arrive-sorttype","time"),b=this.flightSearchSubjoin.getAttr("arrive-orderby")||"asc",c.hasClass("hover")||(b="asc"==b?"desc":"asc"),b){case"desc":this.flightSearchSubjoin.setAttr("arrive-orderby","asc"),this.renderList();break;case"asc":this.flightSearchSubjoin.setAttr("arrive-orderby","desc"),this.renderList()}break;case"filter":q.setAttr("IsFilter",!0),this.forward("flightlistfilter");break;case"price":if(this.isEmpty)return;if(q.addOpValue("SortWay","Price"),"price"!==this.flightSearchSubjoin.getAttr("arrive-sorttype"))this.flightSearchSubjoin.setAttr("arrive-sorttype","price"),this.renderList();else switch(b=this.flightSearchSubjoin.getAttr("arrive-orderby")||"desc"){case"desc":this.flightSearchSubjoin.setAttr("arrive-orderby","asc"),this.renderList();break;case"asc":this.flightSearchSubjoin.setAttr("arrive-orderby","desc"),this.renderList()}}},sortHandler:{time_Asc:function(a,b){var c=l.Date.parse(a.dTime).valueOf(),d=l.Date.parse(b.dTime).valueOf();return c-d},time_Desc:function(a,b){var c=l.Date.parse(a.dTime).valueOf(),d=l.Date.parse(b.dTime).valueOf();return d-c},price_Asc:function(a,b){var c=a.cabins&&a.cabins[0]&&a.cabins[0].price||0,d=b.cabins&&b.cabins[0]&&b.cabins[0].price||0;return c-d},price_Desc:function(a,b){var c=a.cabins&&a.cabins[0]&&a.cabins[0].price||0,d=b.cabins&&b.cabins[0]&&b.cabins[0].price||0;return d-c}},backAction:function(){q.setAttr("IsReturn",!0);try{this.mdSubmit()}catch(a){0}0,this.back("list")},homeAction:function(){var a=m.get();a&&a.sid&&1896==+a.sid?window.location="map://leftClick()":this.jump(a&&a.sid&&449843==+a.sid?"/webapp/mkt/ccb/":"/html5/")},tapFlightitemAction:function(a){var b=$(a.currentTarget),c=$(a.target);if(!c.is(".js_subswitch")){var d=b.attr("data-key"),e=b.attr("data-ckey"),f=this.datalist[d];if(f.cabins.length>e){var g=f.cabins[e];if(!g)return void this.showToast("对不起，由于您长时间未操作，请重新查询");var h=this.basedata.FlightCityList.cities2||{};this.flightSelectedStore.setAttr("arrive",{flight:f,cabin:g,aircraft:this.basedata.FlightAircraft[f.planeType],dportinfo:h[f.dPortCode],aportinfo:h[f.aPortCode],airline:this.basedata.FlightAirline[f.airlineCode]}),this.toNextPage(f,g)}}},tapFlightSeatAction:function(a){var b=$(a.currentTarget),c=b.attr("data-key"),d=b.attr("data-parent-key"),e=this.datalist[d],f=e.cabins&&e.cabins[c];if(f){try{var g=2==f.class?"C":3==f.class?"F":"Y";q.setAttr("SubClass",g),q.setAttr("FlightNoSequence",d);var h=b.parent().find("li").length;switch(!0){case 0===+c:q.setAttr("SubClassSequence",1);break;case+c===h-1:q.setAttr("SubClassSequence",-1);break;default:q.setAttr("SubClassSequence",0)}f.rebateAmt>0&&q.setAttr("ActiveType","PayBack")}catch(a){0}var i=this.basedata.FlightCityList.cities2||{};this.flightSelectedStore.setAttr("arrive",{flight:e,cabin:f,aircraft:this.basedata.FlightAircraft[e.planeType],dportinfo:i[e.dPortCode],aportinfo:i[e.aPortCode],airline:this.basedata.FlightAirline[e.airlineCode]}),this.toNextPage(e,f)}},toNextPage:function(){this.flightOrderStore.setAttr("selInsure","1"),this.flightOrderStore.setAttr("fullCabin",!1),this.isRedirect=!0;try{this.mdSubmit()}catch(a){0}this.forward("bookinginfo")},clearCurFilter:function(){this.flightSearchSubjoin.removeAttr("arrivefilter-type"),this.flightSearchSubjoin.removeAttr("arrivefilter-value"),this.flightFilterStore.removeAttr("arrivefilter-type"),this.flightFilterStore.removeAttr("arrivefilter-value")},resetSort:function(){this.flightSearchSubjoin.setAttr("arrive-sorttype","time"),this.flightSearchSubjoin.setAttr("arrive-orderby","asc")},switchsubListAction:function(a){var b=$(a.currentTarget),c=b.parent(),d=c.next(".js_sublist");try{q.addOpValue("MoreClassSequence",c.data("key"))}catch(a){0}"none"==d.css("display")?(d.show(),b.removeClass("flight-packdown").addClass("flight-packup")):(d.hide(),b.removeClass("flight-packup").addClass("flight-packdown"))},switchDate:function(a){var b=this;if("cheap-calendar"==$(a.currentTarget)[0].className||"today t2"==$(a.currentTarget)[0].className){if(!this.isShowData)return;this.isShowData=!1,n.prices&&n.prices.length>0&&require(["cHolidayPriceCalendar"],function(a){var d=b.flightSelectedStore.getAttr("depart").flight.aTime.replace(/-/g,"/");d=new l.Date(d).addDay(1);for(var e=l.Date.format(d,"Y/m/d"),f=a.serverDate,g=(f.getFullYear(),f.getMonth(),f.getDate(),[]),h=0,i=n.prices.length;i>h;h++)g[h]={date:n.prices[h].dDate,price:n.prices[h].price};var j=b.flightSearchStore.getSearchDetails(0,"dcityName"),k=b.flightSearchStore.getSearchDetails(0,"acityName"),o=new a({header:{title:'<span class="jPriceTitle">低价日历</span><span class="jPriceCity">'+k+"-"+j+"</span>",tel:"4000086666",home:!0,homeHandler:function(){var a=m.get();a&&a.sid&&1896==+a.sid?window.location="map://leftClick()":s.getAttr("isCCB")?this.jump("/webapp/mkt/ccb/"):b.jump("/html5/",!0)}},startPriceTime:new Date(e),monthsNum:12,voidInvalid:!1,format:"Y-m-d",priceDate:g,callback:function(a,d,e){var f=c.utility.Date.format(a,"Y/m/d");b.lowestPriceClick(f),this.hide(),$("body").data("cui-date",d.value),this.$el.find(".cui_cld_daycrt").removeClass("cui_cld_daycrt"),e.addClass("cui_cld_daycrt"),flagHightLight=0},onShow:function(){var a=$("body").data("cui-date");b.isShowData=!1,a&&this.$el.find('[data-date="'+a+'"]').addClass("cui_cld_daycrt"),setTimeout(function(){b.__hide()},500),$(".cui_cldweek").css("top","43px"),this.findMinPrice(),this.$el.find(".cui_cld_daycrt").removeClass("cui_cld_daycrt");try{var c=b.flightSearchStore.getAttr("_items")[1].date,d=l.Date.format(c,"Y-m-d");this.$el.find('[data-date="'+d+'"]').addClass("cui_cld_daycrt"),flagHightLight=0}catch(e){}this.$el[0].offsetHeight},onHide:function(){b.__show(),this.remove(),b.isShowData=!0}});q.setAttr("DateQuery","PriceCalendar"),o.show(),b.GoToView="calendar"})}var d=$(a.currentTarget),e=d.attr("data-date"),f=this.flightSearchStore.getAttr("calendarendtime");f=l.Date.parse(f,!0);try{var g=d.hasClass("yesterday")?"BeforeDay":d.hasClass("tomorrow")?"AfterDay":"";q.setAttr("DateQuery",g)}catch(a){0}if(e&&(e=l.Date.parse(e,!0))<=f){this.flightSearchStore.setSearchDetails(1,"date",l.Date.format(e,"Y/m/d"));try{mdStore.setAttr("DTime",l.Date.format(e,"Y/m/d")),this.mdSubmit()}catch(a){0}this.flightSearchStore.setCurSearchDetails([0]),this.updateTopDatePanel(e),k.show(),this.reloadData(function(){k.hide()})}},lowestPriceClick:function(a){var b=a,c=this.flightSearchStore.getAttr("calendarendtime");if(c=l.Date.parse(c,!0),b&&(b=l.Date.parse(b,!0))<=c){this.flightSearchStore.setSearchDetails(1,"date",l.Date.format(b,"Y/m/d"));try{mdStore.setAttr("DTime",l.Date.format(b,"Y/m/d")),this.mdSubmit()}catch(d){0}this.flightSearchStore.setCurSearchDetails([0]),this.updateTopDatePanel(b),k.show(),this.reloadData(function(){k.hide()})}},buildEvent:function(){},disposeData:function(a){var b=a.slice(0),c=this.flightSearchSubjoin.getAttr("arrivefilter-type"),d=this.flightSearchSubjoin.getAttr("arrivefilter-value"),e=/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}\s+(\d{1,2}:\d{1,2}):\d{1,2}$/i;switch(!0){case"0"===c&&!!d:b=_.filter(b,function(a){var b=e.exec(a.dTime);b=b&&b[1];var c=parseInt(b.replace(":","")),f=d.split("-"),g=parseInt(f[0].replace(":","")),h=parseInt(f[1].replace(":",""));return c>=g&&h>=c});break;case"1"===c&&!!d:b||(b=[]),b=_.filter(b,function(a){return a.cabins=_.filter(a.cabins,function(a){return 3==d?5===a.classForDisp||3==a["class"]||4===a.classForDisp||2==a["class"]:0==d?6===a.classForDisp||2!=a["class"]&&3!=a["class"]:!1}),a.cabins&&a.cabins.length>0});break;case"2"===c&&!!d:b=_.filter(b,function(a){return d===a.airlineCode})}var f=this.flightSearchSubjoin.getAttr("arrive-sorttype"),g=this.flightSearchSubjoin.getAttr("arrive-orderby");switch(this.els.eltabby.removeClass("hover"),!0){case"time"===f&&"asc"===g:b.sort(this.sortHandler.time_Asc),this.els.eltabtime.addClass("hover"),this.els.eltabtime.find("em").removeClass("flight-icon-pxd"),this.els.eltabtime.find("em").addClass("flight-icon-pxu");break;case"time"===f&&"desc"===g:b.sort(this.sortHandler.time_Desc),this.els.eltabtime.addClass("hover"),this.els.eltabtime.find("em").removeClass("flight-icon-pxu"),this.els.eltabtime.find("em").addClass("flight-icon-pxd");break;case"price"===f&&"asc"===g:b.sort(this.sortHandler.price_Asc),this.els.eltabprice.addClass("hover"),this.els.eltabprice.find("em").removeClass("flight-icon-pxd"),this.els.eltabprice.find("em").addClass("flight-icon-pxu");break;case"price"===f&&"desc"===g:b.sort(this.sortHandler.price_Desc),this.els.eltabprice.addClass("hover"),this.els.eltabprice.find("em").removeClass("flight-icon-pxu"),this.els.eltabprice.find("em").addClass("flight-icon-pxd")}return b},renderList:function(){function a(a,b,c,d,e){if("nds"==b){var f=$.grep(a,function(a){return 10==a.discount?null==d?5==c?5===a.classForDisp||3==a["class"]:6==c?6===a.classForDisp||2!=a["class"]&&3!=a["class"]:4==c?4===a.classForDisp||2==a["class"]:a.classForDisp===c:a.classForDisp+""+a["class"]==c+""+d:!1});if(f&&f.length>0)return f[0]}if("min"==b){for(var g=0;g<a.length;g++)for(var h=g;h<a.length;h++)if(a[g].price-a[h].price>0){var i=a[g];a[g]=a[h],a[h]=i}var f=$.grep(a,function(a){return null==d?6==c?6===a.classForDisp||2!=a["class"]&&3!=a["class"]:5==c?5===a.classForDisp||3==a["class"]:4==c?4===a.classForDisp||2==a["class"]:a.classForDisp===c:a.classForDisp+""+a["class"]==c+""+d});if(f&&f.length>0)return e?f.length-e>0?f[e]:null:f[0]}return null}function b(a,b){for(var c=0;c<a.length;c++)if(a[c]["class"]==b["class"]&&a[c].classForDisp==b.classForDisp&&a[c].price==b.price)return!0;return!1}var d=this.flightSearchStore.getSearchDetails(0,"date"),e=this.flightSearchStore.getSearchDetails(1,"date"),f=this.flightSearchStore.getSearchDetails(0,"dcityName"),g=this.flightSearchStore.getSearchDetails(0,"acityName"),h=this.flightSearchStore.getAttr("tabtype")||1;try{q.setAttr("DCity",f),q.setAttr("ACity",g),q.setAttr("FlightType",1===h?"OW":"RT"),q.setAttr("DTime",d),q.setAttr("ATime",e?e:"")}catch(i){0}this.datalist=this.disposeData(this.sdatalist.slice(0));for(var j=this.flightSearchSubjoin.getAttr("arrivefilter-type-cabin"),k=m.get(),l=0;l<this.datalist.length;l++){var n=new Array,o=this.datalist[l].cabins,p=a(o,"min",6),r=a(o,"min",6,null,1),s=a(o,"nds",6),t=a(o,"min",4),u=a(o,"nds",4),v=a(o,"min",2,3),w=a(o,"min",5),x=a(o,"nds",5),y=a(o,"min",3,3);null==p||b(n,p)||n.push(p),null==r||b(n,r)||n.push(r),null==s||b(n,s)||n.push(s),null==t||b(n,t)||n.push(t),null==u||b(n,u)||n.push(u),null==v||b(n,v)||n.push(v),null==w||b(n,w)||n.push(w),null==x||b(n,x)||n.push(x),null==y||b(n,y)||n.push(y),this.datalist[l].cabins=n.length>0?n:o}var z={list:this.datalist,cDate:c.base.Date,bd:this.basedata,_sales:k,filterClass:j,_viewBuildSeatTitlt:this._viewBuildSeatTitlt,_viewfilterfirst:this._viewfilterfirst},A=this.flightListTplFun(z);this.els.elf_list.html(A);for(var B=0,l=0;l<this.datalist.length;l++)null!=this.datalist[l].flightNo&&B++;this.els.elflightTotal.html(B)},afterReFilter:function(){},updatePageDate:function(){var a=this.flightSearchStore.getSearchDetails(0,"date"),b=this.flightSearchStore.getSearchDetails(1,"date"),c=this.flightSearchStore.getSearchDetails(1,"dcityName"),d=this.flightSearchStore.getSearchDetails(1,"acityName"),e=(this.flightSearchStore.getAttr("tabtype")||1,this.flightSearchSubjoin.getAttr("depart-sorttype")),f=this.flightSearchSubjoin.getAttr("depart-orderby"),g=l.Date.parse(a,!0),h=l.Date.parse(b,!0);switch(g>=h&&(h=new l.Date(g),this.flightSearchStore.setSearchDetails(1,"date",h.format("Y-m-d")),h=h.valueOf()),this.els.eltitle.html("返程: "+c+"-"+d),!0){case"time"===e&&"asc"===f:this.els.eltabtime.addClass("hover"),this.els.eltabtime.find("em").html("↑");break;case"time"===e&&"desc"===f:this.els.eltabtime.addClass("hover"),this.els.eltabtime.find("em").html("↓");break;case"price"===e&&"asc"===f:this.els.eltabprice.addClass("hover"),this.els.eltabprice.find("em").html("↑");break;case"price"===e&&"desc"===f:this.els.eltabprice.addClass("hover"),this.els.eltabprice.find("em").html("↓")}},updateTopDatePanel:function(a){a.setHours(0,0,0,0);var b=new l.Date(a).addDay(-1),c=new l.Date(a),d=new l.Date(a).addDay(1),e=new l.Date(this.getServerDate()).setHours(0,0,0,0).valueOf(),f=this.flightSearchStore.getAttr("calendarendtime");f=l.Date.parse(f,!0);var g=this.flightSearchStore.getSearchDetails(0,"date"),h=l.Date.parse(g,!0);b.valueOf()>=e&&b.valueOf()>=h?(this.$el.find(".yesterday").removeClass("flight-listdate-disable"),this.els.elt1.attr("data-date",b.format("Y/m/d")),this.$el.find(".t1 .price").html(o[b.format("Y/m/d")]?"<dfn>&yen;</dfn>"+o[b.format("Y/m/d")]:"")):(this.$el.find(".yesterday").addClass("flight-listdate-disable"),this.$el.find(".t1 .price").html(""),this.els.elt1.attr("data-date","")),c.valueOf()>=e?(this.$el.find("#js_CurDate").text(c.format("Y-m-d w")),this.els.elt2.attr("data-date",c.format("Y/m/d")),this.$el.find(".t2 .price").html(o[c.format("Y/m/d")]?"<dfn>&yen;</dfn>"+o[c.format("Y/m/d")]:"")):(this.els.elt2.html("--"),this.els.elt2.attr("data-date","")),d.valueOf()<=f?(this.$el.find(".tomorrow").removeClass("flight-listdate-disable"),this.els.elt3.attr("data-date",d.format("Y/m/d")),this.$el.find(".t3 .price").html(o[d.format("Y/m/d")]?"<dfn>&yen;</dfn>"+o[d.format("Y/m/d")]:"")):(this.$el.find(".tomorrow").addClass("flight-listdate-disable"),this.els.elt3.attr("data-date",""),this.$el.find(".t3 .price").html(""))},reloadData:function(a){this.els.elf_list.empty(),this.flightSearchStore.setCurSearchDetails([0,1]),this.els.elflightTotal.html(0),this.flightList.excute(function(b){if(b.count){this.sdatalist=b.items,this.datalist=this.sdatalist.sort(this.sortHandler.price_Asc);for(var c=1/0,d=0,e=b.items.length;e>d;d++)b.items[d].cabins.length>0&&(c=+b.items[d].cabins[0].price<c?b.items[d].cabins[0].price:c);this.$el.find(".t2 .price").html("<dfn>&yen;</dfn>"+c),this.isEmpty=this.datalist.length?!1:!0,this.renderList(this.datalist||[])}else this.els.elf_list.html(this.els.elemptylisttpl.html()),this.isEmpty=!0;a.call(this,b)},function(b){b&&b.msg&&this.showToast(b.msg),a.call(this)},this.flightSearchStore.getAttr("fullCabin"),this)},updatePage:function(a){var b=this.getQuery("sourceid");if(b&&+b>0){for(var c=0,d=["497","1107","1108","3516","3512","3511","3503","3513","1595","1596","3524","3517","3518","1591","1825","1826","1827","1828","1829","1830","1831"],e=0,f=d.length;f>e;e++){var g=d[e];if(g==b){c=1;break}}c&&this.footer.checkForceDownload(b)}var h=m.get();(b&&(1575==+b||1867==+b.sid)||h&&h.sid&&(1575==+h.sid||1867==+h.sid))&&(this.$el.find("#js_home").hide(),this.$el.find("#footer").hide(),this.footer&&this.footer.hide(),this.hasAd=!1),this.updatePageDate(),this.reloadData(a)},lowestPriceList:function(){var a=this;n.head={auth:null,errcode:0};var b=new Array;this.$el.find(".t2 .price").html("");var c={};if(this.lowestPrice.excute(function(a){c=a},function(){},!1,this),c&&c.prices&&c.prices.length>0){for(var d=0,e=c.prices.length;e>d;d++)c.prices[d].dDate=new Date(c.prices[d].dDate.replace(/-/g,"/")),lowestDayKey=l.Date.format(c.prices[d].dDate,"Y/m/d"),o[lowestDayKey]=c.prices[d].price;b=c.prices,n.prices=b}else{c.prices=[];for(var f=this.getServerDate(),d=0,e=90;e>d;d++)c.prices.push({dDate:l.Date.parse(l.Date.format(f,"Ymd")).addDay(d).date,price:""}),lowestDayKey=l.Date.format(c.prices[d].dDate,"Y/m/d"),o[lowestDayKey]=c.prices[d].price;b=c.prices,n.prices=b}{var g=a.flightSearchStore.getSearchDetails(1,"date");l.Date.parse(g,!0)}date=l.Date.format(g,"Y/m/d H:i:s"),date=new Date(date),a.updateTopDatePanel(date)},onCreate:function(){0;this.flightSearchSubjoin.getAttr("departfilter-type-cabin");this.baseDataModel=new h({models:{FlightAirline:e.FlightAirlineModel.getInstance(),FlightCityList:e.FlightCityListModel.getInstance(),FlightAircraft:e.FlightAircraftModel.getInstance()}}),this.$el.css({background:"#fff"}),this.render(),this.buildEvent()},getSalesObj:function(){var b=this,c=b.getQuery("sales"),e=b.getQuery("sourceid"),f=d.SalesStore.getInstance().get();null!=f&&null==e&&null==c&&(e=f.sourceid),(c||e)&&a.getSalesObject(c||e,$.proxy(function(){a.replaceContent(b.$el)},this))},onLoad:function(a){0;var b=this;b.turning();var c=this.flightSearchStore.getAttr("items")[0];this.lowestPriceStore.setAttr("aCty",c.dCtyCode),this.lowestPriceStore.setAttr("dCty",c.aCtyCode),this.lowestPriceList(),this.refer=a||"","bookinginfo"===this.refer&&this.isRedirect&&this.flightListStore.get()&&!this.flightSearchStore.getAttr("fullCabin")?this.turning():(this.isRedirect=!1,this.flightSearchStore.setAttr("__tripType",2),k.show(),this.baseDataModel.excute(function(a){this.basedata=a,this.updatePage(function(){k.hide()})},function(){this.showToast("数据请求失败",2,$.proxy(function(){this.back("index")},this)),k.hide()},!1,this)),this.getSalesObj()},onShow:function(){0;var a=this.flightSearchStore.getSearchDetails(0,"date"),b=this.flightSearchStore.getSearchDetails(1,"date"),c=this.flightSearchStore.getSearchDetails(0,"dcityName"),d=this.flightSearchStore.getSearchDetails(0,"acityName"),e=this.flightSearchStore.getAttr("tabtype")||1;try{q.setAttr("DCity",c),q.setAttr("ACity",d),q.setAttr("FlightType",1===e?"OW":"RT"),q.setAttr("DTime",a),q.setAttr("ATime",b?b:"")}catch(f){0}this.setTitle("机票列表页"),"bookinginfo"===this.refer&&this.isRedirect&&this.restoreScrollPos()},onHide:function(a){0,("list"===a||""===a)&&(this.clearCurFilter(),this.resetSort());"bookinginfo"!=a&&"calendar"!=this.GoToView&&this.els.elf_list.empty(),k.hide()},_viewBuildSeatTitlt:function(a,b){var c,d=3==+b?"头等舱":2==+b?"公务舱":"经济舱";return c=1===a?'<i class="clr-ff9a14">高端'+d+"</i>":2===a?'<i class="clr-ff9a14">超值'+d+"</i>":3===a?'<i class="clr-ff9a14">豪华'+d+"</i>":4===a?"商务舱":5===a?"头等舱":6===a?"经济舱":7===a?'<i class="clr-ff9a14">空中'+d+"</i>":d},_viewfilterfirst:function(a){if(a&&a.length>0){for(var b=0,c=null,d=0;d<a.length;d++)0==d?(b=a[0].price,c=a[0],c.ckey=0):b-a[d].price>0&&(b=a[d].price,c=a[d],c.ckey=0);return c}},__assert:function(){var a=this.flightSearchStore.getSearchDetails(1,"dcityName"),b=this.flightSearchStore.getSearchDetails(1,"acityName");return a&&b?!0:(this.back("list"),!1)},mdSubmit:function(){var a=q.getAttr("FlightNoSequence"),b=q.getAttr("SubClassSequence"),c=q.getAttr("ActiveType");r.setAttr("aObj",{fns:a,scs:b,at:c}),g.sendUbt(p,q.get()),q.remove()}});return t});