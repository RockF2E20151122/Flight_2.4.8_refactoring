define(["libs","c","CommonStore","FlightModel","FlightStore","CPageStore",buildViewTemplatesPath("packageselect.html")],function(a,b,c,d,e,f,g){var h=(b.ui,b.base,c.SalesObjectStore.getInstance(),null),i=b.view.extend({pageid:"",hasAd:!0,tpl:g,userStore:c.UserStore.getInstance(),flightDetailsStore:e.FlightDetailsStore.getInstance(),passengerQueryStore:f.passengerQueryStore.getInstance(),packageSelectStore:e.PackageSelectStore.getInstance(),render:function(){this.viewdata.req=this.request,this.$el.html(this.tpl),this.els={packagelist:this.$el.find("#packageList"),packagetmp:this.$el.find("#packageTmp")},this.packagetmpfun=_.template(this.els.packagetmp.html())},events:{"click #js_return":"backAction","click .flight-list-table2 li":"packageSelectAction","click #liping":"lipingAction","click #insure":"insureAction"},onCreate:function(){this.render()},onLoad:function(){if(h=this,!this.uid)if(this.userStore.isLogin()){var a=this.userStore.getUser();this.uid=a.UserID}else this.uid=b.utility.getGuid();this.updatePage()},returnAction:function(){this.back("bookinginfo")},onShow:function(){this.hideLoading()},onHide:function(){this.hideLoading()},packageSelectAction:function(a){var b=$(a.currentTarget);b.hasClass("selected")||($(".flight-list-table2 li").removeClass("selected"),b.addClass("selected"),this.packageSelectStore.setAttr("pkgtype",+b.data("type"),this.uid)),this.backAction()},backAction:function(){this.back("bookinginfo")},lipingAction:function(a){$(a.target).data("url");this.forward("liping")},insureAction:function(a){var b=$(a.target).data("url");this.jump(b)},updatePage:function(){this.showLoading();var a=this.flightDetailsStore.get();a.selCount=this.passengerQueryStore.getAttr("validSelCount"),a.pkgtype=this.packageSelectStore.getAttr("pkgtype",this.uid),a&&this.els.packagelist.html(this.packagetmpfun(a)),this.turning()}});return i});