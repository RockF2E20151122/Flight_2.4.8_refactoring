"use strict";define(["c","libs",buildViewTemplatesPath("../modules/bookingInfo/templates/tInsurance.html")],function(a,b,c){var d=new a.base.Class({__propertys__:function(){this.viewName="Insurance",this.opts=this.opts||{},this.parentView=null},setBoxes:function(){this.insureInfoBox=this.viewPort.find("#insure")},setTemplate:function(){this.viewPort.append(c),this.insureBoxtplfun=_.template(this.viewPort.find("#insure_tpl").html())},changeOpts:function(a){this.opts=$.extend(!0,this.opts,a),this.viewPort=this.opts.viewPort,this.parentView=this.opts.parentView,this.stores=this.parentView.stores},initialize:function(a){this.changeOpts(a),this.setBoxes(),this.setTemplate(),this.fireEvents()},fireEvents:function(){this.parentView.on(this.parentView.EVENTS.INSURANCERENDER,this.render.bind(this))},render:function(a,b){var c=this.stores.flightOrderStore.get();if(c=c?c:{},b)this.setHtml(a,!1);else{var d="undefined"==typeof c.selInsure?1:c.selInsure&&+c.selInsure>-1?c.selInsure:0;a.selInsure=d,this.setHtml(a,!0)}},showReadMe:function(){var a=(this.opts.Mask,['<div class="flight-mask"   >','<div class="flight-mask-cnt" style=" color:rgba(255, 255, 255, 1);font-size:14px; " >','<p">Я����Ʒ��</p>',"<br/>","<p>Я�����������ݲ�ͬ�ĵ����ͳ�Ʊ��ʽ���ṩ����������˺����ղ�Ʒ��</p>","<p>1 ���������ƣ��»������йذ�����ͨ���������˺����ա���e·̩�������������˺����ա�̫ƽ��������̫���������ձ��ϼƻ����˱������ġ�Я�̷������ǡ����������˺����գ�</p>","<p>2 ���������ƣ��������� 5 �ݣ�</p>","<br/><br/>",'<p">����������</p>',"<br/>","<p>Я�����������ݲ�ͬ�ĵ����ͳ�Ʊ��ʽ���ṩ����������˺����ղ�Ʒ��</p>","<p>1 ���������ƣ��»������йذ�����ͨ���������˺����ա���e·̩�������������˺����ա�̫ƽ��������̫���������ձ��ϼƻ����˱������ġ�Я�̷������ǡ����������˺����գ�</p>","<p>2 ���������ƣ��������� 5 �ݣ�</p>","<p>3 ��������Ч�ڣ�ָ��������ÿ���Գ˿����ݣ��������ӱ��������ĺϷ���ҵ��Ӫ�Ŀ��˷ɻ����Σ������س����˹��ڰ�ȫ�����Ĺ涨���Գ���Ч��Ʊ��Ʊ���������˿��˷ɻ��Ͳ�ʱ�����ִ���Ʊ�������յ��뿪���˿��˷ɻ��Ͳյ��ڼ������������˺������µı������Σ����Ͳյ��ڼ������������˺������µı������Σ����Ͳյ��ڼ������������˺�����</p>","</div>","</div>"].join("")),a=$(a);this.parentView.mask||(this.parentView.mask=a,$("body").append(a),a.click(function(){$(this).hide()})),this.parentView.mask.show()},setInsuranceIntoFlightOrderStore:function(a){var b=this.stores.flightOrderStore.get(),c=this.stores.flightDetailsStore.get(),d={};if(b.selInsure&&+b.selInsure>0){var e=c.insurances[0];d.type=e.type,d.typeId=e.typeId,d.productId=e.productId,d.cInsurances=a,d.price=e.price}this.stores.flightOrderStore.setAttr("insurance",d)},getSels:function(){var a=0;return this.viewPort.find("#insure_must").length>0&&(a=$("#insure_must")&&$("#insure_must").attr("data-selInsure")?+$("#insure_must").attr("data-selInsure"):0),a},getBxQty:function(){var a=0;return this.viewPort.find("#insure_detail em i").length>0&&(a=this.viewPort.find("#insure_detail em i").html()),a},viewInsure:function(a){var b=this.stores.flightDetailsStore.get();return b?void(b.insurances[0].url?this.parentView.jump(b.insurances[0].url):this.parentView.forward(a)):void this.parentView.showAlert()},setInsureDetail:function(a,b,c,d){var e=this.viewPort.find("#insure_detail");if(!b&&+c.getAttr("selInsure")&&e.length>0){var f=parseInt(e.data("pcount"))||0;e.data("pcount",f+d);var g=parseInt(e.data("unitprice"))||0,h=parseInt(e.data("mininsure"))||0;a+=g*h;var i=e.find("em i");i&&i.length>0&&i.html((f+d)*h)}return a},hideBox:function(){this.insureInfoBox.hide()},showBox:function(){this.insureInfoBox.show()},setHtml:function(a,b){if(a){var c=this.insureBoxtplfun(a);this.insureInfoBox.html(c),b&&a.insurances&&a.insurances.length&&$("#insuranceLink > a").attr("href",a.insurances[0].url)}}});return d});